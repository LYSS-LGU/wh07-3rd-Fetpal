# Fetpal 요구사항 정의서

> **4차 스프린트 발표** (2025.11.14)  
> **최종 업데이트**: 2025-11-14

---

## 📋 문서 개요

이 문서는 Fetpal 프로젝트의 기능적 요구사항과 비기능적 요구사항을 정의합니다.

---

## 📌 요구사항 요약 (Requirements Summary)

### 🎯 기능적 요구사항 요약 (Functional Requirements)

> 시스템이 반드시 수행해야 하는 기능에 대한 정의

| ID        | 구분              | 요구사항                    | 상세 설명                                                                                                                                                                                                                                                    | 우선순위   | 상태 |
| :-------- | :---------------- | :-------------------------- | :----------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------- | :--------- | :--- |
| **FR-01** | **사용자 관리**   | **회원가입 및 인증**        | - 이메일/비밀번호 기반 회원가입이 가능해야 한다.<br>- 소셜 로그인(Google, Kakao) 기능을 제공해야 한다.<br>- 로그인한 사용자는 자신의 프로필 정보를 수정하고 반려동물을 등록/관리할 수 있어야 한다.                                                           | **High**   | ✅ 구현 |
| **FR-02** | **AI 진단**       | **이미지 기반 임시진단**    | - 사용자는 반려동물의 피부, 안구 등 특정 부위 사진을 업로드할 수 있어야 한다.<br>- 시스템은 업로드된 이미지를 AI 서버로 전송하여 분석을 요청해야 한다.<br>- 분석 결과(이상 부위 바운딩 박스, 신뢰도, 심각도)를 사용자에게 시각적으로 명확하게 표시해야 한다. | **High**   | ✅ 구현 |
| **FR-03** | **AI 진단**       | **RAG 기반 대처 방안 제시** | - AI 진단 결과에 따라, RAG/LLM을 통해 생성된 비진단적 소견 및 상황별 대처 방안을 텍스트로 제공해야 한다.<br>- 수의사법을 준수하며, 의료적 진단이 아님을 명확히 고지해야 한다.<br>- pgvector 기반 Vector Similarity Search로 관련 커뮤니티 경험담을 자동 제시해야 한다. | **High**   | ✅ 구현 |
| **FR-04** | **지도 연동**     | **주변 시설 검색**          | - 사용자의 현재 위치를 기반으로 주변 동물병원, 24시 응급실, 약국 등을 지도에 표시해야 한다.<br>- Kakao Map API를 활용하여 거리, 평점, 영업시간 등 상세 정보를 제공해야 한다.                                                                                 | **High**   | ✅ 구현 |
| **FR-05** | **커뮤니티**      | **게시글 CRUD**             | - 사용자는 카테고리별로 게시글을 작성, 조회, 수정, 삭제할 수 있어야 한다.<br>- 게시글 작성 시 이미지와 #해시태그 첨부가 가능해야 한다.<br>- 해시태그는 globalHashtags 테이블과 자동 연동되어야 한다.                                                       | **Medium** | ✅ 구현 |
| **FR-06** | **커뮤니티**      | **상호작용 기능**           | - 사용자는 다른 사람의 게시글에 '좋아요'를 누르거나 댓글을 작성할 수 있어야 한다.<br>- 대댓글 기능을 지원해야 한다.                                                                                                                                          | **Medium** | ✅ 구현 |
| **FR-07** | **커뮤니티**      | **#해시태그 정보 연동**     | - #해시태그를 클릭하면, 해당 태그를 포함하는 다른 게시글 목록과 관련 YouTube 영상을 함께 보여주어야 한다.<br>- 실시간 인기 해시태그 추천 기능을 제공해야 한다.                                                                                                    | **Medium** | ✅ 구현 |
| **FR-08** | **라이프스타일 채팅** ⭐ | **실시간 채팅 시스템** | - 사용자는 #해시태그 기반으로 관심사별 채팅방을 생성하거나 참여할 수 있어야 한다.<br>- Supabase Realtime을 활용한 실시간 메시지 송수신이 가능해야 한다.<br>- 채팅 메시지 작성 시 #해시태그 자동 추출 및 globalHashtags 연동이 이루어져야 한다.<br>- 참여자 목록, 온라인 상태 표시, 이미지 업로드 기능을 제공해야 한다. | **High** ⭐ | ✅ 구현 |
| **FR-09** | **플래너**        | **일정 및 지출 관리**       | - 사용자는 캘린더에 반려동물 관련 일정(병원, 미용)과 지출 내역을 기록하고 관리할 수 있어야 한다.<br>- 지출 기록 시 #해시태그를 추가하여 카테고리별 분류가 가능해야 한다.                                                                                                                                             | **Medium** | ✅ 구현 |
| **FR-10** | **반려동물 관리** | **예방접종 자동 스케줄링**  | - 반려동물 정보(생년월일, 종류) 등록 시, 필수 예방접종 일정이 플래너에 자동으로 생성되어야 한다.<br>- 백신 종류는 데이터베이스 테이블(vaccinationTypes)에서 동적으로 조회되어야 한다.                                                                                                                                             | **Medium** | ✅ 구현 |
| **FR-11** ⭐ | **통합 해시태그 시스템** | **4개 영역 통합 관리** | - globalHashtags 테이블을 중심으로 커뮤니티, 플래너, 라이프스타일 채팅, 지출 영역의 해시태그를 통합 관리해야 한다.<br>- 각 영역별 연결 테이블(communityPostHashtags, plannerEventHashtags, lifestylechatmessagehashtags, spendingHashtags)을 통해 관계를 관리해야 한다.<br>- 실시간 인기 해시태그 조회 함수(get_trending_hashtags_for_lifestyle, get_popular_hashtags_in_room)를 제공해야 한다. | **High** ⭐ | ✅ 구현 |

---

### 🛡️ 비기능적 요구사항 요약 (Non-Functional Requirements)

> 시스템의 품질, 성능, 보안 등과 관련된 요구사항

| ID         | 구분              | 요구사항              | 상세 설명 (Metric)                                                                                               | 상태 |
| :--------- | :---------------- | :-------------------- | :--------------------------------------------------------------------------------------------------------------- | :--- |
| **NFR-01** | **성능**          | **AI 분석 응답 시간** | - 사용자가 이미지를 업로드한 후, AI 분석 결과를 5초 이내에 받아볼 수 있어야 한다.<br>- FastAPI 서버에서 YOLO 추론은 평균 1-3초 이내 완료되어야 한다.                                | ✅ 달성 |
| **NFR-02** | **성능**          | **페이지 로드 속도**  | - 주요 페이지(메인, 커뮤니티, 진단)의 로딩 시간은 2초를 넘지 않아야 한다. (LCP 기준)<br>- Next.js SSR/CSR 하이브리드 렌더링으로 최적화되어야 한다.                             | ✅ 달성 |
| **NFR-03** | **사용성**        | **반응형 웹 디자인** ⭐  | - 데스크톱, 태블릿, 모바일 등 다양한 디바이스 환경에서 UI가 깨지지 않고 최적화된 형태로 보여야 한다.<br>- **4개 브레이크포인트 완벽 대응**: 1280px (데스크톱 대화면), 900px (태블릿 가로), 768px (태블릿 세로), 480px (모바일)             | ✅ 달성 |
| **NFR-04** | **사용성**        | **직관적인 UI/UX**    | - 모든 기능은 사용자가 별도의 학습 없이 직관적으로 사용할 수 있도록 설계되어야 한다.<br>- 라이프스타일 채팅은 말풍선 스타일, 타임스탬프, 읽음 표시 등 현대적 채팅 UI/UX를 제공해야 한다.                             | ✅ 달성 |
| **NFR-05** | **신뢰성/가용성** | **서비스 가동률**     | - 시스템은 연간 99.5% 이상의 가동률을 유지해야 한다. (계획된 점검 시간 제외)<br>- Supabase BaaS 인프라를 통해 높은 가용성을 확보해야 한다.                                     | ✅ 달성 |
| **NFR-06** | **보안**          | **데이터 격리**       | - Supabase의 RLS(Row Level Security) 정책을 통해 사용자는 자신의 데이터에만 접근할 수 있어야 한다.<br>- 40개+ 테이블 전체에 RLS 정책이 적용되어야 한다.               | ✅ 달성 |
| **NFR-07** | **보안**          | **민감 정보 보호**    | - 사용자의 비밀번호 등 모든 민감 정보는 암호화되어 데이터베이스에 저장되어야 한다.<br>- API 키는 .env.local, mcp.json에서 관리하고 .gitignore로 유출을 방지해야 한다.                               | ✅ 달성 |
| **NFR-08** | **확장성**        | **모듈식 아키텍처**   | - AI 서버, 인증, 데이터베이스 등 각 기능은 독립적으로 확장 및 업데이트가 가능한 구조여야 한다. (MSA)<br>- Hook Composition 패턴으로 기능별 완전 독립 구조를 유지해야 한다.             | ✅ 달성 |
| **NFR-09** | **법규 준수**     | **수의사법 준수**     | - AI가 제공하는 모든 정보는 '의료적 진단'이 아닌 '비진단적 관찰 소견' 또는 '참고 정보'임을 명확히 고지해야 한다.<br>- RAG 기반 대처 방안도 '참고용 정보'로 명시해야 한다. | ✅ 달성 |
| **NFR-10** ⭐ | **성능**          | **RAG 검색 응답 시간** | - pgvector 기반 Vector Similarity Search는 1초 이내에 관련 게시글 5개를 조회할 수 있어야 한다.<br>- HuggingFace 임베딩(384차원) 생성은 평균 0.5초 이내 완료되어야 한다. | ✅ 달성 |

---

## 1. 기능적 요구사항 (Functional Requirements)

### 1.1. 사용자 관리 (User Management)

| **ID** | **요구사항** | **우선순위** | **상태** |
|:---:|:---|:---:|:---:|
| **FR-U-01** | 사용자는 이메일과 비밀번호로 회원가입할 수 있어야 한다. | 필수 | ✅ 완료 |
| **FR-U-02** | 사용자는 이메일 인증을 통해 계정을 활성화해야 한다. | 필수 | ✅ 완료 |
| **FR-U-03** | 사용자는 비밀번호를 재설정할 수 있어야 한다. | 필수 | ✅ 완료 |
| **FR-U-04** | 사용자는 프로필 정보(이름, 전화번호, 주소)를 수정할 수 있어야 한다. | 필수 | ✅ 완료 |
| **FR-U-05** | 사용자는 프로필 이미지를 업로드/변경할 수 있어야 한다. | 필수 | ✅ 완료 |
| **FR-U-06** | 사용자는 3D 아바타를 선택할 수 있어야 한다. | 선택 | ✅ 완료 |
| **FR-U-07** | 사용자는 계정을 탈퇴할 수 있어야 한다. | 필수 | ✅ 완료 |
| **FR-U-08** | 회원 탈퇴 시 모든 개인 데이터가 완전히 삭제되어야 한다. | 필수 | ✅ 완료 (2025-11-12) |

**세부 사항 (FR-U-08)**:
- 라이프스타일 채팅 데이터 삭제 (메시지, 참여 기록, 해시태그)
- RAG 지식 베이스 삭제 (커뮤니티 기여 데이터)
- 커뮤니티 데이터 삭제 (게시글, 댓글, 좋아요)
- 플래너 데이터 삭제 (일정, 지출)
- 반려동물 데이터 삭제 (프로필, 백신, 건강 기록)
- Supabase Auth 계정 삭제

---

### 1.2. 반려동물 관리 (Pet Management)

| **ID** | **요구사항** | **우선순위** | **상태** |
|:---:|:---|:---:|:---:|
| **FR-P-01** | 사용자는 반려동물을 등록할 수 있어야 한다 (이름, 생년월일, 품종 등). | 필수 | ✅ 완료 |
| **FR-P-02** | 반려동물 고유 이름(palUniqueName)은 중복되지 않아야 한다. | 필수 | ✅ 완료 |
| **FR-P-03** | 사용자는 반려동물 프로필 이미지를 업로드할 수 있어야 한다. | 필수 | ✅ 완료 |
| **FR-P-04** | 사용자는 반려동물 3D 아바타를 선택할 수 있어야 한다. | 선택 | ✅ 완료 |
| **FR-P-05** | 사용자는 대표 반려동물(isPrimary)을 설정할 수 있어야 한다. | 필수 | ✅ 완료 |
| **FR-P-06** | 사용자는 반려동물 정보를 수정/삭제할 수 있어야 한다. | 필수 | ✅ 완료 |
| **FR-P-07** | 사용자는 반려동물의 건강 기록을 작성할 수 있어야 한다. | 필수 | ✅ 완료 |
| **FR-P-08** | 반려동물 등록 시 생년월일 기반으로 백신 일정이 자동 생성되어야 한다. | 필수 | ✅ 완료 |

---

### 1.3. 백신 관리 (Vaccination Management)

| **ID** | **요구사항** | **우선순위** | **상태** |
|:---:|:---|:---:|:---:|
| **FR-V-01** | 시스템은 6종 백신(DHPPL, 켄넬코프, 광견병 등)을 지원해야 한다. | 필수 | ✅ 완료 |
| **FR-V-02** | 반려동물 생년월일 기반으로 백신 일정이 자동 생성되어야 한다. | 필수 | ✅ 완료 |
| **FR-V-03** | 사용자는 백신 접종 완료를 체크할 수 있어야 한다. | 필수 | ✅ 완료 |
| **FR-V-04** | 백신 일정이 플래너와 실시간 양방향 동기화되어야 한다. | 필수 | ✅ 완료 |
| **FR-V-05** | 백신 긴급도(지연/긴급/곧예정/정상)가 색상으로 표시되어야 한다. | 필수 | ✅ 완료 |
| **FR-V-06** | 구조/입양 반려동물은 수동 백신 일정 입력을 지원해야 한다. | 필수 | ✅ 완료 |
| **FR-V-07** | 백신 접종 현황 요약(completionRate, nextDueDate)이 제공되어야 한다. | 필수 | ✅ 완료 |

---

### 1.4. AI 임시진단 (AI Health Check)

| **ID** | **요구사항** | **우선순위** | **상태** |
|:---:|:---|:---:|:---:|
| **FR-AI-01** | 사용자는 반려동물 이미지를 업로드할 수 있어야 한다 (Drag & Drop 지원). | 필수 | ✅ 완료 |
| **FR-AI-02** | 시스템은 3종 YOLO 모델(Health, Eyes, Skin)을 지원해야 한다. | 필수 | ✅ 완료 |
| **FR-AI-03** | AI 분석 결과는 바운딩 박스로 시각화되어야 한다. | 필수 | ✅ 완료 |
| **FR-AI-04** | AI 분석 결과는 신뢰도(confidence)와 심각도(severity)를 포함해야 한다. | 필수 | ✅ 완료 |
| **FR-AI-05** | 사용자는 AI 분석 결과에 대한 LLM 조언을 받을 수 있어야 한다. | 필수 | ✅ 완료 |
| **FR-AI-06** | 사용자는 3개 LLM(GPT-4, Gemini, Claude) 중 선택할 수 있어야 한다. | 필수 | ✅ 완료 |
| **FR-AI-07** | AI 서버 장애 시 사용자에게 명확한 에러 메시지가 표시되어야 한다. | 필수 | ✅ 완료 |
| **FR-AI-08** | 이미지 분석 중 로딩 상태가 표시되어야 한다. | 필수 | ✅ 완료 |

**YOLO 모델 성능 기준**:
- **Health 모델**: mAP50 ≥ 85% (실제: 88.2%) ✅
- **Eyes 모델**: mAP50 ≥ 20% (실제: 25.4%) ✅
- **Skin 모델**: mAP50 ≥ 15% (실제: 18.3%) ✅

---

### 1.5. RAG 지식 검색 (RAG System) ⭐⭐⭐

| **ID** | **요구사항** | **우선순위** | **상태** |
|:---:|:---|:---:|:---:|
| **FR-RAG-01** | 사용자는 증상 키워드로 유사한 경험담을 검색할 수 있어야 한다. | 필수 | ✅ 완료 (2025-10-14) |
| **FR-RAG-02** | 검색 결과는 코사인 유사도 기반으로 정렬되어야 한다. | 필수 | ✅ 완료 |
| **FR-RAG-03** | 커뮤니티 게시글 작성 시 자동으로 임베딩이 생성되어야 한다. | 필수 | ✅ 완료 |
| **FR-RAG-04** | 검색 결과는 품질 점수(quality_score)로 필터링되어야 한다. | 필수 | ✅ 완료 |
| **FR-RAG-05** | RAG 검색 결과를 LLM에 Context로 전달하여 답변을 생성해야 한다. | 필수 | ✅ 완료 |
| **FR-RAG-06** | 지식 베이스는 출처(source) 추적이 가능해야 한다. | 필수 | ✅ 완료 |

**RAG 시스템 세부 사항**:
- **임베딩 모델**: HuggingFace sentence-transformers/all-MiniLM-L6-v2
- **벡터 차원**: 384차원
- **검색 방식**: pgvector + 코사인 유사도
- **자동 수집**: 커뮤니티 게시글 → 트리거 → 임베딩 생성

---

### 1.6. 플래너 (Planner)

| **ID** | **요구사항** | **우선순위** | **상태** |
|:---:|:---|:---:|:---:|
| **FR-PL-01** | 사용자는 달력에서 날짜를 클릭하여 일정을 생성할 수 있어야 한다. | 필수 | ✅ 완료 |
| **FR-PL-02** | 사용자는 드래그앤드롭으로 연속 일정을 생성할 수 있어야 한다. | 필수 | ✅ 완료 |
| **FR-PL-03** | 일정은 7가지 타입(general, medical, grooming, vaccination 등)을 지원해야 한다. | 필수 | ✅ 완료 |
| **FR-PL-04** | 사용자는 일정을 완료 체크할 수 있어야 한다. | 필수 | ✅ 완료 |
| **FR-PL-05** | 백신 일정과 플래너가 실시간 양방향 동기화되어야 한다. | 필수 | ✅ 완료 |
| **FR-PL-06** | 사용자는 지출(Expense)을 카테고리별로 기록할 수 있어야 한다. | 필수 | ✅ 완료 |
| **FR-PL-07** | 월별 지출 총액이 자동 계산되어야 한다. | 필수 | ✅ 완료 |
| **FR-PL-08** | 일정과 지출에 해시태그를 추가할 수 있어야 한다. | 필수 | ✅ 완료 |
| **FR-PL-09** | 플래너는 반응형 디자인을 지원해야 한다. | 필수 | ✅ 완료 |

---

### 1.7. 커뮤니티 (Community)

| **ID** | **요구사항** | **우선순위** | **상태** |
|:---:|:---|:---:|:---:|
| **FR-CM-01** | 사용자는 게시글을 작성할 수 있어야 한다 (제목, 내용, 이미지, 해시태그). | 필수 | ✅ 완료 |
| **FR-CM-02** | 사용자는 사용자/반려동물 프로필 중 작성자를 선택할 수 있어야 한다. | 필수 | ✅ 완료 |
| **FR-CM-03** | 게시글에서 #{텍스트} 형식의 해시태그가 자동 추출되어야 한다. | 필수 | ✅ 완료 |
| **FR-CM-04** | 사용자는 게시글에 좋아요를 누를 수 있어야 한다. | 필수 | ✅ 완료 |
| **FR-CM-05** | 좋아요 수(likesCount)는 트리거로 자동 집계되어야 한다. | 필수 | ✅ 완료 (2025-10-04) |
| **FR-CM-06** | 사용자는 게시글에 댓글을 작성할 수 있어야 한다. | 필수 | ✅ 완료 |
| **FR-CM-07** | 댓글은 실시간으로 동기화되어야 한다 (Supabase Realtime). | 필수 | ✅ 완료 (2025-11-07) |
| **FR-CM-08** | 댓글 작성 후 새로고침 없이 즉시 반영되어야 한다. | 필수 | ✅ 완료 (2025-11-07) |
| **FR-CM-09** | 게시글 모달 내 댓글과 피드 카드 댓글이 동기화되어야 한다. | 필수 | ✅ 완료 (2025-11-07) |
| **FR-CM-10** | 커뮤니티는 반응형 디자인을 지원해야 한다. | 필수 | ✅ 완료 (2025-11-06) |

---

### 1.8. 라이프스타일 실시간 채팅 (Lifestyle Chat) ⭐⭐⭐

| **ID** | **요구사항** | **우선순위** | **상태** |
|:---:|:---|:---:|:---:|
| **FR-LC-01** | 사용자는 글로벌 로비 채팅방에 참여할 수 있어야 한다. | 필수 | ✅ 완료 (2025-10-07) |
| **FR-LC-02** | 사용자는 해시태그 주제별 채팅방을 생성/참여할 수 있어야 한다. | 필수 | ✅ 완료 (2025-10-07) |
| **FR-LC-03** | 채팅 메시지는 실시간으로 전송/수신되어야 한다 (Supabase Realtime). | 필수 | ✅ 완료 (2025-10-07) |
| **FR-LC-04** | 사용자는 채팅 메시지에 이미지를 첨부할 수 있어야 한다. | 필수 | ✅ 완료 (2025-10-07) |
| **FR-LC-05** | 채팅 메시지에서 #{텍스트} 형식의 해시태그가 자동 추출되어야 한다. | 필수 | ✅ 완료 (2025-10-08) |
| **FR-LC-06** | 실시간 인기 해시태그 Top 5가 표시되어야 한다. | 필수 | ✅ 완료 (2025-10-08) |
| **FR-LC-07** | 채팅방별 인기 해시태그가 표시되어야 한다. | 필수 | ✅ 완료 (2025-10-08) |
| **FR-LC-08** | 사용자는 참여 중인 채팅방을 북마크할 수 있어야 한다. | 필수 | ✅ 완료 (2025-10-07) |
| **FR-LC-09** | 라이프스타일 채팅은 완벽한 반응형 디자인을 지원해야 한다. | 필수 | ✅ 완료 (2025-11-10) |
| **FR-LC-10** | 4단계 브레이크포인트(400px, 768px, 900px, 1280px)를 지원해야 한다. | 필수 | ✅ 완료 (2025-11-10) |

**라이프스타일 채팅 세부 사항** (2025-11-10 완성):
- **반응형 디자인**: 8개 CSS 파일 완전 반응형 적용
- **Flexbox 높이 통제**: `align-items: stretch` + `min-height: 0`
- **Sticky + Tooltip 공존**: `overflow: visible` + Z-Index 레이어링
- **모바일 슬라이드 탭**: 800px 이하에서 자동 전환

---

### 1.9. 병원 찾기 (Hospital Search)

| **ID** | **요구사항** | **우선순위** | **상태** |
|:---:|:---|:---:|:---:|
| **FR-HS-01** | 사용자는 현재 위치 기반으로 주변 동물병원을 검색할 수 있어야 한다. | 필수 | ✅ 완료 |
| **FR-HS-02** | 검색 결과는 거리순으로 정렬되어야 한다. | 필수 | ✅ 완료 |
| **FR-HS-03** | 지도에 병원 위치가 마커로 표시되어야 한다. | 필수 | ✅ 완료 |
| **FR-HS-04** | 사용자는 특정 병원의 상세 정보를 확인할 수 있어야 한다. | 필수 | ✅ 완료 |
| **FR-HS-05** | Kakao Map API를 활용하여 구현되어야 한다. | 필수 | ✅ 완료 |

---

### 1.10. 알림 설정 (Notification Settings)

| **ID** | **요구사항** | **우선순위** | **상태** |
|:---:|:---|:---:|:---:|
| **FR-NS-01** | 사용자는 푸시 알림을 on/off 할 수 있어야 한다. | 필수 | ✅ 완료 |
| **FR-NS-02** | 사용자는 플래너 알림을 on/off 할 수 있어야 한다. | 필수 | ✅ 완료 |
| **FR-NS-03** | 사용자는 커뮤니티 알림을 on/off 할 수 있어야 한다. | 필수 | ✅ 완료 |
| **FR-NS-04** | 사용자는 라이프스타일 알림을 on/off 할 수 있어야 한다. | 필수 | ✅ 완료 (2025-11-02) |

---

## 2. 비기능적 요구사항 (Non-Functional Requirements)

### 2.1. 성능 (Performance)

| **ID** | **요구사항** | **목표** | **상태** |
|:---:|:---|:---:|:---:|
| **NFR-P-01** | 페이지 초기 로딩 시간은 3초 이내여야 한다. | < 3초 | ✅ 달성 (1.8초) |
| **NFR-P-02** | AI 이미지 분석 응답 시간은 10초 이내여야 한다. | < 10초 | ✅ 달성 (3~5초) |
| **NFR-P-03** | 실시간 채팅 메시지 전송 지연은 1초 이내여야 한다. | < 1초 | ✅ 달성 (즉시) |
| **NFR-P-04** | 실시간 댓글 동기화 지연은 1초 이내여야 한다. | < 1초 | ✅ 달성 (즉시) |
| **NFR-P-05** | Hook Composition으로 평균 코드 50% 이상 축소해야 한다. | ≥ 50% | ✅ 달성 (60%) |

---

### 2.2. 보안 (Security)

| **ID** | **요구사항** | **우선순위** | **상태** |
|:---:|:---|:---:|:---:|
| **NFR-S-01** | 모든 API는 JWT 인증을 거쳐야 한다. | 필수 | ✅ 완료 |
| **NFR-S-02** | Row Level Security(RLS) 정책이 모든 테이블에 적용되어야 한다. | 필수 | ✅ 완료 |
| **NFR-S-03** | Function Search Path 공격에 안전해야 한다 (서브쿼리 방식). | 필수 | ✅ 완료 |
| **NFR-S-04** | 민감 정보(API Key)는 환경 변수로 관리되어야 한다. | 필수 | ✅ 완료 |
| **NFR-S-05** | Storage는 폴더별 RLS 정책으로 보호되어야 한다. | 필수 | ✅ 완료 |
| **NFR-S-06** | SQL 취약점은 0건이어야 한다. | 필수 | ✅ 달성 (0건) |
| **NFR-S-07** | 비밀번호는 암호화되어 저장되어야 한다. | 필수 | ✅ 완료 (Supabase Auth) |
| **NFR-S-08** | 회원 탈퇴 시 모든 개인 데이터가 완전히 삭제되어야 한다. | 필수 | ✅ 완료 (2025-11-12) |

**보안 성과**:
- **SQL 취약점**: 6개 → 0개 (100% 해결)
- **Supabase Advisor 경고**: 12개 → 0개 (100% 해결)

---

### 2.3. 반응형 디자인 (Responsive Design) ⭐⭐⭐

| **ID** | **요구사항** | **브레이크포인트** | **상태** |
|:---:|:---|:---:|:---:|
| **NFR-R-01** | Desktop 화면(1281px 이상)을 지원해야 한다. | ≥ 1281px | ✅ 완료 |
| **NFR-R-02** | 중형 화면(901~1280px)을 지원해야 한다. | 901-1280px | ✅ 완료 (2025-11-10) |
| **NFR-R-03** | 소형 화면(769~900px)을 지원해야 한다. | 769-900px | ✅ 완료 (2025-11-10) |
| **NFR-R-04** | 모바일 화면(400~768px)을 지원해야 한다. | 400-768px | ✅ 완료 (2025-11-10) |
| **NFR-R-05** | 초소형 모바일(400px 이하)을 지원해야 한다. | ≤ 400px | ✅ 완료 (2025-11-10) |
| **NFR-R-06** | 모든 페이지가 반응형 디자인을 지원해야 한다. | 전체 | ✅ 완료 (2025-11-10) |
| **NFR-R-07** | 라이프스타일 채팅은 완벽한 반응형을 지원해야 한다. | 전체 | ✅ 완료 (2025-11-10) |

**반응형 디자인 세부 사항** (2025-11-10 완성):
- **4단계 브레이크포인트**: 체계적 축소 전략 (10% → 20% → 30% → 50%)
- **Flexbox 높이 통제**: `align-items: stretch` + `min-height: 0`
- **Sticky + Tooltip 공존**: `overflow: visible` + Z-Index 레이어링 (0 → 10 → 100 → 199999 → 200000)
- **8개 CSS 파일**: lifestyle, realtimechat, bookmarktabs, hashtagrooms, chatroom 등

---

### 2.4. 확장성 (Scalability)

| **ID** | **요구사항** | **우선순위** | **상태** |
|:---:|:---|:---:|:---:|
| **NFR-SC-01** | Hook Composition 패턴으로 코드 재사용성을 확보해야 한다. | 필수 | ✅ 완료 (60% 축소) |
| **NFR-SC-02** | Co-location 구조로 기능별 독립성을 확보해야 한다. | 필수 | ✅ 완료 |
| **NFR-SC-03** | React Native 마이그레이션이 가능한 구조여야 한다. | 선택 | 🚧 준비 중 |
| **NFR-SC-04** | 새로운 YOLO 모델 추가가 용이해야 한다. | 선택 | ✅ 완료 |
| **NFR-SC-05** | 새로운 LLM 추가가 용이해야 한다. | 선택 | ✅ 완료 |

---

### 2.5. 유지보수성 (Maintainability)

| **ID** | **요구사항** | **우선순위** | **상태** |
|:---:|:---|:---:|:---:|
| **NFR-M-01** | BEM 네이밍 패턴을 적용해야 한다. | 필수 | ✅ 완료 |
| **NFR-M-02** | CSS Modules로 스타일을 관리해야 한다. | 필수 | ✅ 완료 |
| **NFR-M-03** | Path Alias로 절대 경로를 사용해야 한다. | 필수 | ✅ 완료 (16개 파일) |
| **NFR-M-04** | 디버깅에 용이한 명확한 클래스명을 사용해야 한다. | 필수 | ✅ 완료 |
| **NFR-M-05** | 주요 함수와 컴포넌트에 주석을 작성해야 한다. | 선택 | 🚧 진행 중 |

---

### 2.6. 사용성 (Usability)

| **ID** | **요구사항** | **우선순위** | **상태** |
|:---:|:---|:---:|:---:|
| **NFR-U-01** | 직관적인 UI/UX를 제공해야 한다. | 필수 | ✅ 완료 |
| **NFR-U-02** | 에러 발생 시 명확한 메시지를 표시해야 한다. | 필수 | ✅ 완료 |
| **NFR-U-03** | 로딩 중에는 로딩 스피너를 표시해야 한다. | 필수 | ✅ 완료 |
| **NFR-U-04** | 모바일에서도 데스크톱과 동일한 기능을 제공해야 한다. | 필수 | ✅ 완료 (2025-11-10) |
| **NFR-U-05** | 다크 / 시스템 모드를 지원해야 한다. | 선택 | ✅ 완료 |

---

### 2.7. 호환성 (Compatibility)

| **ID** | **요구사항** | **우선순위** | **상태** |
|:---:|:---|:---:|:---:|
| **NFR-C-01** | Chrome 최신 버전을 지원해야 한다. | 필수 | ✅ 완료 |
| **NFR-C-02** | Edge 최신 버전을 지원해야 한다. | 필수 | ✅ 완료|
| **NFR-C-03** | 모바일 Chrome을 지원해야 한다. | 필수 | ✅ 완료 |


---

## 3. 데이터 요구사항 (Data Requirements)

### 3.1. 데이터 품질

| **ID** | **요구사항** | **우선순위** | **상태** |
|:---:|:---|:---:|:---:|
| **DR-Q-01** | YOLO 훈련 데이터는 96% 이상 정제되어야 한다. | 필수 | ✅ 달성 (96.8%) |
| **DR-Q-02** | RAG 지식 베이스는 품질 점수를 가져야 한다. | 필수 | ✅ 완료 (quality_score) |
| **DR-Q-03** | 중복 데이터는 자동으로 제거되어야 한다. | 필수 | ✅ 완료 |

### 3.2. 데이터 무결성

| **ID** | **요구사항** | **우선순위** | **상태** |
|:---:|:---|:---:|:---:|
| **DR-I-01** | 외래 키(Foreign Key) 제약이 모든 관계에 적용되어야 한다. | 필수 | ✅ 완료 |
| **DR-I-02** | 고유 제약(Unique Constraint)이 필요한 필드에 적용되어야 한다. | 필수 | ✅ 완료 |
| **DR-I-03** | CASCADE 삭제 정책이 적절히 적용되어야 한다. | 필수 | ✅ 완료 |

---

## 4. 제약 사항 (Constraints)

### 4.1. 기술적 제약

| **제약** | **내용** |
|:---|:---|
| **프레임워크** | Next.js 14 App Router (Pages Router 사용 불가) |
| **데이터베이스** | Supabase PostgreSQL (다른 DB 사용 불가) |
| **AI 모델** | YOLOv8 (다른 버전 사용 불가) |
| **GPU** | NVIDIA RTX 4060 8GB (CUDA 12.1 필수) |

### 4.2. 법적 제약

| **제약** | **내용** |
|:---|:---|
| **수의사법** | AI 진단은 "임시진단"으로만 표현 (확정 진단 불가) |
| **개인정보보호법** | 회원 탈퇴 시 모든 개인 데이터 완전 삭제 필수 |
| **저작권법** | 훈련 데이터는 공공 데이터(AI-Hub) 사용 필수 |

---

## 5. 우선순위 정의

| **우선순위** | **설명** | **구현 시기** |
|:---:|:---|:---:|
| **필수** | 프로젝트 핵심 기능, 반드시 구현 필요 | Phase 1-5 |
| **중요** | 사용자 경험 향상, 가능한 구현 | Phase 6-7 |
| **선택** | 추가 기능, 여유 있을 때 구현 | Phase 8+ |

---

## 6. 변경 이력 (Change History)

| **날짜** | **버전** | **변경 내용** | **작성자** |
|:---:|:---:|:---|:---:|
| 2025-10-14 | v3.1 | RAG 시스템 요구사항 추가 | 석이 |
| 2025-11-02 | v3.2 | 라이프스타일 알림 설정 추가 | 석이 |
| 2025-11-07 | v3.3 | 실시간 댓글 시스템 요구사항 추가 | 석이 |
| 2025-11-10 | v4.0 | 완벽한 반응형 디자인 요구사항 추가 | 석이 |
| 2025-11-12 | v4.1 | 회원 탈퇴 완전 삭제 요구사항 추가 | 석이 |
| 2025-11-14 | v4.2 | 4차 스프린트 최종 정리 | 석이 + Claude |

---

**📝 문서 정보**
- **작성일**: 2025-11-14
- **작성자**: 석이 + Claude
- **버전**: v4.2 (4차 스프린트)
- **이전 문서**: [251114_05_ERD.md](./251114_05_ERD.md)
- **다음 문서**: [251114_07_성과_및_개선사항.md](./251114_07_성과_및_개선사항.md)

