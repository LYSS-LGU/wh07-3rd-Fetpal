<!DOCTYPE html>
<html lang="ko">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>08 RAG-LLM ì‹œìŠ¤í…œ ì •ì˜ì„œ</title>

    <!-- Mermaid.js CDN -->
    <script type="module">
        import mermaid from 'https://cdn.jsdelivr.net/npm/mermaid@10/dist/mermaid.esm.min.mjs';
        mermaid.initialize({
            startOnLoad: true,
            theme: 'default',
            securityLevel: 'loose',
            flowchart: {
                useMaxWidth: true,
                htmlLabels: true,
                curve: 'basis'
            },
            sequence: {
                diagramMarginX: 50,
                diagramMarginY: 10,
                actorMargin: 50,
                width: 150,
                height: 65,
                boxMargin: 10,
                boxTextMargin: 5,
                noteMargin: 10,
                messageMargin: 35,
                mirrorActors: true,
                useMaxWidth: true
            }
        });
    </script>

    <style>
        @media print {
            @page {
                size: A4 portrait;
                margin: 2cm;
            }

            /* ë¸Œë¼ìš°ì € ê¸°ë³¸ í—¤ë”/í‘¸í„° ìˆ¨ê¸°ê¸° */
            @page {
                margin-top: 2cm;
                margin-bottom: 2cm;
            }

            body {
                margin: 0;
                padding: 0;
            }

            .print-button {
                display: none !important;
            }

            /* Mermaid ë‹¤ì´ì–´ê·¸ë¨ í˜ì´ì§€ ë¸Œë ˆì´í¬ ë°©ì§€ */
            .mermaid {
                page-break-inside: avoid;
                break-inside: avoid;
            }

            pre {
                page-break-inside: avoid;
            }
        }

        * {
            box-sizing: border-box;
        }

        body {
            font-family: -apple-system, BlinkMacSystemFont, "Malgun Gothic", "ë§‘ì€ ê³ ë”•",
                         "Segoe UI", "Noto Sans KR", Arial, sans-serif;
            line-height: 1.7;
            color: #24292e;
            max-width: 1200px;
            margin: 0 auto;
            padding: 40px 20px;
            background: #ffffff;
        }

        /* í—¤ë” ìŠ¤íƒ€ì¼ */
        h1 {
            color: #1a1a1a;
            border-bottom: 4px solid #0366d6;
            padding-bottom: 12px;
            margin-top: 32px;
            margin-bottom: 24px;
            font-size: 2.2em;
            font-weight: 700;
            page-break-after: avoid;
        }

        h2 {
            color: #24292e;
            border-bottom: 2px solid #e1e4e8;
            padding-bottom: 10px;
            margin-top: 28px;
            margin-bottom: 20px;
            font-size: 1.8em;
            font-weight: 600;
            page-break-after: avoid;
        }

        h3 {
            color: #24292e;
            margin-top: 24px;
            margin-bottom: 16px;
            font-size: 1.4em;
            font-weight: 600;
        }

        h4 {
            color: #24292e;
            margin-top: 20px;
            margin-bottom: 12px;
            font-size: 1.2em;
            font-weight: 600;
        }

        /* ë‹¨ë½ ë° í…ìŠ¤íŠ¸ */
        p {
            margin: 16px 0;
        }

        /* ë¦¬ìŠ¤íŠ¸ */
        ul, ol {
            margin: 16px 0;
            padding-left: 32px;
        }

        li {
            margin: 8px 0;
        }

        /* í…Œì´ë¸” */
        table {
            border-collapse: collapse;
            width: 100%;
            margin: 24px 0;
            font-size: 0.95em;
        }

        th, td {
            border: 1px solid #d0d7de;
            padding: 12px 16px;
            text-align: left;
        }

        th {
            background-color: #0366d6;
            color: white;
            font-weight: 600;
        }

        tr:nth-child(even) {
            background-color: #f6f8fa;
        }

        tr:hover {
            background-color: #f0f3f5;
        }

        /* ì½”ë“œ ë¸”ë¡ */
        code {
            background-color: #f6f8fa;
            padding: 3px 6px;
            border-radius: 3px;
            font-family: "Consolas", "Monaco", "Courier New", monospace;
            font-size: 0.9em;
            color: #24292e;
        }

        pre {
            background-color: #f6f8fa;
            padding: 16px;
            border-radius: 6px;
            overflow-x: auto;
            border-left: 4px solid #0366d6;
            margin: 16px 0;
        }

        pre code {
            background-color: transparent;
            padding: 0;
        }

        /* Blockquote */
        blockquote {
            border-left: 4px solid #0366d6;
            padding-left: 20px;
            margin: 20px 0;
            color: #57606a;
            background-color: #f6f8fa;
            padding: 15px 20px;
            border-radius: 4px;
        }

        /* ìˆ˜í‰ì„  */
        hr {
            border: none;
            border-top: 2px solid #e1e4e8;
            margin: 32px 0;
        }

        /* Mermaid ë‹¤ì´ì–´ê·¸ë¨ */
        .mermaid {
            margin: 24px 0;
            text-align: center;
            background-color: #f9f9f9;
            padding: 20px;
            border-radius: 8px;
        }

        .mermaid svg {
            max-width: 100%;
            height: auto;
        }

        /* ì´ë¯¸ì§€ */
        img {
            max-width: 100%;
            height: auto;
            display: block;
            margin: 20px auto;
        }

        /* ì¸ì‡„ ë²„íŠ¼ */
        .print-button {
            position: fixed;
            top: 20px;
            right: 20px;
            padding: 12px 24px;
            background-color: #0366d6;
            color: white;
            border: none;
            border-radius: 6px;
            cursor: pointer;
            font-size: 16px;
            font-weight: 600;
            box-shadow: 0 2px 8px rgba(0,0,0,0.15);
            transition: background-color 0.2s;
            z-index: 1000;
        }

        .print-button:hover {
            background-color: #0256c7;
        }

        /* ê°•ì¡° */
        strong {
            color: #24292e;
            font-weight: 600;
        }

        em {
            color: #57606a;
            font-style: italic;
        }

        /* ë§í¬ */
        a {
            color: #0366d6;
            text-decoration: none;
        }

        a:hover {
            text-decoration: underline;
        }
    </style>
</head>
<body>
    <button class="print-button" onclick="window.print()">
        <span>ğŸ–¨ï¸</span> PDFë¡œ ì €ì¥
    </button>

<h1>Fetpal - RAG-LLM ì‹œìŠ¤í…œ ì •ì˜ì„œ</h1>
<blockquote>
<p><strong>4ì°¨ ìŠ¤í”„ë¦°íŠ¸ ë°œí‘œ</strong> (2025.11.14)<br />
<strong>ìµœì¢… ë°œí‘œ</strong>: 2025-11-21</p>
</blockquote>
<hr />
<h2>ğŸ“‹ ë¬¸ì„œ ê°œìš”</h2>
<p>ì´ ë¬¸ì„œëŠ” Fetpal í”„ë¡œì íŠ¸ì˜ <strong>RAG (Retrieval-Augmented Generation)</strong> ì‹œìŠ¤í…œê³¼ <strong>Multi-LLM í†µí•©</strong> ì•„í‚¤í…ì²˜ë¥¼ ì„¤ëª…í•©ë‹ˆë‹¤.<br />
ì»¤ë®¤ë‹ˆí‹° ê²½í—˜ë‹´ ê²€ìƒ‰ê³¼ AI ì±—ë´‡ ì¡°ì–¸ì„ í†µí•´ ì‚¬ìš©ìì—ê²Œ ì‹ ë¢°ë„ ë†’ì€ ì •ë³´ë¥¼ ì œê³µí•©ë‹ˆë‹¤.</p>
<hr />
<h2>ğŸ¯ í”„ë¡œì íŠ¸ ê°œìš”</h2>
<h3>í•µì‹¬ ê¸°ëŠ¥</h3>
<p><strong>ğŸ§  RAG ê¸°ë°˜ ì§€ì‹ ê²€ìƒ‰</strong></p>
<ul>
<li>pgvector (384ì°¨ì›) ë²¡í„° ìœ ì‚¬ë„ ê²€ìƒ‰</li>
<li>ì»¤ë®¤ë‹ˆí‹° ê²½í—˜ë‹´ ìë™ ì—°ê²°</li>
<li>HuggingFace ì„ë² ë”© ìƒì„±</li>
</ul>
<blockquote>
<p><strong>ğŸ’¡ ìš©ì–´ ì„¤ëª…</strong></p>
<ul>
<li><strong>RAG</strong>: Retrieval-Augmented Generation (ê²€ìƒ‰ ì¦ê°• ìƒì„±)</li>
<li>ì‰½ê²Œ ë§í•˜ë©´: AIê°€ ë‹µë³€í•˜ê¸° ì „ì— ê´€ë ¨ ì •ë³´ë¥¼ ë¨¼ì € ì°¾ì•„ì„œ ì°¸ê³ í•˜ëŠ” ë°©ì‹</li>
<li><strong>ë²¡í„°</strong>: í…ìŠ¤íŠ¸ë¥¼ ìˆ«ì ë°°ì—´ë¡œ ë³€í™˜í•œ ê²ƒ (ì»´í“¨í„°ê°€ ì´í•´í•  ìˆ˜ ìˆëŠ” í˜•íƒœ)</li>
<li><strong>ì„ë² ë”©</strong>: í…ìŠ¤íŠ¸ë¥¼ ë²¡í„°ë¡œ ë³€í™˜í•˜ëŠ” ê³¼ì •</li>
<li><strong>384ì°¨ì›</strong>: ë²¡í„°ì˜ ê¸¸ì´ (384ê°œì˜ ìˆ«ìë¡œ í‘œí˜„)</li>
</ul>
</blockquote>
<p><strong>ğŸ¤– Multi-LLM í†µí•©</strong></p>
<ul>
<li>OpenAI GPT-4</li>
<li>Google Gemini</li>
<li>Anthropic Claude</li>
<li>ì‚¬ìš©ìê°€ ì›í•˜ëŠ” LLM ì„ íƒ ê°€ëŠ¥</li>
</ul>
<blockquote>
<p><strong>ğŸ’¡ ìš©ì–´ ì„¤ëª…</strong></p>
<ul>
<li><strong>LLM</strong>: Large Language Model (ëŒ€ê·œëª¨ ì–¸ì–´ ëª¨ë¸)</li>
<li>ì‰½ê²Œ ë§í•˜ë©´: ChatGPTì²˜ëŸ¼ ì‚¬ëŒì²˜ëŸ¼ ëŒ€í™”í•  ìˆ˜ ìˆëŠ” AI</li>
<li><strong>Multi-LLM</strong>: ì—¬ëŸ¬ ê°œì˜ LLMì„ ì§€ì›í•œë‹¤ëŠ” ëœ»</li>
<li>í•œ ê°œê°€ ì•ˆ ë˜ë©´ ë‹¤ë¥¸ ê²ƒì„ ì“¸ ìˆ˜ ìˆì–´ì„œ ì•ˆì •ì </li>
</ul>
</blockquote>
<h3>ì‹œìŠ¤í…œ êµ¬ì„± (ê°„ëµ)</h3>
<blockquote>
<p><strong>ğŸ’¡ ì´ ë‹¤ì´ì–´ê·¸ë¨ì€?</strong><br />
RAG-LLM ì‹œìŠ¤í…œì˜ í•µì‹¬ êµ¬ì„± ìš”ì†Œë¥¼ ê°„ë‹¨íˆ ë³´ì—¬ì¤ë‹ˆë‹¤. ìì„¸í•œ ë‚´ìš©ì€ <a href="#6-rag-llm-ai-ì±—ë´‡-ì‹œìŠ¤í…œ-ì•„í‚¤í…ì²˜">6. RAG-LLM AI ì±—ë´‡ ì‹œìŠ¤í…œ ì•„í‚¤í…ì²˜</a>ë¥¼ ì°¸ê³ í•˜ì„¸ìš”.</p>
</blockquote>
<div class="mermaid">
graph TB
    User[ğŸ‘¤ ì‚¬ìš©ì] --> Frontend[ğŸŒ Next.js Frontend]
    Frontend --> Supabase[â˜ï¸ Supabase BaaS]
    Frontend --> LLM[ğŸ¤– LLM APIs]

    Supabase --> PostgreSQL[(ğŸ˜ PostgreSQL<br/>+ pgvector)]
    PostgreSQL --> RAG[ğŸ§  RAG System<br/>384ì°¨ì› ë²¡í„°]
    RAG --> HuggingFace[ğŸ¤— HuggingFace<br/>Embedding API]

    LLM --> GPT[OpenAI GPT-4]
    LLM --> Gemini[Google Gemini]
    LLM --> Claude[Anthropic Claude]

    style User fill:#E3F2FD
    style Frontend fill:#F3E5F5
    style Supabase fill:#E0F2F1
    style PostgreSQL fill:#FFF3E0
    style RAG fill:#E8EAF6
    style LLM fill:#FCE4EC
</div>

<blockquote>
<p><strong>ğŸ’¡ pgvectorë€?</strong></p>
<ul>
<li>PostgreSQL ë°ì´í„°ë² ì´ìŠ¤ì—ì„œ ë²¡í„°(ìˆ«ì ë°°ì—´)ë¥¼ ì €ì¥í•˜ê³  ê²€ìƒ‰í•  ìˆ˜ ìˆê²Œ í•´ì£¼ëŠ” í™•ì¥ í”„ë¡œê·¸ë¨ì…ë‹ˆë‹¤</li>
<li><strong>ì¼ë°˜ DB</strong>: "ì´ë¦„ì´ 'ë©ë©ì´'ì¸ ê°œ ì°¾ê¸°" (ì •í™•íˆ ì¼ì¹˜í•˜ëŠ” ê²ƒë§Œ ì°¾ìŒ)</li>
<li><strong>pgvector DB</strong>: "ê°•ì•„ì§€ ê¸°ì¹¨ê³¼ ë¹„ìŠ·í•œ ë‚´ìš© ì°¾ê¸°" (ì˜ë¯¸ê°€ ë¹„ìŠ·í•œ ê²ƒì„ ì°¾ìŒ)</li>
<li>RAG ì‹œìŠ¤í…œì˜ í•µì‹¬ ê¸°ìˆ ë¡œ, 384ì°¨ì› ë²¡í„°ë¥¼ ì €ì¥í•˜ê³  ì½”ì‚¬ì¸ ìœ ì‚¬ë„ë¡œ ë¹ ë¥´ê²Œ ê²€ìƒ‰í•©ë‹ˆë‹¤</li>
<li>ë•ë¶„ì— ìˆ˜ì²œ ê°œì˜ ê²Œì‹œê¸€ ì¤‘ì—ì„œ 0.5ì´ˆ ì´ë‚´ì— ê´€ë ¨ ìˆëŠ” ê¸€ 5ê°œë¥¼ ì°¾ì•„ë‚¼ ìˆ˜ ìˆìŠµë‹ˆë‹¤</li>
</ul>
</blockquote>
<hr />
<h2>ğŸ“Œ ëª©ì°¨</h2>
<ol>
<li><a href="#1-rag-ì‹œìŠ¤í…œ-ê°œìš”">RAG ì‹œìŠ¤í…œ ê°œìš”</a></li>
<li><a href="#2-ë°ì´í„°ë² ì´ìŠ¤-êµ¬ì¡°">ë°ì´í„°ë² ì´ìŠ¤ êµ¬ì¡°</a></li>
<li><a href="#3-ì„ë² ë”©-ìƒì„±-í”„ë¡œì„¸ìŠ¤">ì„ë² ë”© ìƒì„± í”„ë¡œì„¸ìŠ¤</a></li>
<li><a href="#4-ë²¡í„°-ê²€ìƒ‰-í”Œë¡œìš°">ë²¡í„° ê²€ìƒ‰ í”Œë¡œìš°</a></li>
<li><a href="#5-multi-llm-í†µí•©">Multi-LLM í†µí•©</a></li>
<li><a href="#6-rag-llm-ai-ì±—ë´‡-ì‹œìŠ¤í…œ-ì•„í‚¤í…ì²˜">RAG-LLM AI ì±—ë´‡ ì‹œìŠ¤í…œ ì•„í‚¤í…ì²˜</a></li>
<li><a href="#7-ì„±ëŠ¥-ë¶„ì„">ì„±ëŠ¥ ë¶„ì„</a></li>
</ol>
<hr />
<h2>1. RAG ì‹œìŠ¤í…œ ê°œìš”</h2>
<h3>1.1. RAGë€?</h3>
<p><strong>RAG (Retrieval-Augmented Generation)</strong> - ê²€ìƒ‰ ì¦ê°• ìƒì„±</p>
<blockquote>
<p><strong>ğŸ’¡ RAGë¥¼ ì‰½ê²Œ ì„¤ëª…í•˜ë©´?</strong></p>
<ul>
<li>ì‹œí—˜ ë³¼ ë•Œ ì±…ì„ ë³´ë©´ì„œ ë‹µí•˜ëŠ” ê²ƒê³¼ ë¹„ìŠ·í•©ë‹ˆë‹¤</li>
<li>AIê°€ ë‹µë³€í•˜ê¸° ì „ì— ê´€ë ¨ ìë£Œ(ì»¤ë®¤ë‹ˆí‹° ê²Œì‹œê¸€)ë¥¼ ë¨¼ì € ì°¾ì•„ë³´ê³  ì°¸ê³ í•´ì„œ ë‹µë³€í•©ë‹ˆë‹¤</li>
<li>ê·¸ëƒ¥ ì™¸ìš´ ê±¸ë¡œ ë‹µí•˜ëŠ” ê²ƒë³´ë‹¤ í›¨ì”¬ ì •í™•í•©ë‹ˆë‹¤!</li>
</ul>
</blockquote>
<p><strong>ì‘ë™ ë°©ì‹:</strong></p>
<ol>
<li>ì‚¬ìš©ì ì§ˆë¬¸ì„ ë²¡í„°ë¡œ ë³€í™˜ (HuggingFace 384ì°¨ì›)</li>
<li>ë²¡í„°: í…ìŠ¤íŠ¸ë¥¼ ìˆ«ì ë°°ì—´ë¡œ ë°”ê¾¼ ê²ƒ (ì˜ˆ: [0.5, 0.8, 0.2, ...])</li>
<li>pgvectorë¡œ ìœ ì‚¬ë„ ê²€ìƒ‰ (Cosine Similarity)</li>
<li>ìœ ì‚¬ë„: ì–¼ë§ˆë‚˜ ë¹„ìŠ·í•œì§€ 0~1 ì‚¬ì´ ê°’ìœ¼ë¡œ ê³„ì‚°</li>
<li>ì»¤ë®¤ë‹ˆí‹° ê²Œì‹œê¸€ ì¤‘ ìœ ì‚¬í•œ ê²½í—˜ë‹´ Top 5 ë°˜í™˜</li>
<li>LLMì—ê²Œ ê²€ìƒ‰ ê²°ê³¼ë¥¼ ì»¨í…ìŠ¤íŠ¸ë¡œ ì œê³µí•˜ì—¬ ì‹ ë¢°ë„ ë†’ì€ ë‹µë³€ ìƒì„±</li>
</ol>
<h3>1.2. ì™œ RAGë¥¼ ì‚¬ìš©í•˜ë‚˜?</h3>
<div class="mermaid">
graph LR
    A[ì¼ë°˜ LLM] --> B[í›ˆë ¨ëœ ì§€ì‹ë§Œ ì‚¬ìš©]
    B --> C[ì˜¤ë˜ëœ ì •ë³´<br/>í™˜ê° í˜„ìƒ ê°€ëŠ¥]

    D[RAG + LLM] --> E[ì‹¤ì‹œê°„ ë°ì´í„° ê²€ìƒ‰]
    E --> F[ìµœì‹  ì»¤ë®¤ë‹ˆí‹° ê²½í—˜ë‹´<br/>ë†’ì€ ì‹ ë¢°ë„]

    style A fill:#FFCDD2
    style C fill:#FFCDD2
    style D fill:#C8E6C9
    style F fill:#C8E6C9
</div>

<p><strong>ì¥ì :</strong></p>
<ul>
<li>âœ… ìµœì‹  ì •ë³´ í™œìš© (ì»¤ë®¤ë‹ˆí‹° ê²Œì‹œê¸€)</li>
<li>âœ… í™˜ê°(Hallucination) í˜„ìƒ ê°ì†Œ</li>
<li>âœ… ì¶œì²˜ ì¶”ì  ê°€ëŠ¥ (source_url)</li>
<li>âœ… ì‚¬ìš©ì ê²½í—˜ë‹´ ê¸°ë°˜ ë‹µë³€</li>
</ul>
<hr />
<h2>2. ë°ì´í„°ë² ì´ìŠ¤ êµ¬ì¡°</h2>
<h3>2.1. pet_knowledge_base í…Œì´ë¸” êµ¬ì¡°</h3>
<blockquote>
<p><strong>ğŸ’¡ pet_knowledge_baseë€?</strong></p>
<ul>
<li>ì»¤ë®¤ë‹ˆí‹° ê²Œì‹œê¸€ì„ AIê°€ ê²€ìƒ‰í•  ìˆ˜ ìˆëŠ” í˜•íƒœë¡œ ì €ì¥í•˜ëŠ” í…Œì´ë¸”ì…ë‹ˆë‹¤</li>
<li>ê° ê²Œì‹œê¸€ë§ˆë‹¤ 384ê°œì˜ ìˆ«ì(ë²¡í„°)ë¡œ ë³€í™˜í•´ì„œ ì €ì¥í•©ë‹ˆë‹¤</li>
<li>ì´ë ‡ê²Œ í•˜ë©´ ì˜ë¯¸ê°€ ë¹„ìŠ·í•œ ê¸€ì„ ë¹ ë¥´ê²Œ ì°¾ì„ ìˆ˜ ìˆìŠµë‹ˆë‹¤</li>
</ul>
</blockquote>
<pre><code class="language-sql">-- RAG ì§€ì‹ ë² ì´ìŠ¤ í…Œì´ë¸”
CREATE TABLE pet_knowledge_base (
  id UUID PRIMARY KEY DEFAULT uuid_generate_v4(),
  content TEXT NOT NULL,                    -- ê²Œì‹œê¸€ ë‚´ìš©
  embedding VECTOR(384),                    -- HuggingFace ì„ë² ë”© (384ì°¨ì› ë²¡í„°)
  source TEXT CHECK (source IN ('community', 'faq', 'youtube', 'manual')),
  source_url TEXT,                          -- ì›ë³¸ ê²Œì‹œê¸€ URL
  quality_score NUMERIC(3,2) CHECK (quality_score &gt;= 0 AND quality_score &lt;= 1),
  is_verified BOOLEAN DEFAULT FALSE,        -- ìˆ˜ì˜ì‚¬ ê²€ì¦ ì—¬ë¶€
  metadata JSONB,                           -- ì¶”ê°€ ì •ë³´ (í•´ì‹œíƒœê·¸, ì‘ì„±ì ë“±)
  created_at TIMESTAMP WITH TIME ZONE DEFAULT TIMEZONE('utc', NOW()),
  updated_at TIMESTAMP WITH TIME ZONE DEFAULT TIMEZONE('utc', NOW())
);

-- Vector Similarity Search Index (pgvector)
-- ì¸ë±ìŠ¤: ê²€ìƒ‰ ì†ë„ë¥¼ ë¹ ë¥´ê²Œ í•˜ê¸° ìœ„í•œ ëª©ì°¨ ê°™ì€ ê²ƒ
CREATE INDEX ON pet_knowledge_base USING ivfflat (embedding vector_cosine_ops);
</code></pre>
<h3>2.2. í…Œì´ë¸” í•„ë“œ ì„¤ëª…</h3>
<table>
<thead>
<tr>
<th>í•„ë“œ</th>
<th>íƒ€ì…</th>
<th>ì„¤ëª…</th>
</tr>
</thead>
<tbody>
<tr>
<td><strong>id</strong></td>
<td>UUID</td>
<td>ê³ ìœ  ì‹ë³„ì</td>
</tr>
<tr>
<td><strong>content</strong></td>
<td>TEXT</td>
<td>ê²Œì‹œê¸€ ë‚´ìš© (ì„ë² ë”© ëŒ€ìƒ)</td>
</tr>
<tr>
<td><strong>embedding</strong></td>
<td>VECTOR(384)</td>
<td>HuggingFace ì„ë² ë”© ë²¡í„° (384ì°¨ì› = 384ê°œì˜ ìˆ«ì ë°°ì—´)</td>
</tr>
<tr>
<td><strong>source</strong></td>
<td>TEXT</td>
<td>ì¶œì²˜ (community, faq, youtube, manual)</td>
</tr>
<tr>
<td><strong>source_url</strong></td>
<td>TEXT</td>
<td>ì›ë³¸ ê²Œì‹œê¸€ URL</td>
</tr>
<tr>
<td><strong>quality_score</strong></td>
<td>NUMERIC(3,2)</td>
<td>í’ˆì§ˆ ì ìˆ˜ (0.00~1.00, ë†’ì„ìˆ˜ë¡ ì‹ ë¢°ë„ ë†’ìŒ)</td>
</tr>
<tr>
<td><strong>is_verified</strong></td>
<td>BOOLEAN</td>
<td>ìˆ˜ì˜ì‚¬ ê²€ì¦ ì—¬ë¶€ (trueë©´ ì „ë¬¸ê°€ê°€ í™•ì¸í•œ ê¸€)</td>
</tr>
<tr>
<td><strong>metadata</strong></td>
<td>JSONB</td>
<td>ì¶”ê°€ ì •ë³´ (í•´ì‹œíƒœê·¸, ì‘ì„±ì ë“±ì„ JSON í˜•íƒœë¡œ ì €ì¥)</td>
</tr>
</tbody>
</table>
<blockquote>
<p><strong>ğŸ’¡ VECTOR(384)ê°€ ë­”ê°€ìš”?</strong></p>
<ul>
<li>"ìš°ë¦¬ ê°•ì•„ì§€ê°€ ê¸°ì¹¨ì„ í•´ìš”" ê°™ì€ í…ìŠ¤íŠ¸ë¥¼ [0.5, 0.8, 0.2, ..., 0.1] ì´ëŸ° ì‹ìœ¼ë¡œ 384ê°œì˜ ìˆ«ìë¡œ ë³€í™˜</li>
<li>ë¹„ìŠ·í•œ ì˜ë¯¸ì˜ ê¸€ì€ ë¹„ìŠ·í•œ ìˆ«ì ë°°ì—´ì„ ê°€ì§</li>
<li>ì˜ˆ: "ê¸°ì¹¨" ê´€ë ¨ ê¸€ë“¤ì€ ë¹„ìŠ·í•œ ë²¡í„° ê°’ì„ ê°€ì ¸ì„œ ì°¾ê¸° ì‰¬ì›€</li>
</ul>
</blockquote>
<h3>2.3. pgvector í™•ì¥ í™œì„±í™”</h3>
<pre><code class="language-sql">-- pgvector í™•ì¥ ì„¤ì¹˜ (Supabaseì—ì„œ ìë™ ì œê³µ)
CREATE EXTENSION IF NOT EXISTS vector;
</code></pre>
<hr />
<h2>3. ì„ë² ë”© ìƒì„± í”„ë¡œì„¸ìŠ¤</h2>
<h3>3.1. ì„ë² ë”©ì´ë€?</h3>
<p><strong>ì„ë² ë”© (Embedding)</strong> - í…ìŠ¤íŠ¸ë¥¼ ìˆ«ì ë²¡í„°ë¡œ ë³€í™˜í•˜ëŠ” ê¸°ìˆ </p>
<blockquote>
<p><strong>ğŸ’¡ ì„ë² ë”©ì„ ì‰½ê²Œ ì„¤ëª…í•˜ë©´?</strong></p>
<ul>
<li>ì‚¬ëŒì˜ ë§(í…ìŠ¤íŠ¸)ì„ ì»´í“¨í„°ê°€ ì´í•´í•  ìˆ˜ ìˆëŠ” ìˆ«ìë¡œ ë°”ê¾¸ëŠ” ê²ƒì…ë‹ˆë‹¤</li>
<li>ì˜ë¯¸ê°€ ìœ ì‚¬í•œ í…ìŠ¤íŠ¸ëŠ” ê°€ê¹Œìš´ ë²¡í„° ê°’ì„ ê°€ì§</li>
<li>384ì°¨ì› ë²¡í„°ë¡œ í‘œí˜„ (HuggingFace sentence-transformers)</li>
</ul>
</blockquote>
<p><strong>ì˜ˆì‹œ:</strong></p>
<pre><code>&quot;ê°•ì•„ì§€ ê¸°ì¹¨&quot; â†’ [0.5, 0.8, 0.2, 0.1, ..., 0.3]  (384ê°œ)
&quot;ê°œ ê¸°ì¹¨ì†Œë¦¬&quot; â†’ [0.5, 0.7, 0.2, 0.2, ..., 0.3]  (ë¹„ìŠ·í•œ ìˆ«ìë“¤!)
&quot;ê³ ì–‘ì´ ë°¥&quot;   â†’ [0.1, 0.2, 0.9, 0.8, ..., 0.1]  (ì „í˜€ ë‹¤ë¥¸ ìˆ«ìë“¤)
</code></pre>
<ul>
<li>"ê°•ì•„ì§€ ê¸°ì¹¨"ê³¼ "ê°œ ê¸°ì¹¨ì†Œë¦¬"ëŠ” ë¹„ìŠ·í•œ ì˜ë¯¸ë¼ì„œ ìˆ«ì ë°°ì—´ë„ ë¹„ìŠ·í•¨</li>
<li>"ê³ ì–‘ì´ ë°¥"ì€ ë‹¤ë¥¸ ì£¼ì œë¼ì„œ ìˆ«ì ë°°ì—´ì´ ì™„ì „íˆ ë‹¤ë¦„</li>
</ul>
<h3>3.2. ìë™ ì„ë² ë”© ìƒì„± í”Œë¡œìš°</h3>
<div class="mermaid">
sequenceDiagram
    participant User as ğŸ‘¤ ì‚¬ìš©ì
    participant Frontend as ğŸŒ Frontend
    participant DB as ğŸ˜ PostgreSQL
    participant Trigger as ğŸ”„ DB Trigger
    participant HF as ğŸ¤— HuggingFace

    User->>Frontend: 1. ê²Œì‹œê¸€ ì‘ì„± (ì œëª©, ë‚´ìš©)
    Frontend->>DB: 2. communityPosts INSERT
    DB->>Trigger: 3. auto_generate_embedding_on_post()
    Trigger->>HF: 4. POST /api/embeddings (í…ìŠ¤íŠ¸)
    HF->>HF: 5. sentence-transformers ëª¨ë¸ë¡œ ë³€í™˜
    HF->>Trigger: 6. 384ì°¨ì› ë²¡í„° ë°˜í™˜
    Trigger->>DB: 7. pet_knowledge_base INSERT (content + embedding)
    DB->>Frontend: 8. ê²Œì‹œê¸€ ìƒì„± ì™„ë£Œ
    Frontend->>User: 9. í”¼ë“œì— ìƒˆ ê²Œì‹œê¸€ í‘œì‹œ
</div>

<h3>3.3. íŠ¸ë¦¬ê±° í•¨ìˆ˜ ì˜ˆì‹œ</h3>
<pre><code class="language-sql">-- ê²Œì‹œê¸€ ì‘ì„± ì‹œ ìë™ìœ¼ë¡œ ì„ë² ë”© ìƒì„±
CREATE OR REPLACE FUNCTION auto_generate_embedding_on_post()
RETURNS TRIGGER AS $$
BEGIN
  -- HuggingFace API í˜¸ì¶œí•˜ì—¬ ì„ë² ë”© ìƒì„±
  -- (ì‹¤ì œ êµ¬í˜„ì€ Next.js API Routeì—ì„œ ì²˜ë¦¬)

  INSERT INTO pet_knowledge_base (
    content,
    source,
    source_url,
    quality_score,
    metadata
  ) VALUES (
    NEW.title || ' ' || NEW.content,
    'community',
    '/community/post/' || NEW.id,
    0.80,
    jsonb_build_object('post_id', NEW.id, 'user_id', NEW.userId)
  );

  RETURN NEW;
END;
$$ LANGUAGE plpgsql;

-- íŠ¸ë¦¬ê±° ìƒì„±
CREATE TRIGGER trigger_auto_embedding
AFTER INSERT ON communityPosts
FOR EACH ROW
EXECUTE FUNCTION auto_generate_embedding_on_post();
</code></pre>
<h3>3.4. HuggingFace Embedding API</h3>
<pre><code class="language-javascript">// Next.js API Route: /api/embeddings
export async function POST(req) {
  const { text } = await req.json();

  const response = await fetch(
    &quot;https://api-inference.huggingface.co/models/sentence-transformers/all-MiniLM-L6-v2&quot;,
    {
      method: &quot;POST&quot;,
      headers: {
        Authorization: `Bearer ${process.env.HUGGINGFACE_API_KEY}`,
        &quot;Content-Type&quot;: &quot;application/json&quot;,
      },
      body: JSON.stringify({ inputs: text }),
    }
  );

  const embedding = await response.json();

  return Response.json({ embedding }); // 384ì°¨ì› ë²¡í„° ë°˜í™˜
}
</code></pre>
<hr />
<h2>4. ë²¡í„° ê²€ìƒ‰ í”Œë¡œìš°</h2>
<h3>4.1. RAG ê²€ìƒ‰ í”„ë¡œì„¸ìŠ¤</h3>
<div class="mermaid">
sequenceDiagram
    participant User as ğŸ‘¤ ì‚¬ìš©ì
    participant Frontend as ğŸŒ Frontend
    participant HF as ğŸ¤— HuggingFace
    participant PostgreSQL as ğŸ˜ PostgreSQL
    participant RAG as ğŸ§  RAG Function

    User->>Frontend: 1. "ë¹„ìŠ·í•œ ê²½í—˜ ì°¾ê¸°" í´ë¦­
    Frontend->>Frontend: 2. ì§ˆë¬¸ í…ìŠ¤íŠ¸ ì¶”ì¶œ
    Frontend->>HF: 3. POST /api/embeddings (ì§ˆë¬¸)
    HF->>Frontend: 4. 384ì°¨ì› ë²¡í„° ë°˜í™˜

    Frontend->>PostgreSQL: 5. search_similar_knowledge(ë²¡í„°, ì„ê³„ê°’, ê°œìˆ˜)
    PostgreSQL->>RAG: 6. ì½”ì‚¬ì¸ ìœ ì‚¬ë„ ê³„ì‚° (Vector Search)
    RAG->>RAG: 7. ìœ ì‚¬ë„ ìƒìœ„ 5ê°œ ì„ íƒ
    RAG->>PostgreSQL: 8. ê²°ê³¼ ë°˜í™˜
    PostgreSQL->>Frontend: 9. ìœ ì‚¬í•œ ê²Œì‹œê¸€ Top 5
    Frontend->>User: 10. ì»¤ë®¤ë‹ˆí‹° ê²½í—˜ë‹´ í‘œì‹œ
</div>

<h3>4.2. ë²¡í„° ê²€ìƒ‰ í•¨ìˆ˜ (PostgreSQL)</h3>
<blockquote>
<p><strong>ğŸ’¡ ì´ í•¨ìˆ˜ê°€ í•˜ëŠ” ì¼</strong></p>
<ul>
<li>ì‚¬ìš©ì ì§ˆë¬¸(ë²¡í„°)ê³¼ ë¹„ìŠ·í•œ ê²Œì‹œê¸€ì„ ì°¾ì•„ì¤ë‹ˆë‹¤</li>
<li>ìœ ì‚¬ë„ 0.7 ì´ìƒì¸ ê²ƒë§Œ ì°¾ìŠµë‹ˆë‹¤ (70% ì´ìƒ ìœ ì‚¬)</li>
<li>ê°€ì¥ ë¹„ìŠ·í•œ ìˆœì„œëŒ€ë¡œ 5ê°œë§Œ ë°˜í™˜í•©ë‹ˆë‹¤</li>
</ul>
</blockquote>
<pre><code class="language-sql">-- ìœ ì‚¬í•œ ì§€ì‹ ê²€ìƒ‰ í•¨ìˆ˜
CREATE OR REPLACE FUNCTION search_similar_knowledge(
  query_embedding VECTOR(384),              -- ì§ˆë¬¸ì„ ë²¡í„°ë¡œ ë³€í™˜í•œ ê²ƒ
  similarity_threshold FLOAT DEFAULT 0.7,   -- ìµœì†Œ ìœ ì‚¬ë„ (0.7 = 70%)
  match_count INT DEFAULT 5                 -- ë°˜í™˜í•  ê°œìˆ˜ (Top 5)
)
RETURNS TABLE (
  id UUID,
  content TEXT,
  source TEXT,
  source_url TEXT,
  similarity FLOAT,                         -- ìœ ì‚¬ë„ ì ìˆ˜
  quality_score NUMERIC,
  is_verified BOOLEAN
)
AS $$
BEGIN
  RETURN QUERY
  SELECT
    pkb.id,
    pkb.content,
    pkb.source,
    pkb.source_url,
    1 - (pkb.embedding &lt;=&gt; query_embedding) AS similarity,  -- ì½”ì‚¬ì¸ ìœ ì‚¬ë„ ê³„ì‚°
    pkb.quality_score,
    pkb.is_verified
  FROM pet_knowledge_base pkb
  WHERE 1 - (pkb.embedding &lt;=&gt; query_embedding) &gt; similarity_threshold  -- 0.7 ì´ìƒë§Œ
  ORDER BY pkb.embedding &lt;=&gt; query_embedding  -- ê°€ì¥ ê°€ê¹Œìš´ ìˆœì„œ
  LIMIT match_count;  -- 5ê°œë§Œ
END;
$$ LANGUAGE plpgsql;
</code></pre>
<p><strong>ì‚¬ìš© ì˜ˆì‹œ:</strong></p>
<pre><code class="language-sql">-- &quot;ê°•ì•„ì§€ ê¸°ì¹¨&quot;ì— ëŒ€í•œ ì§ˆë¬¸
SELECT * FROM search_similar_knowledge(
  '[0.5, 0.8, 0.2, ...]'::vector,  -- ì§ˆë¬¸ ë²¡í„°
  0.7,                              -- 70% ì´ìƒ ìœ ì‚¬í•œ ê²ƒë§Œ
  5                                 -- Top 5 ê°œ
);
</code></pre>
<h3>4.3. ì½”ì‚¬ì¸ ìœ ì‚¬ë„ë€?</h3>
<blockquote>
<p><strong>ğŸ’¡ ì½”ì‚¬ì¸ ìœ ì‚¬ë„ë¥¼ ì‰½ê²Œ ì„¤ëª…í•˜ë©´?</strong></p>
<ul>
<li>ë‘ ë²¡í„°(ìˆ«ì ë°°ì—´)ê°€ ì–¼ë§ˆë‚˜ ë¹„ìŠ·í•œì§€ ê³„ì‚°í•˜ëŠ” ë°©ë²•</li>
<li>0.0 ~ 1.0 ì‚¬ì´ ê°’ìœ¼ë¡œ ë‚˜ì˜´</li>
<li>1.0ì— ê°€ê¹Œìš¸ìˆ˜ë¡ "ê±°ì˜ ë˜‘ê°™ì€ ì˜ë¯¸"</li>
<li>0.0ì— ê°€ê¹Œìš¸ìˆ˜ë¡ "ì „í˜€ ê´€ë ¨ ì—†ìŒ"</li>
</ul>
</blockquote>
<pre><code>ë²¡í„° A = [0.5, 0.8, 0.2, ...]  (ì§ˆë¬¸: &quot;ê°•ì•„ì§€ ê¸°ì¹¨&quot;)
ë²¡í„° B = [0.6, 0.7, 0.3, ...]  (ê²Œì‹œê¸€: &quot;ê°œê°€ ê¸°ì¹¨ì„ í•´ìš”&quot;)

ì½”ì‚¬ì¸ ìœ ì‚¬ë„ = (A Â· B) / (|A| Ã— |B|)

ê²°ê³¼: 0.0 ~ 1.0
- 0.9 ì´ìƒ: ê±°ì˜ ê°™ì€ ë‚´ìš© (ë§¤ìš° ìœ ì‚¬)
- 0.7 ~ 0.9: ê´€ë ¨ ìˆëŠ” ë‚´ìš©
- 0.5 ~ 0.7: ì•½ê°„ ê´€ë ¨ ìˆìŒ
- 0.5 ì´í•˜: ê´€ë ¨ ì—†ìŒ
</code></pre>
<p><strong>ì‹¤ì œ ì˜ˆì‹œ:</strong></p>
<pre><code>ì§ˆë¬¸: &quot;ê°•ì•„ì§€ê°€ ê¸°ì¹¨ì„ í•´ìš”&quot;
ê²Œì‹œê¸€1: &quot;ìš°ë¦¬ ê°œë„ ê¸°ì¹¨ì„ ìì£¼ í•´ìš”&quot; â†’ ìœ ì‚¬ë„ 0.92 (ì„ íƒë¨!)
ê²Œì‹œê¸€2: &quot;ë°˜ë ¤ê²¬ ê¸°ê´€ì§€ì—¼ ì¦ìƒ&quot; â†’ ìœ ì‚¬ë„ 0.85 (ì„ íƒë¨!)
ê²Œì‹œê¸€3: &quot;ê³ ì–‘ì´ ì‚¬ë£Œ ì¶”ì²œ&quot; â†’ ìœ ì‚¬ë„ 0.15 (ì œì™¸ë¨)
</code></pre>
<hr />
<h2>5. Multi-LLM í†µí•©</h2>
<h3>5.1. ì§€ì› LLM ëª©ë¡</h3>
<table>
<thead>
<tr>
<th>LLM</th>
<th>ì œê³µì‚¬</th>
<th>ëª¨ë¸ëª…</th>
<th>íŠ¹ì§•</th>
</tr>
</thead>
<tbody>
<tr>
<td><strong>GPT-4</strong></td>
<td>OpenAI</td>
<td>gpt-4-turbo</td>
<td>ë†’ì€ ì •í™•ë„, ê¸´ ì»¨í…ìŠ¤íŠ¸ ì§€ì›</td>
</tr>
<tr>
<td><strong>Gemini</strong></td>
<td>Google</td>
<td>gemini-pro</td>
<td>ë¹ ë¥¸ ì‘ë‹µ, ë¬´ë£Œ API ì œê³µ</td>
</tr>
<tr>
<td><strong>Claude</strong></td>
<td>Anthropic</td>
<td>claude-3-sonnet</td>
<td>ì•ˆì „ì„± ë†’ìŒ, ê¸´ ëŒ€í™” ì§€ì›</td>
</tr>
</tbody>
</table>
<h3>5.2. LLM ì„ íƒ UI</h3>
<div class="mermaid">
graph LR
    User[ğŸ‘¤ ì‚¬ìš©ì] --> Select[LLM ì„ íƒ ë“œë¡­ë‹¤ìš´]
    Select --> GPT[OpenAI GPT-4]
    Select --> Gemini[Google Gemini]
    Select --> Claude[Anthropic Claude]

    GPT --> Response[AI ì¡°ì–¸ ìƒì„±]
    Gemini --> Response
    Claude --> Response

    style User fill:#E3F2FD
    style Select fill:#FFF3E0
    style Response fill:#C8E6C9
</div>

<h3>5.3. LLM API í˜¸ì¶œ í”Œë¡œìš°</h3>
<div class="mermaid">
sequenceDiagram
    participant User as ğŸ‘¤ ì‚¬ìš©ì
    participant Frontend as ğŸŒ Frontend
    participant RAG as ğŸ§  RAG System
    participant LLM as ğŸ¤– LLM API

    User->>Frontend: 1. "AI ì¡°ì–¸ ë°›ê¸°" í´ë¦­
    Frontend->>RAG: 2. search_similar_knowledge()
    RAG->>Frontend: 3. ìœ ì‚¬í•œ ê²½í—˜ë‹´ Top 5 ë°˜í™˜

    Frontend->>Frontend: 4. í”„ë¡¬í”„íŠ¸ ìƒì„±<br/>(ì§ˆë¬¸ + ê²€ìƒ‰ ê²°ê³¼)
    Frontend->>LLM: 5. POST /api/chat (í”„ë¡¬í”„íŠ¸ + LLM ì„ íƒ)
    LLM->>LLM: 6. RAG ë°©ì‹ìœ¼ë¡œ ë‹µë³€ ìƒì„±
    LLM->>Frontend: 7. AI ì¡°ì–¸ ë°˜í™˜
    Frontend->>User: 8. AI ì¡°ì–¸ í‘œì‹œ
</div>

<h3>5.4. í”„ë¡¬í”„íŠ¸ êµ¬ì„± ì˜ˆì‹œ</h3>
<pre><code class="language-javascript">// RAG ê¸°ë°˜ í”„ë¡¬í”„íŠ¸ ìƒì„±
const prompt = `
ë‹¹ì‹ ì€ ë°˜ë ¤ë™ë¬¼ ê±´ê°• ì „ë¬¸ê°€ì…ë‹ˆë‹¤.
ì‚¬ìš©ìì˜ ì§ˆë¬¸ì— ëŒ€í•´ ì»¤ë®¤ë‹ˆí‹° ê²½í—˜ë‹´ì„ ì°¸ê³ í•˜ì—¬ ë‹µë³€í•´ì£¼ì„¸ìš”.

ã€ì‚¬ìš©ì ì§ˆë¬¸ã€‘
${userQuestion}

ã€ì»¤ë®¤ë‹ˆí‹° ê²½í—˜ë‹´ (ì°¸ê³ ìš©)ã€‘
${ragResults
  .map(
    (r, i) =&gt; `
${i + 1}. ${r.content}
   ì¶œì²˜: ${r.source_url}
   ì‹ ë¢°ë„: ${r.quality_score}
`
  )
  .join(&quot;\n&quot;)}

ã€ë‹µë³€ ìš”êµ¬ì‚¬í•­ã€‘
1. ìœ„ ê²½í—˜ë‹´ì„ ì°¸ê³ í•˜ì—¬ ë‹µë³€í•´ì£¼ì„¸ìš”.
2. ì¶œì²˜ë¥¼ ëª…ì‹œí•´ì£¼ì„¸ìš”.
3. ìˆ˜ì˜ì‚¬ ë°©ë¬¸ì´ í•„ìš”í•œ ê²½ìš° ê¶Œì¥í•´ì£¼ì„¸ìš”.
4. ì „ë¬¸ ìš©ì–´ëŠ” ì‰½ê²Œ ì„¤ëª…í•´ì£¼ì„¸ìš”.
`;
</code></pre>
<h3>5.5. LLM API í˜¸ì¶œ ì˜ˆì‹œ</h3>
<pre><code class="language-javascript">// OpenAI GPT-4 í˜¸ì¶œ
async function callGPT4(prompt) {
  const response = await fetch(&quot;https://api.openai.com/v1/chat/completions&quot;, {
    method: &quot;POST&quot;,
    headers: {
      Authorization: `Bearer ${process.env.OPENAI_API_KEY}`,
      &quot;Content-Type&quot;: &quot;application/json&quot;,
    },
    body: JSON.stringify({
      model: &quot;gpt-4-turbo&quot;,
      messages: [
        { role: &quot;system&quot;, content: &quot;ë‹¹ì‹ ì€ ë°˜ë ¤ë™ë¬¼ ê±´ê°• ì „ë¬¸ê°€ì…ë‹ˆë‹¤.&quot; },
        { role: &quot;user&quot;, content: prompt },
      ],
      temperature: 0.7,
      max_tokens: 1000,
    }),
  });

  const data = await response.json();
  return data.choices[0].message.content;
}

// Google Gemini í˜¸ì¶œ
async function callGemini(prompt) {
  const response = await fetch(
    `https://generativelanguage.googleapis.com/v1/models/gemini-pro:generateContent?key=${process.env.GEMINI_API_KEY}`,
    {
      method: &quot;POST&quot;,
      headers: { &quot;Content-Type&quot;: &quot;application/json&quot; },
      body: JSON.stringify({
        contents: [{ parts: [{ text: prompt }] }],
      }),
    }
  );

  const data = await response.json();
  return data.candidates[0].content.parts[0].text;
}

// Anthropic Claude í˜¸ì¶œ
async function callClaude(prompt) {
  const response = await fetch(&quot;https://api.anthropic.com/v1/messages&quot;, {
    method: &quot;POST&quot;,
    headers: {
      &quot;x-api-key&quot;: process.env.ANTHROPIC_API_KEY,
      &quot;anthropic-version&quot;: &quot;2023-06-01&quot;,
      &quot;Content-Type&quot;: &quot;application/json&quot;,
    },
    body: JSON.stringify({
      model: &quot;claude-3-sonnet-20240229&quot;,
      messages: [{ role: &quot;user&quot;, content: prompt }],
      max_tokens: 1000,
    }),
  });

  const data = await response.json();
  return data.content[0].text;
}
</code></pre>
<hr />
<h2>6. RAG-LLM AI ì±—ë´‡ ì‹œìŠ¤í…œ ì•„í‚¤í…ì²˜</h2>
<h3>6.1. RAG-LLM í†µí•© ì‹œìŠ¤í…œ êµ¬ì¡°</h3>
<div class="mermaid">
graph TB
    User[ğŸ‘¤ ì‚¬ìš©ì] --> Frontend[ğŸŒ Next.js Frontend]
    Frontend --> Supabase[â˜ï¸ Supabase BaaS]
    Frontend --> LLM[ğŸ¤– LLM APIs]

    Supabase --> PostgreSQL[(ğŸ˜ PostgreSQL<br/>+ pgvector)]
    PostgreSQL --> RAG[ğŸ§  RAG System<br/>pet_knowledge_base]

    RAG --> HuggingFace[ğŸ¤— HuggingFace<br/>Embedding API<br/>384ì°¨ì›]

    LLM --> GPT[OpenAI GPT-4<br/>gpt-4-turbo]
    LLM --> Gemini[Google Gemini<br/>gemini-pro]
    LLM --> Claude[Anthropic Claude<br/>claude-3-sonnet]

    style User fill:#E3F2FD
    style Frontend fill:#F3E5F5
    style Supabase fill:#E0F2F1
    style PostgreSQL fill:#FFF3E0
    style RAG fill:#E8EAF6
    style LLM fill:#FCE4EC
    style HuggingFace fill:#FFF9C4
</div>

<h3>6.2. AI Assistant í˜ì´ì§€ êµ¬ì¡°</h3>
<pre><code>ğŸ“ frontend/src/app/main/aiassistant/
â”œâ”€â”€ page.tsx                        # ë©”ì¸ í˜ì´ì§€
â”œâ”€â”€ aiassistant.module.css
â”œâ”€â”€ hooks/
â”‚   â”œâ”€â”€ useYoloDetection.js         # YOLO ë¶„ì„
â”‚   â”œâ”€â”€ useImageUpload.js           # ì´ë¯¸ì§€ ì—…ë¡œë“œ
â”‚   â”œâ”€â”€ useAIChat.js                # AI ì±—ë´‡ (Multi-LLM)
â”‚   â””â”€â”€ useRAGSearch.js             # RAG ê²€ìƒ‰ â­
â””â”€â”€ _components/
    â”œâ”€â”€ LeftPanel/                  # ì´ë¯¸ì§€ ì—…ë¡œë“œ + YOLO ê²°ê³¼
    â”œâ”€â”€ RightPanel/                 # AI ì±—ë´‡ + RAG ê²€ìƒ‰ â­
    â”œâ”€â”€ PetHospital/                # ë³‘ì› ì°¾ê¸°
    â””â”€â”€ HashtagSuggestions/         # í•´ì‹œíƒœê·¸ ìë™ì™„ì„±
</code></pre>
<h3>6.3. ë°ì´í„° íë¦„ (í†µí•©)</h3>
<div class="mermaid">
sequenceDiagram
    participant User as ğŸ‘¤ ì‚¬ìš©ì
    participant Frontend as ğŸŒ Frontend
    participant FastAPI as ğŸ FastAPI (YOLO)
    participant PostgreSQL as ğŸ˜ PostgreSQL (RAG)
    participant LLM as ğŸ¤– LLM API

    Note over User,LLM: 1ï¸âƒ£ YOLO ì´ë¯¸ì§€ ë¶„ì„
    User->>Frontend: ì´ë¯¸ì§€ ì—…ë¡œë“œ
    Frontend->>FastAPI: POST /api/detect
    FastAPI->>Frontend: íƒì§€ ê²°ê³¼ (ì§ˆí™˜ëª… + ì‹ ë¢°ë„)

    Note over User,LLM: 2ï¸âƒ£ RAG ê²€ìƒ‰
    User->>Frontend: "ë¹„ìŠ·í•œ ê²½í—˜ ì°¾ê¸°" í´ë¦­
    Frontend->>PostgreSQL: search_similar_knowledge()
    PostgreSQL->>Frontend: ìœ ì‚¬í•œ ê²Œì‹œê¸€ Top 5

    Note over User,LLM: 3ï¸âƒ£ LLM ì¡°ì–¸ ìƒì„±
    User->>Frontend: "AI ì¡°ì–¸ ë°›ê¸°" í´ë¦­
    Frontend->>LLM: RAG ê²°ê³¼ + YOLO ê²°ê³¼ + ì§ˆë¬¸
    LLM->>Frontend: ì‹ ë¢°ë„ ë†’ì€ ë‹µë³€
    Frontend->>User: ìµœì¢… ê²°ê³¼ í‘œì‹œ
</div>

<hr />
<h2>7. ì„±ëŠ¥ ë¶„ì„</h2>
<h3>7.1. RAG ì‹œìŠ¤í…œ ì„±ëŠ¥</h3>
<table>
<thead>
<tr>
<th>ì§€í‘œ</th>
<th>ìˆ˜ì¹˜</th>
<th>ë¹„ê³ </th>
</tr>
</thead>
<tbody>
<tr>
<td><strong>í‰ê·  ê²€ìƒ‰ ì‹œê°„</strong></td>
<td>0.5ì´ˆ ì´ë‚´</td>
<td>pgvector ì¸ë±ìŠ¤ ì‚¬ìš© (ëª©ì°¨ê°€ ìˆì–´ì„œ ë¹ ë¦„)</td>
</tr>
<tr>
<td><strong>ì„ë² ë”© ì°¨ì›</strong></td>
<td>384ì°¨ì›</td>
<td>HuggingFace sentence-transformers (384ê°œ ìˆ«ì)</td>
</tr>
<tr>
<td><strong>ê²€ìƒ‰ ê²°ê³¼ ê°œìˆ˜</strong></td>
<td>Top 5</td>
<td>ìœ ì‚¬ë„ ìƒìœ„ 5ê°œë§Œ ë°˜í™˜</td>
</tr>
<tr>
<td><strong>ìœ ì‚¬ë„ ì„ê³„ê°’</strong></td>
<td>0.7 ì´ìƒ</td>
<td>0.0~1.0 ë²”ìœ„ (0.7 = 70% ì´ìƒ ìœ ì‚¬í•´ì•¼ í•¨)</td>
</tr>
</tbody>
</table>
<blockquote>
<p><strong>ğŸ’¡ ì„±ëŠ¥ ì´í•´í•˜ê¸°</strong></p>
<ul>
<li><strong>0.5ì´ˆ</strong>: ê²Œì‹œê¸€ì´ ë§ì•„ë„ ë¹ ë¥´ê²Œ ì°¾ìŒ (ì¸ë±ìŠ¤ ë•ë¶„)</li>
<li><strong>384ì°¨ì›</strong>: ì ë‹¹í•œ í¬ê¸° (ë„ˆë¬´ í¬ë©´ ëŠë¦¬ê³ , ë„ˆë¬´ ì‘ìœ¼ë©´ ì •í™•ë„ ë‚®ìŒ)</li>
<li><strong>Top 5</strong>: ë„ˆë¬´ ë§ìœ¼ë©´ ê´€ë ¨ ì—†ëŠ” ê²ƒë„ ë‚˜ì˜´, 5ê°œê°€ ì ë‹¹</li>
<li><strong>0.7 ì„ê³„ê°’</strong>: 70% ì´ìƒ ë¹„ìŠ·í•œ ê²ƒë§Œ ë³´ì—¬ì¤Œ (ë„ˆë¬´ ê´€ë ¨ ì—†ëŠ” ê±´ ì œì™¸)</li>
</ul>
</blockquote>
<h3>7.2. LLM ì‘ë‹µ ì„±ëŠ¥</h3>
<table>
<thead>
<tr>
<th>LLM</th>
<th>í‰ê·  ì‘ë‹µ ì‹œê°„</th>
<th>Token ì œí•œ</th>
<th>ë¹„ìš© (ì˜ˆìƒ)</th>
</tr>
</thead>
<tbody>
<tr>
<td><strong>GPT-4</strong></td>
<td>3~5ì´ˆ</td>
<td>8,192 tokens</td>
<td>ë†’ìŒ (ìœ ë£Œ)</td>
</tr>
<tr>
<td><strong>Gemini</strong></td>
<td>1~2ì´ˆ</td>
<td>32,000 tokens</td>
<td>ë¬´ë£Œ (í•˜ë£¨ 60íšŒ ì œí•œ)</td>
</tr>
<tr>
<td><strong>Claude</strong></td>
<td>2~4ì´ˆ</td>
<td>100,000 tokens</td>
<td>ì¤‘ê°„ (ìœ ë£Œ)</td>
</tr>
</tbody>
</table>
<blockquote>
<p><strong>ğŸ’¡ Tokenì´ ë­”ê°€ìš”?</strong></p>
<ul>
<li>Token: ë‹¨ì–´ì˜ ì‘ì€ ì¡°ê° (ëŒ€ëµ 1 token = í•œê¸€ 1~2ê¸€ì)</li>
<li>8,192 tokens = ì•½ 5,000~6,000 í•œê¸€ ê¸€ì</li>
<li>Token ì œí•œ: í•œ ë²ˆì— ì£¼ê³ ë°›ì„ ìˆ˜ ìˆëŠ” ìµœëŒ€ ê¸€ì ìˆ˜</li>
<li>ì œí•œ ë„˜ìœ¼ë©´ ì˜ë¦¬ê±°ë‚˜ ì˜¤ë¥˜ ë°œìƒ</li>
</ul>
</blockquote>
<p><strong>ì„ íƒ ê¸°ì¤€:</strong></p>
<ul>
<li><strong>ë¹ ë¥´ê²Œ ë‹µë³€ í•„ìš”</strong>: Gemini (1~2ì´ˆ, ë¬´ë£Œ)</li>
<li><strong>ì •í™•ë„ ì¤‘ìš”</strong>: GPT-4 (3~5ì´ˆ, ìœ ë£Œì§€ë§Œ ê°€ì¥ ì •í™•)</li>
<li><strong>ê¸´ ëŒ€í™”</strong>: Claude (100,000 tokensë¡œ ê°€ì¥ ê¸´ ëŒ€í™” ê°€ëŠ¥)</li>
</ul>
<h3>7.3. ì‹œìŠ¤í…œ ì¥ì </h3>
<p><strong>1. RAG ì‹œìŠ¤í…œ</strong></p>
<ul>
<li>âœ… ìµœì‹  ì»¤ë®¤ë‹ˆí‹° ê²½í—˜ë‹´ í™œìš©</li>
<li>âœ… í™˜ê° í˜„ìƒ ê°ì†Œ (ì¶œì²˜ ëª…í™•)</li>
<li>âœ… ë¹ ë¥¸ ê²€ìƒ‰ ì†ë„ (0.5ì´ˆ ì´ë‚´)</li>
<li>âœ… ìë™ ì„ë² ë”© ìƒì„± (íŠ¸ë¦¬ê±° ê¸°ë°˜)</li>
</ul>
<p><strong>2. Multi-LLM í†µí•©</strong></p>
<ul>
<li>âœ… ì‚¬ìš©ì ì„ íƒê¶Œ ì œê³µ</li>
<li>âœ… ì¥ì•  ëŒ€ì‘ (Fallback LLM)</li>
<li>âœ… ë¹„ìš© ìµœì í™” (Gemini ë¬´ë£Œ ì‚¬ìš©)</li>
</ul>
<p><strong>3. í†µí•© ì‹œìŠ¤í…œ</strong></p>
<ul>
<li>âœ… YOLO + RAG + LLM í†µí•©</li>
<li>âœ… ë†’ì€ ì‹ ë¢°ë„ (ì¶œì²˜ + AI ë¶„ì„)</li>
<li>âœ… ì‚¬ìš©ì ì¹œí™”ì  UI</li>
</ul>
<h3>7.4. ê°œì„ ì´ í•„ìš”í•œ ë¶€ë¶„</h3>
<p><strong>1. ì„ë² ë”© ìƒì„±</strong></p>
<ul>
<li>ê²Œì‹œê¸€ ì‘ì„± ì‹œ ì„ë² ë”© ìƒì„± ì§€ì—° ê°€ëŠ¥ (HuggingFace API í˜¸ì¶œ)</li>
<li>ëŒ€ëŸ‰ ê²Œì‹œê¸€ ì‘ì„± ì‹œ ë¶€í•˜ ì¦ê°€</li>
</ul>
<p><strong>2. ê²€ìƒ‰ í’ˆì§ˆ</strong></p>
<ul>
<li>ì§ˆë¬¸ê³¼ ê²Œì‹œê¸€ì˜ ë¬¸ë§¥ì´ ë‹¤ë¥¼ ê²½ìš° ì •í™•ë„ í•˜ë½</li>
<li>ìœ ì‚¬ë„ ì„ê³„ê°’ ì¡°ì • í•„ìš” (í˜„ì¬ 0.7)</li>
</ul>
<p><strong>3. LLM ë¹„ìš©</strong></p>
<ul>
<li>GPT-4 ì‚¬ìš© ì‹œ ë†’ì€ ë¹„ìš©</li>
<li>Gemini ë¬´ë£Œ í‹°ì–´ ì œí•œ (ì¼ì¼ 60íšŒ)</li>
</ul>
<h3>7.5. ê°œì„  ë°©ì•ˆ</h3>
<p><strong>1. ì„ë² ë”© ìƒì„± ìµœì í™”</strong></p>
<ul>
<li>ë°°ì¹˜ ì²˜ë¦¬ (ì—¬ëŸ¬ ê²Œì‹œê¸€ ë™ì‹œ ì„ë² ë”©)</li>
<li>ìºì‹± ì „ëµ (ì¤‘ë³µ ì„ë² ë”© ë°©ì§€)</li>
</ul>
<p><strong>2. ê²€ìƒ‰ í’ˆì§ˆ í–¥ìƒ</strong></p>
<ul>
<li>í•œêµ­ì–´ íŠ¹í™” ì„ë² ë”© ëª¨ë¸ ì‚¬ìš©</li>
<li>ìœ ì‚¬ë„ ì„ê³„ê°’ ë™ì  ì¡°ì •</li>
</ul>
<p><strong>3. LLM ë¹„ìš© ìµœì í™”</strong></p>
<ul>
<li>Gemini ìš°ì„  ì‚¬ìš© (ë¬´ë£Œ)</li>
<li>GPT-4ëŠ” ì¤‘ìš”í•œ ì§ˆë¬¸ì—ë§Œ ì‚¬ìš©</li>
<li>Claudeë¥¼ Fallbackìœ¼ë¡œ ì„¤ì •</li>
</ul>
<hr />
<h2>ğŸ”— ì°¸ê³  ìë£Œ</h2>
<h3>ê¸°ìˆ  ë¬¸ì„œ</h3>
<ol>
<li><strong>pgvector ê³µì‹ ë¬¸ì„œ</strong>: https://github.com/pgvector/pgvector</li>
<li><strong>HuggingFace Embeddings</strong>: https://huggingface.co/models?pipeline_tag=sentence-similarity</li>
<li><strong>OpenAI GPT-4</strong>: https://platform.openai.com/docs</li>
<li><strong>Google Gemini</strong>: https://ai.google.dev/docs</li>
<li><strong>Anthropic Claude</strong>: https://docs.anthropic.com/</li>
</ol>
<h3>RAG ê´€ë ¨ ë…¼ë¬¸</h3>
<ol>
<li><strong>RAG ë…¼ë¬¸</strong>: Lewis, P. et al. (2020). "Retrieval-Augmented Generation for Knowledge-Intensive NLP Tasks"</li>
<li><strong>Sentence Transformers</strong>: Reimers, N. &amp; Gurevych, I. (2019). "Sentence-BERT: Sentence Embeddings using Siamese BERT-Networks"</li>
</ol>
<hr />
<h2>âš–ï¸ ë²•ì  ê³ ì§€ì‚¬í•­</h2>
<p>âš ï¸ <strong>ì¤‘ìš” ì•ˆë‚´</strong></p>
<ol>
<li>
<p><strong>AI ì¡°ì–¸ì˜ í•œê³„</strong></p>
</li>
<li>
<p>RAG ì‹œìŠ¤í…œê³¼ LLMì˜ ë‹µë³€ì€ <strong>ì°¸ê³ ìš©</strong>ì…ë‹ˆë‹¤.</p>
</li>
<li>
<p>ì‹¤ì œ ì§„ë‹¨ ë° ì¹˜ë£ŒëŠ” ë°˜ë“œì‹œ ìê²©ì„ ê°–ì¶˜ ìˆ˜ì˜ì‚¬ì™€ ìƒë‹´í•˜ì„¸ìš”.</p>
</li>
<li>
<p><strong>ì¶œì²˜ ì‹ ë¢°ë„</strong></p>
</li>
<li>
<p>ì»¤ë®¤ë‹ˆí‹° ê²½í—˜ë‹´ì€ ì¼ë°˜ ì‚¬ìš©ì ì‘ì„± ë‚´ìš©ì…ë‹ˆë‹¤.</p>
</li>
<li>
<p><code>is_verified = true</code> í‘œì‹œê°€ ìˆëŠ” ê²½ìš°ì—ë§Œ ìˆ˜ì˜ì‚¬ ê²€ì¦ ì™„ë£Œì…ë‹ˆë‹¤.</p>
</li>
<li>
<p><strong>ê°œì¸ì •ë³´ ë³´í˜¸</strong></p>
</li>
<li>RAG ê²€ìƒ‰ ì‹œ ê°œì¸ ì‹ë³„ ì •ë³´ëŠ” ì œê³µë˜ì§€ ì•ŠìŠµë‹ˆë‹¤.</li>
<li>ê²Œì‹œê¸€ ì‘ì„±ìì˜ ë™ì˜ ì—†ì´ ì™¸ë¶€ ê³µìœ  ê¸ˆì§€</li>
</ol>
<hr />
<h2>ğŸ† RAG-LLM ì‹œìŠ¤í…œ ìš”ì•½</h2>
<p><strong>RAG + Multi-LLM í†µí•© ì™„ë£Œ</strong></p>
<p>âœ… <strong>pgvector ê¸°ë°˜ RAG ì‹œìŠ¤í…œ</strong></p>
<ul>
<li>384ì°¨ì› HuggingFace ì„ë² ë”©</li>
<li>í‰ê·  0.5ì´ˆ ì´ë‚´ ê²€ìƒ‰</li>
<li>ìë™ ì„ë² ë”© ìƒì„± (íŠ¸ë¦¬ê±° ê¸°ë°˜)</li>
</ul>
<p>âœ… <strong>Multi-LLM ì§€ì›</strong></p>
<ul>
<li>OpenAI GPT-4</li>
<li>Google Gemini (ë¬´ë£Œ)</li>
<li>Anthropic Claude</li>
<li>ì‚¬ìš©ì ì„ íƒ ê°€ëŠ¥</li>
</ul>
<p>âœ… <strong>YOLO í†µí•©</strong></p>
<ul>
<li>YOLO ë¶„ì„ ê²°ê³¼ + RAG ê²€ìƒ‰ + LLM ì¡°ì–¸</li>
<li>ë†’ì€ ì‹ ë¢°ë„ (ì¶œì²˜ ëª…ì‹œ)</li>
</ul>
<hr />
<p><strong>ğŸ“ ë¬¸ì„œ ì •ë³´</strong></p>
<ul>
<li><strong>ì‘ì„±ì¼</strong>: 2025-11-14</li>
<li><strong>ì‘ì„±ì</strong>: LYSS with Claude</li>
<li><strong>ë²„ì „</strong>: v2.0 (4ì°¨ ìŠ¤í”„ë¦°íŠ¸ ìµœì¢…)</li>
<li><strong>ê´€ë ¨ ë¬¸ì„œ</strong>: <a href="./09_YOLO_ëª¨ë¸_ì •ì˜ì„œ.md">09_YOLO_ëª¨ë¸_ì •ì˜ì„œ.md</a></li>
</ul>

    <script>
        // Mermaid ë Œë”ë§ ì™„ë£Œ í›„ í˜ì´ì§€ ë¡œë“œ ì´ë²¤íŠ¸
        window.addEventListener('load', function() {
            console.log('Mermaid diagrams loaded successfully!');
        });
    </script>
</body>
</html>
