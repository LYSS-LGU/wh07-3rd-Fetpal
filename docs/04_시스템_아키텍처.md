# Fetpal ì‹œìŠ¤í…œ ì•„í‚¤í…ì²˜ v3

> **4ì°¨ ìŠ¤í”„ë¦°íŠ¸ ë°œí‘œ** (2025.11.14)
> **ìµœì¢… ë°œí‘œ**: 2025-11-21
> **ì‘ì„±ì**: LYSS with Claude

---

## ğŸ“‹ ë¬¸ì„œ ê°œìš”

ì´ ë¬¸ì„œëŠ” Fetpal í”„ë¡œì íŠ¸ì˜ ì „ì²´ ì‹œìŠ¤í…œ ì•„í‚¤í…ì²˜, ê¸°ìˆ  ìŠ¤íƒ, Hook Composition íŒ¨í„´, Co-location êµ¬ì¡°ë¥¼ ìƒì„¸íˆ ì„¤ëª…í•©ë‹ˆë‹¤.

---

## ğŸ—ï¸ 1. ì „ì²´ ì‹œìŠ¤í…œ ì•„í‚¤í…ì²˜

### 1.1. ë ˆì´ì–´ ê¸°ë°˜ ì‹œìŠ¤í…œ êµ¬ì¡°

![ë ˆì´ì–´ ê¸°ë°˜ ì‹œìŠ¤í…œ êµ¬ì¡°](./ì‹œìŠ¤í…œì•„í‚¤í…ì³_ë ˆì´ì–´ì…€í”„.png)

### 1.2. ë°ì´í„° í”Œë¡œìš° (Detailed Flow)

#### 1.2.1. ì¼ë°˜ ë°ì´í„° ì¡°íšŒ í”Œë¡œìš°

```mermaid
%%{init: {'theme':'base', 'themeVariables': { 'fontSize':'22px', 'fontFamily':'arial'}}}%%
sequenceDiagram
    actor User as ğŸ‘¤ ì‚¬ìš©ì
    participant FE as ğŸŒ Frontend<br/>(Next.js)
    participant Hook as ğŸª Custom Hook
    participant Supa as â˜ï¸ Supabase
    participant DB as ğŸ˜ PostgreSQL

    rect rgb(200, 230, 255)
        Note over User,DB: ğŸ“± ì¼ë°˜ ë°ì´í„° ì¡°íšŒ í”Œë¡œìš°
        User->>FE: 1. í˜ì´ì§€ ì ‘ì†
        FE->>Hook: 2. useAuth(), usePlanner() í˜¸ì¶œ
        Hook->>Supa: 3. API ìš”ì²­ (fetch)
        Supa->>DB: 4. SQL ì¿¼ë¦¬ (RLS ì ìš©)
        DB-->>Supa: 5. ë°ì´í„° ë°˜í™˜
        Supa-->>Hook: 6. JSON ì‘ë‹µ
        Hook-->>FE: 7. ìƒíƒœ ì—…ë°ì´íŠ¸
        FE-->>User: 8. UI ë Œë”ë§
    end
```

#### 1.2.2. ì‹¤ì‹œê°„ ì±„íŒ… í”Œë¡œìš°

```mermaid
%%{init: {'theme':'base', 'themeVariables': { 'fontSize':'22px', 'fontFamily':'arial'}}}%%
sequenceDiagram
    actor User as ğŸ‘¤ ì‚¬ìš©ì
    participant FE as ğŸŒ Frontend<br/>(Next.js)
    participant Hook as ğŸª Custom Hook
    participant Supa as â˜ï¸ Supabase
    participant DB as ğŸ˜ PostgreSQL
    participant RT as âš¡ Realtime

    rect rgb(255, 230, 200)
        Note over User,RT: âš¡ ì‹¤ì‹œê°„ ì—…ë°ì´íŠ¸ (Realtime)
        User->>FE: 1. ë°ì´í„° ì‘ì„± (ê²Œì‹œê¸€, ëŒ“ê¸€ ë“±)
        FE->>Hook: 2. useOptimisticUpdate()
        Hook->>Supa: 3. INSERT/UPDATE
        Supa->>DB: 4. íŠ¸ëœì­ì…˜ ì‹¤í–‰
        DB->>DB: 5. Trigger ë°œë™
        DB->>RT: 6. Broadcast Event
        RT-->>FE: 7. ì‹¤ì‹œê°„ Push (WebSocket)
        FE-->>User: 8. UI ì¦‰ì‹œ ì—…ë°ì´íŠ¸
    end
```

#### 1.2.3. YOLO + RAG ì§„ë‹¨ í”Œë¡œìš°

```mermaid
%%{init: {'theme':'base', 'themeVariables': { 'fontSize':'22px', 'fontFamily':'arial'}}}%%
sequenceDiagram
    actor User as ğŸ‘¤ ì‚¬ìš©ì
    participant FE as ğŸŒ Frontend<br/>(Next.js)
    participant Hook as ğŸª Custom Hook
    participant AI as ğŸ¤– FastAPI
    participant YOLO as ğŸ”¬ YOLO Model
    participant RAG as ğŸ§  RAG System
    participant DB as ğŸ˜ PostgreSQL
    participant LLM as ğŸ’¬ Multi-LLM

    rect rgb(255, 200, 220)
        Note over User,AI: ğŸ¤– AI ê±´ê°• ì§„ë‹¨ í”Œë¡œìš°
        User->>FE: 1. ì´ë¯¸ì§€ ì—…ë¡œë“œ
        FE->>Hook: 2. useYoloUpload()
        Hook->>AI: 3. HTTP POST (/api/detect)
        AI->>AI: 4. ì´ë¯¸ì§€ ì „ì²˜ë¦¬
        AI->>YOLO: 5. YOLO ì¶”ë¡ 
        YOLO-->>AI: 6. ë¶„ì„ ê²°ê³¼ (JSON)
        AI-->>Hook: 7. íƒì§€ ê²°ê³¼ ë°˜í™˜
        Hook-->>FE: 8. ê²°ê³¼ ì‹œê°í™”
        FE-->>User: 9. ë°”ìš´ë”© ë°•ìŠ¤ + ì‹ ë¢°ë„ í‘œì‹œ
    end

    rect rgb(230, 200, 255)
        Note over User,LLM: ğŸ§  RAG ê¸°ë°˜ AI ì¡°ì–¸
        User->>FE: 10. AI ì¡°ì–¸ ë°›ê¸°
        FE->>RAG: 11. ë²¡í„° ê²€ìƒ‰ ìš”ì²­
        RAG->>DB: 12. pgvector ìœ ì‚¬ë„ ê²€ìƒ‰
        DB-->>RAG: 13. ê´€ë ¨ ì§€ì‹ ë°˜í™˜
        RAG->>LLM: 14. ì»¨í…ìŠ¤íŠ¸ + í”„ë¡¬í”„íŠ¸
        LLM-->>RAG: 15. ë‹µë³€ ìƒì„±
        RAG-->>FE: 16. AI ì¡°ì–¸
        FE-->>User: 17. ëŒ€ì²˜ ë°©ì•ˆ í‘œì‹œ
    end
```

---

## ğŸ”§ 2. ê¸°ìˆ  ìŠ¤íƒ (Tech Stack)

### 2.1. Frontend Stack

| **Category**    | **Technology** | **Version** | **Purpose**                             |
| :-------------- | :------------- | :---------: | :-------------------------------------- |
| **Framework**   | Next.js        |   14.2.x    | App Router ê¸°ë°˜ í’€ìŠ¤íƒ React í”„ë ˆì„ì›Œí¬ |
| **Language**    | TypeScript     |     5.x     | íƒ€ì… ì•ˆì „ì„± í™•ë³´                        |
| **Language**    | JavaScript     |    ES6+     | ë™ì  ë¡œì§ ë° ë¹ ë¥¸ í”„ë¡œí† íƒ€ì´í•‘          |
| **Styling**     | CSS Modules    |      -      | Co-location ê¸°ë°˜ ìŠ¤íƒ€ì¼ ê´€ë¦¬            |
| **Styling**     | Tailwind CSS   |     3.x     | ìœ í‹¸ë¦¬í‹° ìš°ì„  CSS í”„ë ˆì„ì›Œí¬            |
| **State**       | React Hooks    |      -      | Hook Composition íŒ¨í„´                   |
| **HTTP Client** | fetch API      |      -      | ë„¤ì´í‹°ë¸Œ ë¸Œë¼ìš°ì € API                   |

### 2.2. Backend Stack (BaaS)

| **Category**  | **Technology**    | **Version** | **Purpose**                            |
| :------------ | :---------------- | :---------: | :------------------------------------- |
| **BaaS**      | Supabase          |     2.x     | PostgreSQL + Auth + Storage + Realtime |
| **Database**  | PostgreSQL        |    15.x     | ê´€ê³„í˜• ë°ì´í„°ë² ì´ìŠ¤                    |
| **Auth**      | Supabase Auth     |      -      | JWT ê¸°ë°˜ ì¸ì¦ ì‹œìŠ¤í…œ                   |
| **Storage**   | Supabase Storage  |      -      | ì´ë¯¸ì§€/íŒŒì¼ ìŠ¤í† ë¦¬ì§€ (S3 í˜¸í™˜)         |
| **Realtime**  | Supabase Realtime |      -      | WebSocket ê¸°ë°˜ ì‹¤ì‹œê°„ êµ¬ë…             |
| **Vector DB** | pgvector          |    0.5.x    | ë²¡í„° ê²€ìƒ‰ (RAG ì‹œìŠ¤í…œ)                 |

### 2.3. AI Server Stack

| **Category**   | **Technology** | **Version** | **Purpose**                  |
| :------------- | :------------- | :---------: | :--------------------------- |
| **Framework**  | FastAPI        |   0.104.x   | ê³ ì„±ëŠ¥ Python API í”„ë ˆì„ì›Œí¬ |
| **Language**   | Python         |   3.10.x    | AI/ML ê°œë°œ ì–¸ì–´              |
| **AI Model**   | YOLOv8         |    8.0.x    | ê°ì²´ íƒì§€ (Ultralytics)      |
| **CV Library** | OpenCV         |    4.8.x    | ì´ë¯¸ì§€ ì²˜ë¦¬                  |
| **GPU**        | CUDA           |    12.1     | NVIDIA GPU ê°€ì† (RTX 4060)   |
| **Embedding**  | HuggingFace    |     4.x     | sentence-transformers        |

### 2.4. External APIs

| **Service**          | **Purpose**             | **ì‚¬ìš© ìœ„ì¹˜**          |
| :------------------- | :---------------------- | :--------------------- |
| **Kakao Map API**    | ì£¼ë³€ ë™ë¬¼ë³‘ì›/ì•½êµ­ ê²€ìƒ‰ | AI Assistant, Hospital |
| **OpenAI GPT-4**     | AI ì±—ë´‡ (ë©€í‹° LLM ì§€ì›) | AI Assistant           |
| **Google Gemini**    | AI ì±—ë´‡ (ë©€í‹° LLM ì§€ì›) | AI Assistant           |
| **Anthropic Claude** | AI ì±—ë´‡ (ë©€í‹° LLM ì§€ì›) | AI Assistant           |

---

## ğŸ›ï¸ 3. Hook Composition ì•„í‚¤í…ì²˜ â­â­â­

### 3.1. Hook Composition ê°œë…

```mermaid
graph LR
    A[í° ê¸°ëŠ¥] --> B[ë§ˆìŠ¤í„° í›…]
    B --> C[ì „ë¬¸ í›… 1]
    B --> D[ì „ë¬¸ í›… 2]
    B --> E[ì „ë¬¸ í›… 3]

    C --> F[API í†µì‹ ]
    D --> G[ìƒíƒœ ê´€ë¦¬]
    E --> H[ìœ íš¨ì„± ê²€ì‚¬]

    style A fill:#E3F2FD
    style B fill:#F3E5F5
    style C fill:#FFF3E0
    style D fill:#FFF3E0
    style E fill:#FFF3E0
    style F fill:#E8F5E9
    style G fill:#E8F5E9
    style H fill:#E8F5E9
```

**ì „í†µì  ë°©ì‹ (âŒ ë‚˜ìœ ì˜ˆ)**:

```
ğŸ“ Planner/
â”œâ”€â”€ page.tsx (700ì¤„)  âŒ í•˜ë‚˜ì˜ ê±°ëŒ€í•œ ì»´í¬ë„ŒíŠ¸
â””â”€â”€ planner.css
```

**Hook Composition ë°©ì‹ (âœ… ì¢‹ì€ ì˜ˆ)**:

```
ğŸ“ Planner/
â”œâ”€â”€ page.tsx (165ì¤„)  âœ… ë§ˆìŠ¤í„° ì»´í¬ë„ŒíŠ¸ (ì‘ê³  ëª…í™•)
â”œâ”€â”€ hooks/
â”‚   â”œâ”€â”€ usePlanner.js  âœ… í”Œë˜ë„ˆ ì „ë¬¸ í›…
â”‚   â”œâ”€â”€ useCalendar.js  âœ… ë‹¬ë ¥ ì „ë¬¸ í›…
â”‚   â”œâ”€â”€ useEvents.js  âœ… ì´ë²¤íŠ¸ ì „ë¬¸ í›…
â”‚   â””â”€â”€ useExpenses.js  âœ… ì§€ì¶œ ì „ë¬¸ í›…
â””â”€â”€ _components/
    â”œâ”€â”€ Calendar/
    â”œâ”€â”€ EventListSection/
    â””â”€â”€ Wallet/
```

### 3.2. Hook ì „ë¬¸í™” í´ë” êµ¬ì¡° (ìµœì¢… ì™„ì„±)

```
ğŸ“¦ frontend/src/hooks/
â”œâ”€â”€ ğŸ“‚ auth/                      # ì¸ì¦ ê´€ë ¨ ì „ë¬¸ í›…ë“¤
â”‚   â”œâ”€â”€ useAuth.js                # ë¡œê·¸ì¸/ë¡œê·¸ì•„ì›ƒ ì „ë¬¸ê°€
â”‚   â”œâ”€â”€ useSignup.js              # íšŒì›ê°€ì… ì „ë¬¸ê°€
â”‚   â””â”€â”€ usePasswordReset.js       # ë¹„ë°€ë²ˆí˜¸ ì¬ì„¤ì • ì „ë¬¸ê°€
â”‚
â”œâ”€â”€ ğŸ“‚ aiassistant/               # AI ì–´ì‹œìŠ¤í„´íŠ¸ ì „ë¬¸ í›…ë“¤
â”‚   â”œâ”€â”€ useYoloDetection.js       # YOLO ë¶„ì„ ì „ë¬¸ê°€
â”‚   â”œâ”€â”€ useImageUpload.js         # ì´ë¯¸ì§€ ì—…ë¡œë“œ ì „ë¬¸ê°€
â”‚   â”œâ”€â”€ useAIChat.js              # AI ì±—ë´‡ ì „ë¬¸ê°€
â”‚   â””â”€â”€ useRAGSearch.js           # RAG ê²€ìƒ‰ ì „ë¬¸ê°€ â­
â”‚
â”œâ”€â”€ ğŸ“‚ planner/                   # í”Œë˜ë„ˆ ì „ë¬¸ í›…ë“¤
â”‚   â”œâ”€â”€ usePlanner.js             # ë§ˆìŠ¤í„° í”Œë˜ë„ˆ í›…
â”‚   â”œâ”€â”€ useCalendar.js            # ë‹¬ë ¥ ì „ë¬¸ê°€
â”‚   â”œâ”€â”€ useEvents.js              # ì´ë²¤íŠ¸ CRUD ì „ë¬¸ê°€
â”‚   â”œâ”€â”€ useExpenses.js            # ì§€ì¶œ CRUD ì „ë¬¸ê°€
â”‚   â””â”€â”€ vaccination/
â”‚       â”œâ”€â”€ useVaccinationManager.js         # ë°±ì‹  ê´€ë¦¬ ì „ë¬¸ê°€
â”‚       â””â”€â”€ useVaccinationModeManager.js     # ë°±ì‹  ëª¨ë“œ ì „í™˜ ì „ë¬¸ê°€
â”‚
â”œâ”€â”€ ğŸ“‚ community/                 # ì»¤ë®¤ë‹ˆí‹° ì „ë¬¸ í›…ë“¤
â”‚   â”œâ”€â”€ useCommunityPosts.js      # ê²Œì‹œê¸€ CRUD ì „ë¬¸ê°€
â”‚   â”œâ”€â”€ useRealtimeComments.js    # ì‹¤ì‹œê°„ ëŒ“ê¸€ ì „ë¬¸ê°€ â­
â”‚   â”œâ”€â”€ useLikes.js               # ì¢‹ì•„ìš” ì „ë¬¸ê°€
â”‚   â””â”€â”€ useHashtagInput.js        # í•´ì‹œíƒœê·¸ ì…ë ¥ ì „ë¬¸ê°€
â”‚
â”œâ”€â”€ ğŸ“‚ lifestyle/                 # ë¼ì´í”„ìŠ¤íƒ€ì¼ ì „ë¬¸ í›…ë“¤
â”‚   â””â”€â”€ realtime/
â”‚       â”œâ”€â”€ useLifestyleChat.js          # ì±„íŒ… ë©”ì‹œì§€ ê´€ë¦¬ â­â­â­
â”‚       â”œâ”€â”€ useLifestyleChatRooms.js     # ì±„íŒ…ë°© ê´€ë¦¬ â­â­â­
â”‚       â”œâ”€â”€ useRealtimeChat.js           # ì‹¤ì‹œê°„ êµ¬ë… â­â­â­
â”‚       â”œâ”€â”€ useParticipants.js           # ì°¸ì—¬ì ê´€ë¦¬ â­â­â­
â”‚       â””â”€â”€ useImageUpload.js            # ì´ë¯¸ì§€ ì—…ë¡œë“œ â­â­â­
â”‚
â”œâ”€â”€ ğŸ“‚ profile/                   # í”„ë¡œí•„ ê´€ë¦¬ ì „ë¬¸ í›…ë“¤
â”‚   â”œâ”€â”€ useProfile.js             # ì‚¬ìš©ì í”„ë¡œí•„ ì „ë¬¸ê°€
â”‚   â”œâ”€â”€ usePalProfile.js          # ë°˜ë ¤ë™ë¬¼ í”„ë¡œí•„ ì „ë¬¸ê°€
â”‚   â””â”€â”€ useGallery.js             # ê°¤ëŸ¬ë¦¬ ì „ë¬¸ê°€
â”‚
â”œâ”€â”€ ğŸ“‚ pet-registration/          # ë°˜ë ¤ë™ë¬¼ ë“±ë¡ ì „ë¬¸ í›…ë“¤ â­â­
â”‚   â”œâ”€â”€ usePetAPI.js              # API í†µì‹  ì „ë¬¸ê°€
â”‚   â”œâ”€â”€ usePetFormState.js        # í¼ ìƒíƒœ ê´€ë¦¬ ì „ë¬¸ê°€
â”‚   â”œâ”€â”€ usePetValidation.js       # ìœ íš¨ì„± ê²€ì‚¬ ì „ë¬¸ê°€
â”‚   â””â”€â”€ usePetRegistration.js     # ë§ˆìŠ¤í„° í†µí•© Hook
â”‚
â”œâ”€â”€ ğŸ“‚ hashtag/                   # í•´ì‹œíƒœê·¸ ìë™ì™„ì„±
â”‚   â””â”€â”€ useHashtagAutocomplete.js # ì‹¤ì‹œê°„ ì¸ê¸° í•´ì‹œíƒœê·¸ ì¡°íšŒ â­
â”‚
â”œâ”€â”€ ğŸ“‚ maps/                      # Kakao Maps í†µí•©
â”‚   â””â”€â”€ useHospitalSearch.ts      # ë³‘ì› ê²€ìƒ‰ ì „ë¬¸ê°€
â”‚
â””â”€â”€ ğŸ“‚ shared/                    # ê³µìš© ì¬ì‚¬ìš© í›…ë“¤
    â”œâ”€â”€ useGlobalHashtags.js      # í†µí•© í•´ì‹œíƒœê·¸ ì‹œìŠ¤í…œ â­â­
    â”œâ”€â”€ useSupabase.js            # Supabase í´ë¼ì´ì–¸íŠ¸
    â””â”€â”€ useFileUpload.js          # íŒŒì¼ ì—…ë¡œë“œ ê³µí†µ
```

### 3.3. Hook Composition ì„±ê³¼

| **íŒŒì¼ëª…**              | **Before** | **After** | **ê°ì†Œìœ¨** |
| :---------------------- | ---------: | --------: | ---------: |
| **FeedDetailModal**     |      528ì¤„ |     231ì¤„ |    **56%** |
| **useCommunityPosts**   |      386ì¤„ |     128ì¤„ |    **67%** |
| **EventListSection**    |      303ì¤„ |     117ì¤„ |    **61%** |
| **useRealtimeComments** |      310ì¤„ |     238ì¤„ |    **23%** |
| **FeedCard**            |      561ì¤„ |     160ì¤„ |    **71%** |
| **usePlanner**          |      676ì¤„ |     165ì¤„ |    **75%** |

**í‰ê·  ì½”ë“œ ì¶•ì†Œìœ¨**: **60%** âœ…

---

## ğŸ“ 4. Co-location ì•„í‚¤í…ì²˜ (App Router ê¸°ë°˜)

### 4.1. Co-location ê°œë…

> **"ê¸°ëŠ¥ì— í•„ìš”í•œ ëª¨ë“  íŒŒì¼ì„ í•˜ë‚˜ì˜ í´ë”ì— ëª¨ì•„ ì™„ì „í•œ ë…ë¦½ì„±ì„ í™•ë³´"**

```mermaid
graph TB
    Feature[Feature Folder] --> Component[Component Files]
    Feature --> Hooks[Custom Hooks]
    Feature --> CSS[CSS Modules]
    Feature --> Utils[Utility Functions]

    Component --> JSX[index.jsx]
    Hooks --> Hook1[useFeature.js]
    CSS --> Style[feature.module.css]
    Utils --> Util[helper.js]

    style Feature fill:#E3F2FD
    style Component fill:#F3E5F5
    style Hooks fill:#FFF3E0
    style CSS fill:#E8F5E9
    style Utils fill:#FCE4EC
```

**ì „í†µì  ë°©ì‹ (âŒ ë‚˜ìœ ì˜ˆ)**:

```
ğŸ“ src/
â”œâ”€â”€ components/
â”‚   â”œâ”€â”€ Calendar.tsx
â”‚   â”œâ”€â”€ EventList.tsx
â”‚   â””â”€â”€ Wallet.tsx
â”œâ”€â”€ hooks/
â”‚   â”œâ”€â”€ useCalendar.js
â”‚   â”œâ”€â”€ useEvents.js
â”‚   â””â”€â”€ useExpenses.js
â””â”€â”€ styles/
    â”œâ”€â”€ calendar.css
    â”œâ”€â”€ eventList.css
    â””â”€â”€ wallet.css
```

**Co-location ë°©ì‹ (âœ… ì¢‹ì€ ì˜ˆ)**:

```
ğŸ“ Planner/
â”œâ”€â”€ page.tsx
â”œâ”€â”€ hooks/
â”‚   â”œâ”€â”€ usePlanner.js
â”‚   â””â”€â”€ useCalendar.js
â”œâ”€â”€ _components/
â”‚   â”œâ”€â”€ Calendar/
â”‚   â”‚   â”œâ”€â”€ index.jsx
â”‚   â”‚   â”œâ”€â”€ CalendarView.jsx
â”‚   â”‚   â””â”€â”€ calendarview.module.css  âœ… ê°™ì€ í´ë”!
â”‚   â”œâ”€â”€ EventListSection/
â”‚   â”‚   â”œâ”€â”€ index.jsx
â”‚   â”‚   â””â”€â”€ eventlistsection.module.css  âœ… ê°™ì€ í´ë”!
â”‚   â””â”€â”€ Wallet/
â”‚       â”œâ”€â”€ index.jsx
â”‚       â””â”€â”€ wallet.module.css  âœ… ê°™ì€ í´ë”!
â””â”€â”€ planner.module.css
```

### 4.2. ì „ì²´ í´ë” êµ¬ì¡° (2025-11-14 ê¸°ì¤€)

```
ğŸ“ frontend/src/app/
â”œâ”€â”€ ğŸ“ main/                              # ì¸ì¦ í›„ ë©”ì¸ ê¸°ëŠ¥ë“¤
â”‚   â”œâ”€â”€ ğŸ“ HomePage/                      # ë©”ì¸ ëŒ€ì‹œë³´ë“œ
â”‚   â”‚   â”œâ”€â”€ homepage.module.css
â”‚   â”‚   â”œâ”€â”€ leftPanel/
â”‚   â”‚   â”œâ”€â”€ quickActionsBar/
â”‚   â”‚   â””â”€â”€ rightPanel/
â”‚   â”‚
â”‚   â”œâ”€â”€ ğŸ“ aiassistant/                   # AI ì§„ë‹¨ + RAG ì±—ë´‡ â­â­â­
â”‚   â”‚   â”œâ”€â”€ page.tsx
â”‚   â”‚   â”œâ”€â”€ aiassistant.module.css
â”‚   â”‚   â””â”€â”€ _components/
â”‚   â”‚       â”œâ”€â”€ LeftPanel/               # ì´ë¯¸ì§€ ì—…ë¡œë“œ + ê²°ê³¼
â”‚   â”‚       â”œâ”€â”€ RightPanel/              # AI ì±—ë´‡ + RAG ê²€ìƒ‰
â”‚   â”‚       â”œâ”€â”€ PetHospital/             # ë³‘ì› ì°¾ê¸° (Kakao Map)
â”‚   â”‚       â””â”€â”€ HashtagSuggestions/      # í•´ì‹œíƒœê·¸ ìë™ì™„ì„±
â”‚   â”‚
â”‚   â”œâ”€â”€ ğŸ“ planner/                       # ì¼ì • + ê°€ê³„ë¶€ ê´€ë¦¬ â­â­
â”‚   â”‚   â”œâ”€â”€ page.tsx
â”‚   â”‚   â”œâ”€â”€ planner.module.css
â”‚   â”‚   â”œâ”€â”€ hooks/
â”‚   â”‚   â”‚   â””â”€â”€ vaccination/
â”‚   â”‚   â”œâ”€â”€ lib/
â”‚   â”‚   â”‚   â””â”€â”€ vaccination/
â”‚   â”‚   â””â”€â”€ _components/
â”‚   â”‚       â”œâ”€â”€ Calendar/                # ì»¤ìŠ¤í…€ ë‹¬ë ¥ (ë“œë˜ê·¸ì•¤ë“œë¡­)
â”‚   â”‚       â”œâ”€â”€ EventListSection/        # ì¼ì • ëª©ë¡
â”‚   â”‚       â”œâ”€â”€ Wallet/                  # ê°€ê³„ë¶€
â”‚   â”‚       â”œâ”€â”€ palVaccination/          # ë°±ì‹  ê´€ë¦¬
â”‚   â”‚       â””â”€â”€ PlannerSmartPanel/       # ìŠ¤ë§ˆíŠ¸ íŒ¨ë„
â”‚   â”‚
â”‚   â”œâ”€â”€ ğŸ“ community/                     # ì†Œì…œ ì»¤ë®¤ë‹ˆí‹° â­â­
â”‚   â”‚   â”œâ”€â”€ page.tsx
â”‚   â”‚   â”œâ”€â”€ community.module.css
â”‚   â”‚   â””â”€â”€ _components/
â”‚   â”‚       â”œâ”€â”€ PostTab/                 # ê²Œì‹œê¸€ í”¼ë“œ
â”‚   â”‚       â””â”€â”€ shared/                  # ê³µìœ  ì»´í¬ë„ŒíŠ¸
â”‚   â”‚
â”‚   â”œâ”€â”€ ğŸ“ lifestyle/                     # ì‹¤ì‹œê°„ ì±„íŒ… â­â­â­
â”‚   â”‚   â”œâ”€â”€ page.tsx
â”‚   â”‚   â”œâ”€â”€ lifestyle.module.css
â”‚   â”‚   â””â”€â”€ _components/
â”‚   â”‚       â”œâ”€â”€ lifestyle.module.css
â”‚   â”‚       â””â”€â”€ RealtimeChat/            # ì±„íŒ… ì‹œìŠ¤í…œ
â”‚   â”‚           â”œâ”€â”€ index.tsx
â”‚   â”‚           â”œâ”€â”€ realtimechat.module.css
â”‚   â”‚           â””â”€â”€ components/
â”‚   â”‚               â”œâ”€â”€ BookmarkTabs/    # ë¶ë§ˆí¬ íƒ­
â”‚   â”‚               â”œâ”€â”€ ChatRoom/        # ì±„íŒ…ë£¸
â”‚   â”‚               â”œâ”€â”€ HashtagRooms/    # í•´ì‹œíƒœê·¸ ë°© ëª©ë¡
â”‚   â”‚               â”œâ”€â”€ ParticipantsDropdown/
â”‚   â”‚               â””â”€â”€ MoreMenu/
â”‚   â”‚
â”‚   â””â”€â”€ page.tsx                          # ë©”ì¸ ë¼ìš°íŠ¸
â”‚
â”œâ”€â”€ ğŸ“ mypage/                            # í”„ë¡œí•„ + ë°˜ë ¤ë™ë¬¼ ê´€ë¦¬
â”‚   â”œâ”€â”€ page.tsx
â”‚   â””â”€â”€ _components/
â”‚
â”œâ”€â”€ ğŸ“ settings/                          # ì„¤ì • í˜ì´ì§€
â”‚   â”œâ”€â”€ page.tsx
â”‚   â””â”€â”€ _components/
â”‚       â””â”€â”€ hooks/
â”‚           â””â”€â”€ useAppActions.js          # íšŒì›íƒˆí‡´ ë¡œì§ í¬í•¨ â­
â”‚
â”œâ”€â”€ ğŸ“ login/                             # ë¡œê·¸ì¸ í˜ì´ì§€
â”œâ”€â”€ ğŸ“ signup/                            # íšŒì›ê°€ì… í˜ì´ì§€
â”œâ”€â”€ ğŸ“ forgotpass/                        # ë¹„ë°€ë²ˆí˜¸ ì°¾ê¸°
â”‚
â””â”€â”€ ğŸ“ api/                               # ì„œë²„ì‚¬ì´ë“œ API ì—”ë“œí¬ì¸íŠ¸
    â”œâ”€â”€ ai/                               # RAG + ì„ë² ë”© + ì§€ì‹ ê²€ìƒ‰
    â”œâ”€â”€ community/                        # ê²Œì‹œê¸€ + ì¢‹ì•„ìš” + ëŒ“ê¸€
    â”œâ”€â”€ health/                           # YOLO ì§ˆí™˜ ê°ì§€
    â”œâ”€â”€ planner/                          # ì¼ì • + ë°±ì‹  ë™ê¸°í™”
    â”œâ”€â”€ profile/                          # ì‚¬ìš©ì + ë°˜ë ¤ë™ë¬¼ ê´€ë¦¬
    â”œâ”€â”€ vaccinations/                     # ë°±ì‹  ìƒì„± + ê´€ë¦¬
    â”œâ”€â”€ hashtags/                         # í•´ì‹œíƒœê·¸ ìë™ì™„ì„±
    â””â”€â”€ cron/                             # ìë™ ì„ë² ë”© ìƒì„±
```

---

## ğŸ¨ 5. CSS ì•„í‚¤í…ì²˜ & BEM ë„¤ì´ë°

### 5.1. CSS ëª¨ë“ˆ Co-location íŒ¨í„´

```
ğŸ“ ComponentName/
â”œâ”€â”€ index.jsx                    # ì»´í¬ë„ŒíŠ¸ ë¡œì§
â”œâ”€â”€ componentname.module.css     # ì „ìš© ìŠ¤íƒ€ì¼ â­ (ì†Œë¬¸ì + camelCase)
â”œâ”€â”€ hooks/                       # ì»´í¬ë„ŒíŠ¸ ì „ìš© í›… (ì„ íƒ)
â”œâ”€â”€ utils/                       # ìœ í‹¸ë¦¬í‹° í•¨ìˆ˜ (ì„ íƒ)
â””â”€â”€ components/                  # í•˜ìœ„ ì»´í¬ë„ŒíŠ¸ (ì„ íƒ)
```

**ì˜ˆì‹œ**:

```
ğŸ“ ChatRoom/
â”œâ”€â”€ index.tsx
â”œâ”€â”€ chatroom.module.css          # â­ ì»´í¬ë„ŒíŠ¸ëª….module.css
â”œâ”€â”€ hooks/
â”‚   â””â”€â”€ useChatRoom.js
â””â”€â”€ components/
    â”œâ”€â”€ MessageBubble.tsx
    â””â”€â”€ InputArea.tsx
```

### 5.2. BEM ë„¤ì´ë° íŒ¨í„´

```css
/* Block (ë¸”ë¡) */
.LifestyleChat_ChatRoom_Container {
  display: flex;
  flex-direction: column;
}

/* Element (ìš”ì†Œ) */
.LifestyleChat_ChatRoom_MessagesContainer {
  flex: 1;
  overflow-y: auto;
}

/* Modifier (ìˆ˜ì •ì) */
.LifestyleChat_ChatRoom_MessageBubble--mine {
  background: #dcf8c6;
  align-self: flex-end;
}

.LifestyleChat_ChatRoom_MessageBubble--other {
  background: #ffffff;
  align-self: flex-start;
}
```

**ë„¤ì´ë° ê·œì¹™**:

- **Block**: `.ê¸°ëŠ¥_ë¸”ë¡ëª…`
- **Element**: `.ê¸°ëŠ¥_ë¸”ë¡ëª…_ìš”ì†Œëª…`
- **Modifier**: `.ê¸°ëŠ¥_ë¸”ë¡ëª…_ìš”ì†Œëª…--ìˆ˜ì •ì`

### 5.3. ë°˜ì‘í˜• CSS (4ë‹¨ê³„ ë¸Œë ˆì´í¬í¬ì¸íŠ¸)

```css
/* ğŸ’» Desktop (ê¸°ë³¸) - 1281px ì´ìƒ */
.element {
  font-size: 1rem;
  padding: 16px;
  gap: 12px;
}

/* ğŸ’» ì¤‘í˜• (1280px ì´í•˜) - 10% ì¶•ì†Œ */
@media (max-width: 1280px) {
  .element {
    font-size: 0.9375rem;
    padding: 14px;
    gap: 10px;
  }
}

/* ğŸ“± ì†Œí˜• (900px ì´í•˜) - 20% ì¶•ì†Œ */
@media (max-width: 900px) {
  .element {
    font-size: 0.875rem;
    padding: 12px;
    gap: 8px;
  }
}

/* ğŸ“± ëª¨ë°”ì¼ (768px ì´í•˜) - ì„¸ë¡œ ë°°ì¹˜ */
@media (max-width: 768px) {
  .element {
    flex-direction: column;
    width: 100%;
    font-size: 0.8125rem;
    padding: 10px;
    gap: 6px;
  }
}

/* ğŸ“± ì´ˆì†Œí˜• (400px ì´í•˜) - ìµœì†Œí™” */
@media (max-width: 400px) {
  .element {
    font-size: 0.75rem;
    padding: 8px;
    gap: 4px;
  }
}
```

---

## ğŸ—„ï¸ 6. ë°ì´í„°ë² ì´ìŠ¤ ì•„í‚¤í…ì²˜ (PostgreSQL + pgvector)

### 6.1. ì£¼ìš” í…Œì´ë¸” êµ¬ì¡°

```mermaid
erDiagram
    AUTH_USERS ||--|| PROFILES : "1:1"
    PROFILES ||--o{ PAL_PROFILES : "1:N"
    PAL_PROFILES ||--o{ PAL_VACCINATIONS : "1:N"
    PAL_PROFILES ||--o{ PAL_HEALTH_RECORDS : "1:N"

    PROFILES ||--o{ COMMUNITY_POSTS : "1:N"
    COMMUNITY_POSTS ||--o{ POST_COMMENTS : "1:N"
    COMMUNITY_POSTS ||--o{ POST_LIKES : "1:N"

    PROFILES ||--o{ PLANNER_EVENTS : "1:N"
    PROFILES ||--o{ PLANNER_EXPENSES : "1:N"

    PROFILES ||--o{ LIFESTYLE_CHAT_ROOMS : "1:N"
    LIFESTYLE_CHAT_ROOMS ||--o{ LIFESTYLE_CHAT_MESSAGES : "1:N"

    GLOBAL_HASHTAGS ||--o{ COMMUNITY_POST_HASHTAGS : "1:N"
    GLOBAL_HASHTAGS ||--o{ PLANNER_EVENT_HASHTAGS : "1:N"
    GLOBAL_HASHTAGS ||--o{ LIFESTYLE_CHAT_MESSAGE_HASHTAGS : "1:N"

    COMMUNITY_POSTS ||--o{ PET_KNOWLEDGE_BASE : "1:N"

    AUTH_USERS {
        uuid id PK
        string email
        string encrypted_password
        timestamp created_at
    }

    PROFILES {
        uuid id PK
        string displayName
        string avatarUrl
        boolean profileComplete
    }

    PAL_PROFILES {
        uuid palId PK
        uuid userId FK
        string palName
        date palBirthdate
        string palBreed
        boolean isPrimary
    }

    PAL_VACCINATIONS {
        uuid id PK
        uuid palId FK
        int vaccinationTypeId
        date scheduledDate
        boolean isCompleted
    }

    COMMUNITY_POSTS {
        uuid id PK
        uuid userId FK
        string title
        text content
        int likesCount
    }

    GLOBAL_HASHTAGS {
        serial id PK
        text tagName
        int usageCount
        text primaryCategory
    }

    PET_KNOWLEDGE_BASE {
        uuid id PK
        text content
        vector embedding
        text source
        numeric quality_score
        boolean is_verified
    }

    LIFESTYLE_CHAT_ROOMS {
        uuid roomid PK
        text roomtype
        text hashtagname
    }

    LIFESTYLE_CHAT_MESSAGES {
        uuid id PK
        uuid roomid FK
        uuid userid FK
        text content
    }
```

### 6.2. ì»¤ë®¤ë‹ˆí‹° & í•´ì‹œíƒœê·¸ ì‹œìŠ¤í…œ

```mermaid
graph TB
    Posts[communityPosts] --> Comments[postcomments]
    Posts --> Likes[postlikes]
    Posts --> PostHashtags[communityPostHashtags]

    GlobalHashtags[globalHashtags] --> PostHashtags
    GlobalHashtags --> EventHashtags[plannerEventHashtags]
    GlobalHashtags --> MessageHashtags[lifestylechatmessagehashtags]

    Events[plannerEvents] --> EventHashtags
    Messages[lifestylechatmessages] --> MessageHashtags

    Posts --> RAG[pet_knowledge_base]

    style Posts fill:#FFB74D
    style GlobalHashtags fill:#66BB6A
    style RAG fill:#BA68C8
```

### 6.3. RAG ì‹œìŠ¤í…œ (pgvector) â­â­â­

```sql
CREATE TABLE pet_knowledge_base (
  id UUID PRIMARY KEY DEFAULT uuid_generate_v4(),
  content TEXT NOT NULL,
  embedding VECTOR(384),  -- HuggingFace 384ì°¨ì› ë²¡í„°
  source TEXT CHECK (source IN ('community', 'faq', 'youtube', 'manual')),
  source_url TEXT,
  quality_score NUMERIC(3,2) CHECK (quality_score >= 0 AND quality_score <= 1),
  is_verified BOOLEAN DEFAULT FALSE,
  metadata JSONB,
  created_at TIMESTAMP WITH TIME ZONE DEFAULT TIMEZONE('utc', NOW()),
  updated_at TIMESTAMP WITH TIME ZONE DEFAULT TIMEZONE('utc', NOW())
);

-- Vector Similarity Search Index
CREATE INDEX ON pet_knowledge_base USING ivfflat (embedding vector_cosine_ops);
```

---

## ğŸ” 7. ë³´ì•ˆ ì•„í‚¤í…ì²˜ (Supabase ë³´ì•ˆ ì •ì±… ê¸°ë°˜)

### 7.1. Row Level Security (RLS) ì •ì±…

```sql
-- âœ… ì˜¬ë°”ë¥¸ RLS ì •ì±… (Function Search Path ê³µê²© ì°¨ë‹¨)
CREATE POLICY "policy_user_profiles_select"
ON profiles FOR SELECT
USING (id = (select auth.uid()));  -- â­ ì„œë¸Œì¿¼ë¦¬ë¡œ ë³´ì•ˆ ê°•í™”

-- âŒ ì·¨ì•½í•œ RLS ì •ì±… (Function Search Path ê³µê²© ê°€ëŠ¥)
CREATE POLICY "policy_user_profiles_select"
ON profiles FOR SELECT
USING (id = auth.uid());  -- âŒ ì§ì ‘ í˜¸ì¶œ ì‹œ ê³µê²© ê°€ëŠ¥
```

### 7.2. Storage ë³´ì•ˆ ì •ì±…

```mermaid
graph TB
    Bucket[ğŸ“¦ profileImage Bucket]

    Bucket --> UserProfiles[user-profiles/<br/>userId/]
    Bucket --> PalProfiles[pal-profiles/<br/>palId/]
    Bucket --> ChatImages[lifestyle-chat-images/<br/>roomId/]
    Bucket --> Public[public/<br/>3D Avatars]

    UserProfiles --> RLS1[ğŸ”’ RLS ì ìš©<br/>ë³¸ì¸ë§Œ ì ‘ê·¼]
    PalProfiles --> RLS2[ğŸ”’ RLS ì ìš©<br/>ë³¸ì¸ë§Œ ì ‘ê·¼]
    ChatImages --> RLS3[ğŸ”’ RLS ì ìš©<br/>ì°¸ì—¬ìë§Œ ì ‘ê·¼]
    Public --> Open[ğŸ”“ ê³µê°œ ì ‘ê·¼]

    style Bucket fill:#E3F2FD
    style RLS1 fill:#FFCDD2
    style RLS2 fill:#FFCDD2
    style RLS3 fill:#FFCDD2
    style Open fill:#C8E6C9
```

---

## ğŸš€ 8. ë°°í¬ ì•„í‚¤í…ì²˜

```mermaid
%%{init: {'theme':'base', 'themeVariables': { 'fontSize':'20px'}}}%%
graph LR
    GitHub["<b>GitHub</b><br/>ì†ŒìŠ¤ ì½”ë“œ ê´€ë¦¬"]
    Vercel["<b>Vercel</b><br/>Frontend ë°°í¬<br/>ìë™ CD"]
    AWS["<b>AWS EC2</b><br/>AI Server<br/>Ubuntu 22.04"]
    Supabase["<b>Supabase</b><br/>Database + BaaS<br/>Global CDN"]

    GitHub --> Vercel
    GitHub --> AWS

    Vercel -->|HTTPS| Supabase
    Vercel -->|HTTP| AWS

    style GitHub fill:#F3E5F5
    style Vercel fill:#E3F2FD
    style AWS fill:#FCE4EC
    style Supabase fill:#E0F2F1
```

**ë°°í¬ ì •ë³´**:

- **Frontend**: Vercel (ìë™ ë°°í¬)
- **AI Server**: AWS EC2 (ìˆ˜ë™ ë°°í¬)
  > **ğŸ“Œ ì°¸ê³ **: AI-hub ê³µê³µë°ì´í„°ë¥¼ í™œìš©í•˜ì—¬ í•™ìŠµí•œ YOLO ëª¨ë¸ì€ ë°°í¬ë¥¼ í•˜ì§€ ì•Šê³ , ë¡œì»¬ ì‹œì—° ì˜ìƒìœ¼ë¡œ ëŒ€ì²´í•˜ì˜€ìŠµë‹ˆë‹¤.
- **Database**: Supabase (í´ë¼ìš°ë“œ)

---

## ğŸ“Š 9. ì„±ëŠ¥ ìµœì í™” & ì‹œìŠ¤í…œ ë©”íŠ¸ë¦­ìŠ¤

### 9.1. ë°ì´í„°ë² ì´ìŠ¤ ìµœì í™”

- **ì¸ë±ìŠ¤ ì ìš©**: userId, palId, roomid ë“± FKì— ì¸ë±ìŠ¤
- **íŠ¸ë¦¬ê±° ìµœì í™”**: í•„ìš”í•œ ê²½ìš°ì—ë§Œ ì‹¤í–‰
- **RLS ì„±ëŠ¥**: ì„œë¸Œì¿¼ë¦¬ ë°©ì‹ìœ¼ë¡œ ë³´ì•ˆ + ì„±ëŠ¥ í™•ë³´

### 9.2. í”„ë¡ íŠ¸ì—”ë“œ ìµœì í™”

- **Hook Composition**: í‰ê·  60% ì½”ë“œ ì¶•ì†Œ
- **Co-location**: ê¸°ëŠ¥ë³„ ë…ë¦½ì„± í™•ë³´
- **CSS Modules**: ëŸ°íƒ€ì„ ìµœì í™”

### 9.3. AI ì„œë²„ ìµœì í™”

- **GPU ê°€ì†**: NVIDIA RTX 4060 í™œìš©
- **ë©€í‹°ëª¨ë¸ ê´€ë¦¬**: ë™ì‹œ ì²˜ë¦¬ ì§€ì›
- **í‰ê·  ì‘ë‹µ ì‹œê°„**: 3~5ì´ˆ

### 9.4. ì‹œìŠ¤í…œ ë©”íŠ¸ë¦­ìŠ¤

| **í•­ëª©**                  |   **ìˆ˜ì¹˜** | **ë¹„ê³ **           |
| :------------------------ | ---------: | :----------------- |
| **í‰ê·  ì‘ë‹µ ì‹œê°„**        |      3-5ì´ˆ | YOLO ë¶„ì„ í¬í•¨     |
| **ì‹¤ì‹œê°„ ì§€ì—°**           | 100ms ì´í•˜ | Supabase Realtime  |
| **ë°ì´í„°ë² ì´ìŠ¤ RLS ì •ì±…** |       47ê°œ | ë³´ì•ˆ ê°•í™”          |
| **Hook Composition ì„±ê³¼** |   60% ì¶•ì†Œ | ì½”ë“œ ê°ì†Œìœ¨        |
| **ì§€ì› ë¸Œë ˆì´í¬í¬ì¸íŠ¸**   |      4ë‹¨ê³„ | 400px ~ 1280px+    |
| **AI ëª¨ë¸ í›ˆë ¨ ë°ì´í„°**   |  668,547ê°œ | ì´ë¯¸ì§€             |
| **RAG ì§€ì‹ ë² ì´ìŠ¤**       |    384ì°¨ì› | HuggingFace ì„ë² ë”© |
| **ì´ í…Œì´ë¸” ìˆ˜**          |      40ê°œ+ | PostgreSQL         |

---

**ğŸ“ ë¬¸ì„œ ì •ë³´**

- **ì‘ì„±ì¼**: 2025-11-14
- **ì‘ì„±ì**: LYSS with Claude
- **ë²„ì „**: v3.0 (ìµœì¢… ë°œí‘œìš© í†µí•© ë²„ì „)
- **ì´ì „ ë¬¸ì„œ**: [03*ì‹œìŠ¤í…œ*íë¦„ë„.md](./03_ì‹œìŠ¤í…œ_íë¦„ë„.md)
- **ë‹¤ìŒ ë¬¸ì„œ**: [05_ERD.md](./05_ERD.md)
