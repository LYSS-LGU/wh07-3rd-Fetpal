<!DOCTYPE html>
<html lang="ko">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>04_ì‹œìŠ¤í…œ_ì•„í‚¤í…ì²˜</title>

    <!-- Mermaid.js CDN -->
    <script type="module">
        import mermaid from 'https://cdn.jsdelivr.net/npm/mermaid@10/dist/mermaid.esm.min.mjs';
        mermaid.initialize({
            startOnLoad: true,
            theme: 'default',
            securityLevel: 'loose',
            flowchart: {
                useMaxWidth: true,
                htmlLabels: true,
                curve: 'basis'
            },
            sequence: {
                diagramMarginX: 50,
                diagramMarginY: 10,
                actorMargin: 50,
                width: 150,
                height: 65,
                boxMargin: 10,
                boxTextMargin: 5,
                noteMargin: 10,
                messageMargin: 35,
                mirrorActors: true,
                useMaxWidth: true
            }
        });
    </script>

    <style>
        @media print {
            @page {
                size: A4 portrait;
                margin: 2cm;
            }

            /* ë¸Œë¼ìš°ì € ê¸°ë³¸ í—¤ë”/í‘¸í„° ìˆ¨ê¸°ê¸° */
            @page {
                margin-top: 2cm;
                margin-bottom: 2cm;
            }

            body {
                margin: 0;
                padding: 0;
            }

            .print-button {
                display: none !important;
            }

            /* Mermaid ë‹¤ì´ì–´ê·¸ë¨ í˜ì´ì§€ ë¸Œë ˆì´í¬ ë°©ì§€ */
            .mermaid {
                page-break-inside: avoid;
                break-inside: avoid;
            }

            pre {
                page-break-inside: avoid;
            }
        }

        * {
            box-sizing: border-box;
        }

        body {
            font-family: -apple-system, BlinkMacSystemFont, "Malgun Gothic", "ë§‘ì€ ê³ ë”•",
                         "Segoe UI", "Noto Sans KR", Arial, sans-serif;
            line-height: 1.7;
            color: #24292e;
            max-width: 1200px;
            margin: 0 auto;
            padding: 40px 20px;
            background: #ffffff;
        }

        /* í—¤ë” ìŠ¤íƒ€ì¼ */
        h1 {
            color: #1a1a1a;
            border-bottom: 4px solid #0366d6;
            padding-bottom: 12px;
            margin-top: 32px;
            margin-bottom: 24px;
            font-size: 2.2em;
            font-weight: 700;
            page-break-after: avoid;
        }

        h2 {
            color: #24292e;
            border-bottom: 2px solid #e1e4e8;
            padding-bottom: 10px;
            margin-top: 28px;
            margin-bottom: 20px;
            font-size: 1.8em;
            font-weight: 600;
            page-break-after: avoid;
        }

        h3 {
            color: #24292e;
            margin-top: 24px;
            margin-bottom: 16px;
            font-size: 1.4em;
            font-weight: 600;
            page-break-after: avoid;
        }

        h4 {
            color: #24292e;
            margin-top: 20px;
            margin-bottom: 12px;
            font-size: 1.15em;
            font-weight: 600;
            page-break-after: avoid;
        }

        /* Mermaid ë‹¤ì´ì–´ê·¸ë¨ ìŠ¤íƒ€ì¼ */
        .mermaid {
            background-color: #f6f8fa;
            border: 1px solid #e1e4e8;
            border-radius: 8px;
            padding: 24px;
            margin: 24px 0;
            overflow-x: auto;
            text-align: center;
            page-break-inside: avoid;
        }

        .mermaid svg {
            max-width: 100%;
            height: auto;
        }

        /* í…Œì´ë¸” ìŠ¤íƒ€ì¼ */
        table {
            border-collapse: collapse;
            width: 100%;
            margin: 20px 0;
            display: table;
            overflow-x: auto;
            page-break-inside: avoid;
        }

        th, td {
            border: 1px solid #d0d7de;
            padding: 10px 16px;
            text-align: left;
        }

        th {
            background-color: #0366d6;
            color: white;
            font-weight: 600;
        }

        tr:nth-child(even) {
            background-color: #f6f8fa;
        }

        /* ì½”ë“œ ë¸”ë¡ ìŠ¤íƒ€ì¼ */
        code {
            background-color: #f6f8fa;
            padding: 3px 6px;
            border-radius: 4px;
            font-family: "Consolas", "Monaco", "Courier New", monospace;
            font-size: 0.9em;
            color: #e83e8c;
        }

        pre {
            background-color: #f6f8fa;
            padding: 20px;
            border-radius: 8px;
            border-left: 4px solid #0366d6;
            overflow-x: auto;
            margin: 20px 0;
            page-break-inside: avoid;
        }

        pre code {
            background-color: transparent;
            padding: 0;
            color: #24292e;
            font-size: 0.9em;
        }

        /* ì¸ìš©êµ¬ ìŠ¤íƒ€ì¼ */
        blockquote {
            border-left: 4px solid #0366d6;
            padding: 12px 20px;
            margin: 20px 0;
            background-color: #f6f8fa;
            color: #57606a;
            border-radius: 4px;
        }

        blockquote p {
            margin: 0;
        }

        /* ë¦¬ìŠ¤íŠ¸ ìŠ¤íƒ€ì¼ */
        ul, ol {
            margin: 16px 0;
            padding-left: 32px;
        }

        li {
            margin: 8px 0;
        }

        /* ì´ë¯¸ì§€ ìŠ¤íƒ€ì¼ */
        img {
            max-width: 100%;
            height: auto;
            display: block;
            margin: 24px auto;
            border-radius: 6px;
            box-shadow: 0 4px 12px rgba(0,0,0,0.1);
        }

        /* ë§í¬ ìŠ¤íƒ€ì¼ */
        a {
            color: #0366d6;
            text-decoration: none;
        }

        a:hover {
            text-decoration: underline;
        }

        /* êµ¬ë¶„ì„  ìŠ¤íƒ€ì¼ */
        hr {
            border: none;
            border-top: 2px solid #e1e4e8;
            margin: 32px 0;
        }

        /* í”„ë¦°íŠ¸ ë²„íŠ¼ */
        .print-button {
            position: fixed;
            top: 20px;
            right: 20px;
            padding: 12px 24px;
            background: linear-gradient(135deg, #0366d6 0%, #0256c7 100%);
            color: white;
            border: none;
            border-radius: 8px;
            cursor: pointer;
            font-size: 15px;
            font-weight: 600;
            box-shadow: 0 4px 12px rgba(3,102,214,0.3);
            z-index: 1000;
            transition: all 0.3s ease;
        }

        .print-button:hover {
            background: linear-gradient(135deg, #0256c7 0%, #024aa8 100%);
            box-shadow: 0 6px 16px rgba(3,102,214,0.4);
            transform: translateY(-2px);
        }

        .print-button:active {
            transform: translateY(0);
        }

        /* ì´ëª¨ì§€ ìŠ¤íƒ€ì¼ */
        .emoji {
            font-family: "Apple Color Emoji", "Segoe UI Emoji", "Noto Color Emoji", sans-serif;
        }

        /* ì£¼ì„ ìŠ¤íƒ€ì¼ (Note) */
        p strong {
            color: #0366d6;
        }
    </style>
</head>
<body>
    <button class="print-button" onclick="window.print()">
        <span class="emoji">ğŸ–¨ï¸</span> PDFë¡œ ì €ì¥
    </button>

    <h1>Fetpal ì‹œìŠ¤í…œ ì•„í‚¤í…ì²˜</h1>
<blockquote>
<p><strong>4ì°¨ ìŠ¤í”„ë¦°íŠ¸ ë°œí‘œ</strong> (2025.11.14)<br />
<strong>ìµœì¢… ë°œí‘œ</strong>: 2025-11-21</p>
</blockquote>
<hr />
<h2>ğŸ“‹ ë¬¸ì„œ ê°œìš”</h2>
<p>ì´ ë¬¸ì„œëŠ” Fetpal í”„ë¡œì íŠ¸ì˜ ì „ì²´ ì‹œìŠ¤í…œ ì•„í‚¤í…ì²˜, ê¸°ìˆ  ìŠ¤íƒ, Hook Composition íŒ¨í„´, Co-location êµ¬ì¡°ë¥¼ ìƒì„¸íˆ ì„¤ëª…í•©ë‹ˆë‹¤.</p>
<hr />
<h2>ğŸ—ï¸ 1. ì „ì²´ ì‹œìŠ¤í…œ ì•„í‚¤í…ì²˜</h2>
<h3>1.1. ì „ì²´ ì‹œìŠ¤í…œ êµ¬ì¡°</h3>
<div class="mermaid">
graph TB
    User[ğŸ‘¤ ì‚¬ìš©ì<br/>Desktop / Mobile] --> Frontend[ğŸŒ Frontend Layer]
    Frontend --> Next[Next.js 14 App Router]
    Frontend --> Hooks[Hook Composition]
    Frontend --> CSS[CSS Modules]

    Next --> ClientComp[Client Components]
    Next --> ServerComp[Server Components]
    Next --> APIRoute[API Routes]

    Frontend --> Supabase[â˜ï¸ Supabase BaaS]
    Frontend --> FastAPI[ğŸ FastAPI AI Server]
    Frontend --> KakaoAPI[ğŸ—ºï¸ Kakao Map API]
    Frontend --> LLM[ğŸ¤– LLM APIs]

    Supabase --> PostgreSQL[(ğŸ˜ PostgreSQL<br/>+ pgvector)]
    Supabase --> Auth[ğŸ” Supabase Auth<br/>JWT Tokens]
    Supabase --> Storage[ğŸ“¦ Supabase Storage<br/>S3 Compatible]
    Supabase --> Realtime[âš¡ Supabase Realtime<br/>WebSocket]

    FastAPI --> YOLO[ğŸ¤– YOLO Models]
    YOLO --> SkinModel[Skin Model<br/>í”¼ë¶€ ì§ˆí™˜ 6ì¢…]
    YOLO --> EyesModel[Eyes Model<br/>ì•ˆêµ¬ ì§ˆí™˜ 30ì¢…]
    YOLO --> HealthModel[Health Model<br/>ì „ì‹  ê±´ê°• 3ì¢…]

    PostgreSQL --> RAG[ğŸ§  RAG System<br/>pgvector]
    RAG --> HuggingFace[ğŸ¤— HuggingFace<br/>Embedding API]

    LLM --> GPT[OpenAI GPT-4]
    LLM --> Gemini[Google Gemini]
    LLM --> Claude[Anthropic Claude]

    style User fill:#E3F2FD
    style Frontend fill:#F3E5F5
    style Supabase fill:#E0F2F1
    style FastAPI fill:#FCE4EC
    style PostgreSQL fill:#FFF3E0
    style RAG fill:#E8EAF6

</div>

<h3>1.2. ë°ì´í„° íë¦„ (Data Flow)</h3>
<div class="mermaid">
sequenceDiagram
    participant User as ğŸ‘¤ ì‚¬ìš©ì
    participant Frontend as ğŸŒ Frontend
    participant Hooks as ğŸª Custom Hooks
    participant Supabase as â˜ï¸ Supabase
    participant DB as ğŸ˜ PostgreSQL
    participant Realtime as âš¡ Realtime
    participant FastAPI as ğŸ FastAPI

    User->>Frontend: 1. í˜ì´ì§€ ì ‘ì†
    Frontend->>Hooks: 2. useAuth(), usePlanner() í˜¸ì¶œ
    Hooks->>Supabase: 3. API ìš”ì²­ (fetch)
    Supabase->>DB: 4. SQL ì¿¼ë¦¬ (RLS ì ìš©)
    DB->>Supabase: 5. ë°ì´í„° ë°˜í™˜
    Supabase->>Hooks: 6. JSON ì‘ë‹µ
    Hooks->>Frontend: 7. ìƒíƒœ ì—…ë°ì´íŠ¸
    Frontend->>User: 8. UI ë Œë”ë§

    Note over User,FastAPI: âš¡ ì‹¤ì‹œê°„ ì—…ë°ì´íŠ¸ (Realtime)

    User->>Frontend: 9. ë°ì´í„° ì‘ì„± (ê²Œì‹œê¸€, ëŒ“ê¸€ ë“±)
    Frontend->>Hooks: 10. useOptimisticUpdate()
    Hooks->>Supabase: 11. INSERT/UPDATE
    Supabase->>DB: 12. íŠ¸ëœì­ì…˜ ì‹¤í–‰
    DB->>DB: 13. Trigger ë°œë™
    DB->>Realtime: 14. Broadcast Event
    Realtime->>Frontend: 15. ì‹¤ì‹œê°„ Push (WebSocket)
    Frontend->>User: 16. UI ì¦‰ì‹œ ì—…ë°ì´íŠ¸

    Note over User,FastAPI: ğŸ¤– AI ê±´ê°• ì§„ë‹¨ í”Œë¡œìš°

    User->>Frontend: 17. ì´ë¯¸ì§€ ì—…ë¡œë“œ
    Frontend->>Hooks: 18. useYoloUpload()
    Hooks->>FastAPI: 19. HTTP POST (/api/detect)
    FastAPI->>FastAPI: 20. ì´ë¯¸ì§€ ì „ì²˜ë¦¬
    FastAPI->>FastAPI: 21. YOLO ì¶”ë¡ 
    FastAPI->>Hooks: 22. ë¶„ì„ ê²°ê³¼ (JSON)
    Hooks->>Frontend: 23. ê²°ê³¼ ì‹œê°í™”
    Frontend->>User: 24. ë°”ìš´ë”© ë°•ìŠ¤ + ì‹ ë¢°ë„ í‘œì‹œ

</div>

<hr />
<h2>ğŸ”§ 2. ê¸°ìˆ  ìŠ¤íƒ (Tech Stack)</h2>
<h3>2.1. Frontend Stack</h3>
<table>
<thead>
<tr>
<th style="text-align: left;"><strong>Category</strong></th>
<th style="text-align: left;"><strong>Technology</strong></th>
<th style="text-align: center;"><strong>Version</strong></th>
<th style="text-align: left;"><strong>Purpose</strong></th>
</tr>
</thead>
<tbody>
<tr>
<td style="text-align: left;"><strong>Framework</strong></td>
<td style="text-align: left;">Next.js</td>
<td style="text-align: center;">14.2.x</td>
<td style="text-align: left;">App Router ê¸°ë°˜ í’€ìŠ¤íƒ React í”„ë ˆì„ì›Œí¬</td>
</tr>
<tr>
<td style="text-align: left;"><strong>Language</strong></td>
<td style="text-align: left;">TypeScript</td>
<td style="text-align: center;">5.x</td>
<td style="text-align: left;">íƒ€ì… ì•ˆì „ì„± í™•ë³´</td>
</tr>
<tr>
<td style="text-align: left;"><strong>Language</strong></td>
<td style="text-align: left;">JavaScript</td>
<td style="text-align: center;">ES6+</td>
<td style="text-align: left;">ë™ì  ë¡œì§ ë° ë¹ ë¥¸ í”„ë¡œí† íƒ€ì´í•‘</td>
</tr>
<tr>
<td style="text-align: left;"><strong>Styling</strong></td>
<td style="text-align: left;">CSS Modules</td>
<td style="text-align: center;">-</td>
<td style="text-align: left;">Co-location ê¸°ë°˜ ìŠ¤íƒ€ì¼ ê´€ë¦¬</td>
</tr>
<tr>
<td style="text-align: left;"><strong>Styling</strong></td>
<td style="text-align: left;">Tailwind CSS</td>
<td style="text-align: center;">3.x</td>
<td style="text-align: left;">ìœ í‹¸ë¦¬í‹° ìš°ì„  CSS í”„ë ˆì„ì›Œí¬</td>
</tr>
<tr>
<td style="text-align: left;"><strong>State</strong></td>
<td style="text-align: left;">React Hooks</td>
<td style="text-align: center;">-</td>
<td style="text-align: left;">Hook Composition íŒ¨í„´</td>
</tr>
<tr>
<td style="text-align: left;"><strong>HTTP Client</strong></td>
<td style="text-align: left;">fetch API</td>
<td style="text-align: center;">-</td>
<td style="text-align: left;">ë„¤ì´í‹°ë¸Œ ë¸Œë¼ìš°ì € API</td>
</tr>
</tbody>
</table>
<h3>2.2. Backend Stack (BaaS)</h3>
<table>
<thead>
<tr>
<th style="text-align: left;"><strong>Category</strong></th>
<th style="text-align: left;"><strong>Technology</strong></th>
<th style="text-align: center;"><strong>Version</strong></th>
<th style="text-align: left;"><strong>Purpose</strong></th>
</tr>
</thead>
<tbody>
<tr>
<td style="text-align: left;"><strong>BaaS</strong></td>
<td style="text-align: left;">Supabase</td>
<td style="text-align: center;">2.x</td>
<td style="text-align: left;">PostgreSQL + Auth + Storage + Realtime</td>
</tr>
<tr>
<td style="text-align: left;"><strong>Database</strong></td>
<td style="text-align: left;">PostgreSQL</td>
<td style="text-align: center;">15.x</td>
<td style="text-align: left;">ê´€ê³„í˜• ë°ì´í„°ë² ì´ìŠ¤</td>
</tr>
<tr>
<td style="text-align: left;"><strong>Auth</strong></td>
<td style="text-align: left;">Supabase Auth</td>
<td style="text-align: center;">-</td>
<td style="text-align: left;">JWT ê¸°ë°˜ ì¸ì¦ ì‹œìŠ¤í…œ</td>
</tr>
<tr>
<td style="text-align: left;"><strong>Storage</strong></td>
<td style="text-align: left;">Supabase Storage</td>
<td style="text-align: center;">-</td>
<td style="text-align: left;">ì´ë¯¸ì§€/íŒŒì¼ ìŠ¤í† ë¦¬ì§€ (S3 í˜¸í™˜)</td>
</tr>
<tr>
<td style="text-align: left;"><strong>Realtime</strong></td>
<td style="text-align: left;">Supabase Realtime</td>
<td style="text-align: center;">-</td>
<td style="text-align: left;">WebSocket ê¸°ë°˜ ì‹¤ì‹œê°„ êµ¬ë…</td>
</tr>
<tr>
<td style="text-align: left;"><strong>Vector DB</strong></td>
<td style="text-align: left;">pgvector</td>
<td style="text-align: center;">0.5.x</td>
<td style="text-align: left;">ë²¡í„° ê²€ìƒ‰ (RAG ì‹œìŠ¤í…œ)</td>
</tr>
</tbody>
</table>
<h3>2.3. AI Server Stack</h3>
<table>
<thead>
<tr>
<th style="text-align: left;"><strong>Category</strong></th>
<th style="text-align: left;"><strong>Technology</strong></th>
<th style="text-align: center;"><strong>Version</strong></th>
<th style="text-align: left;"><strong>Purpose</strong></th>
</tr>
</thead>
<tbody>
<tr>
<td style="text-align: left;"><strong>Framework</strong></td>
<td style="text-align: left;">FastAPI</td>
<td style="text-align: center;">0.104.x</td>
<td style="text-align: left;">ê³ ì„±ëŠ¥ Python API í”„ë ˆì„ì›Œí¬</td>
</tr>
<tr>
<td style="text-align: left;"><strong>Language</strong></td>
<td style="text-align: left;">Python</td>
<td style="text-align: center;">3.10.x</td>
<td style="text-align: left;">AI/ML ê°œë°œ ì–¸ì–´</td>
</tr>
<tr>
<td style="text-align: left;"><strong>AI Model</strong></td>
<td style="text-align: left;">YOLOv8</td>
<td style="text-align: center;">8.0.x</td>
<td style="text-align: left;">ê°ì²´ íƒì§€ (Ultralytics)</td>
</tr>
<tr>
<td style="text-align: left;"><strong>CV Library</strong></td>
<td style="text-align: left;">OpenCV</td>
<td style="text-align: center;">4.8.x</td>
<td style="text-align: left;">ì´ë¯¸ì§€ ì²˜ë¦¬</td>
</tr>
<tr>
<td style="text-align: left;"><strong>GPU</strong></td>
<td style="text-align: left;">CUDA</td>
<td style="text-align: center;">12.1</td>
<td style="text-align: left;">NVIDIA GPU ê°€ì† (RTX 4060)</td>
</tr>
<tr>
<td style="text-align: left;"><strong>Embedding</strong></td>
<td style="text-align: left;">HuggingFace</td>
<td style="text-align: center;">4.x</td>
<td style="text-align: left;">sentence-transformers</td>
</tr>
</tbody>
</table>
<h3>2.4. External APIs</h3>
<table>
<thead>
<tr>
<th style="text-align: left;"><strong>Service</strong></th>
<th style="text-align: left;"><strong>Purpose</strong></th>
<th style="text-align: left;"><strong>ì‚¬ìš© ìœ„ì¹˜</strong></th>
</tr>
</thead>
<tbody>
<tr>
<td style="text-align: left;"><strong>Kakao Map API</strong></td>
<td style="text-align: left;">ì£¼ë³€ ë™ë¬¼ë³‘ì›/ì•½êµ­ ê²€ìƒ‰</td>
<td style="text-align: left;">AI Assistant, Hospital</td>
</tr>
<tr>
<td style="text-align: left;"><strong>OpenAI GPT-4</strong></td>
<td style="text-align: left;">AI ì±—ë´‡ (ë©€í‹° LLM ì§€ì›)</td>
<td style="text-align: left;">AI Assistant</td>
</tr>
<tr>
<td style="text-align: left;"><strong>Google Gemini</strong></td>
<td style="text-align: left;">AI ì±—ë´‡ (ë©€í‹° LLM ì§€ì›)</td>
<td style="text-align: left;">AI Assistant</td>
</tr>
<tr>
<td style="text-align: left;"><strong>Anthropic Claude</strong></td>
<td style="text-align: left;">AI ì±—ë´‡ (ë©€í‹° LLM ì§€ì›)</td>
<td style="text-align: left;">AI Assistant</td>
</tr>
</tbody>
</table>
<hr />
<h2>ğŸ›ï¸ 3. Hook Composition ì•„í‚¤í…ì²˜ â­â­â­</h2>
<h3>3.1. Hook Composition ê°œë…</h3>
<div class="mermaid">
graph LR
    A[í° ê¸°ëŠ¥] --> B[ë§ˆìŠ¤í„° í›…]
    B --> C[ì „ë¬¸ í›… 1]
    B --> D[ì „ë¬¸ í›… 2]
    B --> E[ì „ë¬¸ í›… 3]

    C --> F[API í†µì‹ ]
    D --> G[ìƒíƒœ ê´€ë¦¬]
    E --> H[ìœ íš¨ì„± ê²€ì‚¬]

    style A fill:#E3F2FD
    style B fill:#F3E5F5
    style C fill:#FFF3E0
    style D fill:#FFF3E0
    style E fill:#FFF3E0
    style F fill:#E8F5E9
    style G fill:#E8F5E9
    style H fill:#E8F5E9

</div>

<p><strong>ì „í†µì  ë°©ì‹ (âŒ ë‚˜ìœ ì˜ˆ)</strong>:</p>
<pre><code>ğŸ“ Planner/
â”œâ”€â”€ page.tsx (700ì¤„)  âŒ í•˜ë‚˜ì˜ ê±°ëŒ€í•œ ì»´í¬ë„ŒíŠ¸
â””â”€â”€ planner.css
</code></pre>
<p><strong>Hook Composition ë°©ì‹ (âœ… ì¢‹ì€ ì˜ˆ)</strong>:</p>
<pre><code>ğŸ“ Planner/
â”œâ”€â”€ page.tsx (165ì¤„)  âœ… ë§ˆìŠ¤í„° ì»´í¬ë„ŒíŠ¸ (ì‘ê³  ëª…í™•)
â”œâ”€â”€ hooks/
â”‚   â”œâ”€â”€ usePlanner.js  âœ… í”Œë˜ë„ˆ ì „ë¬¸ í›…
â”‚   â”œâ”€â”€ useCalendar.js  âœ… ë‹¬ë ¥ ì „ë¬¸ í›…
â”‚   â”œâ”€â”€ useEvents.js  âœ… ì´ë²¤íŠ¸ ì „ë¬¸ í›…
â”‚   â””â”€â”€ useExpenses.js  âœ… ì§€ì¶œ ì „ë¬¸ í›…
â””â”€â”€ _components/
    â”œâ”€â”€ Calendar/
    â”œâ”€â”€ EventListSection/
    â””â”€â”€ Wallet/
</code></pre>
<h3>3.2. Hook ì „ë¬¸í™” í´ë” êµ¬ì¡° (ìµœì¢… ì™„ì„±)</h3>
<pre><code>ğŸ“¦ frontend/src/hooks/
â”œâ”€â”€ ğŸ“‚ auth/                      # ì¸ì¦ ê´€ë ¨ ì „ë¬¸ í›…ë“¤
â”‚   â”œâ”€â”€ useAuth.js                # ë¡œê·¸ì¸/ë¡œê·¸ì•„ì›ƒ ì „ë¬¸ê°€
â”‚   â”œâ”€â”€ useSignup.js              # íšŒì›ê°€ì… ì „ë¬¸ê°€
â”‚   â””â”€â”€ usePasswordReset.js       # ë¹„ë°€ë²ˆí˜¸ ì¬ì„¤ì • ì „ë¬¸ê°€
â”‚
â”œâ”€â”€ ğŸ“‚ aiassistant/               # AI ì–´ì‹œìŠ¤í„´íŠ¸ ì „ë¬¸ í›…ë“¤
â”‚   â”œâ”€â”€ useYoloDetection.js       # YOLO ë¶„ì„ ì „ë¬¸ê°€
â”‚   â”œâ”€â”€ useImageUpload.js         # ì´ë¯¸ì§€ ì—…ë¡œë“œ ì „ë¬¸ê°€
â”‚   â”œâ”€â”€ useAIChat.js              # AI ì±—ë´‡ ì „ë¬¸ê°€
â”‚   â””â”€â”€ useRAGSearch.js           # RAG ê²€ìƒ‰ ì „ë¬¸ê°€ â­
â”‚
â”œâ”€â”€ ğŸ“‚ planner/                   # í”Œë˜ë„ˆ ì „ë¬¸ í›…ë“¤
â”‚   â”œâ”€â”€ usePlanner.js             # ë§ˆìŠ¤í„° í”Œë˜ë„ˆ í›…
â”‚   â”œâ”€â”€ useCalendar.js            # ë‹¬ë ¥ ì „ë¬¸ê°€
â”‚   â”œâ”€â”€ useEvents.js              # ì´ë²¤íŠ¸ CRUD ì „ë¬¸ê°€
â”‚   â”œâ”€â”€ useExpenses.js            # ì§€ì¶œ CRUD ì „ë¬¸ê°€
â”‚   â””â”€â”€ vaccination/
â”‚       â”œâ”€â”€ useVaccinationManager.js         # ë°±ì‹  ê´€ë¦¬ ì „ë¬¸ê°€
â”‚       â””â”€â”€ useVaccinationModeManager.js     # ë°±ì‹  ëª¨ë“œ ì „í™˜ ì „ë¬¸ê°€
â”‚
â”œâ”€â”€ ğŸ“‚ community/                 # ì»¤ë®¤ë‹ˆí‹° ì „ë¬¸ í›…ë“¤
â”‚   â”œâ”€â”€ useCommunityPosts.js      # ê²Œì‹œê¸€ CRUD ì „ë¬¸ê°€
â”‚   â”œâ”€â”€ useRealtimeComments.js    # ì‹¤ì‹œê°„ ëŒ“ê¸€ ì „ë¬¸ê°€ â­
â”‚   â”œâ”€â”€ useLikes.js               # ì¢‹ì•„ìš” ì „ë¬¸ê°€
â”‚   â””â”€â”€ useHashtagInput.js        # í•´ì‹œíƒœê·¸ ì…ë ¥ ì „ë¬¸ê°€
â”‚
â”œâ”€â”€ ğŸ“‚ lifestyle/                 # ë¼ì´í”„ìŠ¤íƒ€ì¼ ì „ë¬¸ í›…ë“¤
â”‚   â””â”€â”€ realtime/
â”‚       â”œâ”€â”€ useLifestyleChat.js          # ì±„íŒ… ë©”ì‹œì§€ ê´€ë¦¬ â­â­â­
â”‚       â”œâ”€â”€ useLifestyleChatRooms.js     # ì±„íŒ…ë°© ê´€ë¦¬ â­â­â­
â”‚       â”œâ”€â”€ useRealtimeChat.js           # ì‹¤ì‹œê°„ êµ¬ë… â­â­â­
â”‚       â”œâ”€â”€ useParticipants.js           # ì°¸ì—¬ì ê´€ë¦¬ â­â­â­
â”‚       â””â”€â”€ useImageUpload.js            # ì´ë¯¸ì§€ ì—…ë¡œë“œ â­â­â­
â”‚
â”œâ”€â”€ ğŸ“‚ profile/                   # í”„ë¡œí•„ ê´€ë¦¬ ì „ë¬¸ í›…ë“¤
â”‚   â”œâ”€â”€ useProfile.js             # ì‚¬ìš©ì í”„ë¡œí•„ ì „ë¬¸ê°€
â”‚   â”œâ”€â”€ usePalProfile.js          # ë°˜ë ¤ë™ë¬¼ í”„ë¡œí•„ ì „ë¬¸ê°€
â”‚   â””â”€â”€ useGallery.js             # ê°¤ëŸ¬ë¦¬ ì „ë¬¸ê°€
â”‚
â”œâ”€â”€ ğŸ“‚ pet-registration/          # ë°˜ë ¤ë™ë¬¼ ë“±ë¡ ì „ë¬¸ í›…ë“¤ â­â­
â”‚   â”œâ”€â”€ usePetAPI.js              # API í†µì‹  ì „ë¬¸ê°€
â”‚   â”œâ”€â”€ usePetFormState.js        # í¼ ìƒíƒœ ê´€ë¦¬ ì „ë¬¸ê°€
â”‚   â”œâ”€â”€ usePetValidation.js       # ìœ íš¨ì„± ê²€ì‚¬ ì „ë¬¸ê°€
â”‚   â””â”€â”€ usePetRegistration.js     # ë§ˆìŠ¤í„° í†µí•© Hook
â”‚
â”œâ”€â”€ ğŸ“‚ hashtag/                   # í•´ì‹œíƒœê·¸ ìë™ì™„ì„±
â”‚   â””â”€â”€ useHashtagAutocomplete.js # ì‹¤ì‹œê°„ ì¸ê¸° í•´ì‹œíƒœê·¸ ì¡°íšŒ â­
â”‚
â”œâ”€â”€ ğŸ“‚ maps/                      # Kakao Maps í†µí•©
â”‚   â””â”€â”€ useHospitalSearch.ts      # ë³‘ì› ê²€ìƒ‰ ì „ë¬¸ê°€
â”‚
â””â”€â”€ ğŸ“‚ shared/                    # ê³µìš© ì¬ì‚¬ìš© í›…ë“¤
    â”œâ”€â”€ useGlobalHashtags.js      # í†µí•© í•´ì‹œíƒœê·¸ ì‹œìŠ¤í…œ â­â­
    â”œâ”€â”€ useSupabase.js            # Supabase í´ë¼ì´ì–¸íŠ¸
    â””â”€â”€ useFileUpload.js          # íŒŒì¼ ì—…ë¡œë“œ ê³µí†µ
</code></pre>
<h3>3.3. Hook Composition ì„±ê³¼</h3>
<table>
<thead>
<tr>
<th style="text-align: left;"><strong>íŒŒì¼ëª…</strong></th>
<th style="text-align: right;"><strong>Before</strong></th>
<th style="text-align: right;"><strong>After</strong></th>
<th style="text-align: right;"><strong>ê°ì†Œìœ¨</strong></th>
</tr>
</thead>
<tbody>
<tr>
<td style="text-align: left;"><strong>FeedDetailModal</strong></td>
<td style="text-align: right;">528ì¤„</td>
<td style="text-align: right;">231ì¤„</td>
<td style="text-align: right;"><strong>56%</strong></td>
</tr>
<tr>
<td style="text-align: left;"><strong>useCommunityPosts</strong></td>
<td style="text-align: right;">386ì¤„</td>
<td style="text-align: right;">128ì¤„</td>
<td style="text-align: right;"><strong>67%</strong></td>
</tr>
<tr>
<td style="text-align: left;"><strong>EventListSection</strong></td>
<td style="text-align: right;">303ì¤„</td>
<td style="text-align: right;">117ì¤„</td>
<td style="text-align: right;"><strong>61%</strong></td>
</tr>
<tr>
<td style="text-align: left;"><strong>useRealtimeComments</strong></td>
<td style="text-align: right;">310ì¤„</td>
<td style="text-align: right;">238ì¤„</td>
<td style="text-align: right;"><strong>23%</strong></td>
</tr>
<tr>
<td style="text-align: left;"><strong>FeedCard</strong></td>
<td style="text-align: right;">561ì¤„</td>
<td style="text-align: right;">160ì¤„</td>
<td style="text-align: right;"><strong>71%</strong></td>
</tr>
<tr>
<td style="text-align: left;"><strong>usePlanner</strong></td>
<td style="text-align: right;">676ì¤„</td>
<td style="text-align: right;">165ì¤„</td>
<td style="text-align: right;"><strong>75%</strong></td>
</tr>
</tbody>
</table>
<p><strong>í‰ê·  ì½”ë“œ ì¶•ì†Œìœ¨</strong>: <strong>60%</strong> âœ…</p>
<hr />
<h2>ğŸ“ 4. Co-location ì•„í‚¤í…ì²˜ (App Router ê¸°ë°˜)</h2>
<h3>4.1. Co-location ê°œë…</h3>
<blockquote>
<p><strong>"ê¸°ëŠ¥ì— í•„ìš”í•œ ëª¨ë“  íŒŒì¼ì„ í•˜ë‚˜ì˜ í´ë”ì— ëª¨ì•„ ì™„ì „í•œ ë…ë¦½ì„±ì„ í™•ë³´"</strong></p>
</blockquote>
<div class="mermaid">
graph TB
    Feature[Feature Folder] --> Component[Component Files]
    Feature --> Hooks[Custom Hooks]
    Feature --> CSS[CSS Modules]
    Feature --> Utils[Utility Functions]

    Component --> JSX[index.jsx]
    Hooks --> Hook1[useFeature.js]
    CSS --> Style[feature.module.css]
    Utils --> Util[helper.js]

    style Feature fill:#E3F2FD
    style Component fill:#F3E5F5
    style Hooks fill:#FFF3E0
    style CSS fill:#E8F5E9
    style Utils fill:#FCE4EC

</div>

<p><strong>ì „í†µì  ë°©ì‹ (âŒ ë‚˜ìœ ì˜ˆ)</strong>:</p>
<pre><code>ğŸ“ src/
â”œâ”€â”€ components/
â”‚   â”œâ”€â”€ Calendar.tsx
â”‚   â”œâ”€â”€ EventList.tsx
â”‚   â””â”€â”€ Wallet.tsx
â”œâ”€â”€ hooks/
â”‚   â”œâ”€â”€ useCalendar.js
â”‚   â”œâ”€â”€ useEvents.js
â”‚   â””â”€â”€ useExpenses.js
â””â”€â”€ styles/
    â”œâ”€â”€ calendar.css
    â”œâ”€â”€ eventList.css
    â””â”€â”€ wallet.css
</code></pre>
<p><strong>Co-location ë°©ì‹ (âœ… ì¢‹ì€ ì˜ˆ)</strong>:</p>
<pre><code>ğŸ“ Planner/
â”œâ”€â”€ page.tsx
â”œâ”€â”€ hooks/
â”‚   â”œâ”€â”€ usePlanner.js
â”‚   â””â”€â”€ useCalendar.js
â”œâ”€â”€ _components/
â”‚   â”œâ”€â”€ Calendar/
â”‚   â”‚   â”œâ”€â”€ index.jsx
â”‚   â”‚   â”œâ”€â”€ CalendarView.jsx
â”‚   â”‚   â””â”€â”€ calendarview.module.css  âœ… ê°™ì€ í´ë”!
â”‚   â”œâ”€â”€ EventListSection/
â”‚   â”‚   â”œâ”€â”€ index.jsx
â”‚   â”‚   â””â”€â”€ eventlistsection.module.css  âœ… ê°™ì€ í´ë”!
â”‚   â””â”€â”€ Wallet/
â”‚       â”œâ”€â”€ index.jsx
â”‚       â””â”€â”€ wallet.module.css  âœ… ê°™ì€ í´ë”!
â””â”€â”€ planner.module.css
</code></pre>
<h3>4.2. ì „ì²´ í´ë” êµ¬ì¡° (2025-11-13 ê¸°ì¤€)</h3>
<pre><code>ğŸ“ frontend/src/app/
â”œâ”€â”€ ğŸ“ main/                              # ì¸ì¦ í›„ ë©”ì¸ ê¸°ëŠ¥ë“¤
â”‚   â”œâ”€â”€ ğŸ“ HomePage/                      # ë©”ì¸ ëŒ€ì‹œë³´ë“œ
â”‚   â”‚   â”œâ”€â”€ homepage.module.css
â”‚   â”‚   â”œâ”€â”€ leftPanel/
â”‚   â”‚   â”œâ”€â”€ quickActionsBar/
â”‚   â”‚   â””â”€â”€ rightPanel/
â”‚   â”‚
â”‚   â”œâ”€â”€ ğŸ“ aiassistant/                   # AI ì§„ë‹¨ + RAG ì±—ë´‡ â­â­â­
â”‚   â”‚   â”œâ”€â”€ page.tsx
â”‚   â”‚   â”œâ”€â”€ aiassistant.module.css
â”‚   â”‚   â””â”€â”€ _components/
â”‚   â”‚       â”œâ”€â”€ LeftPanel/               # ì´ë¯¸ì§€ ì—…ë¡œë“œ + ê²°ê³¼
â”‚   â”‚       â”œâ”€â”€ RightPanel/              # AI ì±—ë´‡ + RAG ê²€ìƒ‰
â”‚   â”‚       â”œâ”€â”€ PetHospital/             # ë³‘ì› ì°¾ê¸° (Kakao Map)
â”‚   â”‚       â””â”€â”€ HashtagSuggestions/      # í•´ì‹œíƒœê·¸ ìë™ì™„ì„±
â”‚   â”‚
â”‚   â”œâ”€â”€ ğŸ“ planner/                       # ì¼ì • + ê°€ê³„ë¶€ ê´€ë¦¬ â­â­
â”‚   â”‚   â”œâ”€â”€ page.tsx
â”‚   â”‚   â”œâ”€â”€ planner.module.css
â”‚   â”‚   â”œâ”€â”€ hooks/
â”‚   â”‚   â”‚   â””â”€â”€ vaccination/
â”‚   â”‚   â”œâ”€â”€ lib/
â”‚   â”‚   â”‚   â””â”€â”€ vaccination/
â”‚   â”‚   â””â”€â”€ _components/
â”‚   â”‚       â”œâ”€â”€ Calendar/                # ì»¤ìŠ¤í…€ ë‹¬ë ¥ (ë“œë˜ê·¸ì•¤ë“œë¡­)
â”‚   â”‚       â”œâ”€â”€ EventListSection/        # ì¼ì • ëª©ë¡
â”‚   â”‚       â”œâ”€â”€ Wallet/                  # ê°€ê³„ë¶€
â”‚   â”‚       â”œâ”€â”€ palVaccination/          # ë°±ì‹  ê´€ë¦¬
â”‚   â”‚       â””â”€â”€ PlannerSmartPanel/       # ìŠ¤ë§ˆíŠ¸ íŒ¨ë„
â”‚   â”‚
â”‚   â”œâ”€â”€ ğŸ“ community/                     # ì†Œì…œ ì»¤ë®¤ë‹ˆí‹° â­â­
â”‚   â”‚   â”œâ”€â”€ page.tsx
â”‚   â”‚   â”œâ”€â”€ community.module.css
â”‚   â”‚   â””â”€â”€ _components/
â”‚   â”‚       â”œâ”€â”€ PostTab/                 # ê²Œì‹œê¸€ í”¼ë“œ
â”‚   â”‚       â””â”€â”€ shared/                  # ê³µìœ  ì»´í¬ë„ŒíŠ¸
â”‚   â”‚
â”‚   â”œâ”€â”€ ğŸ“ lifestyle/                     # ì‹¤ì‹œê°„ ì±„íŒ… â­â­â­
â”‚   â”‚   â”œâ”€â”€ page.tsx
â”‚   â”‚   â”œâ”€â”€ lifestyle.module.css
â”‚   â”‚   â””â”€â”€ _components/
â”‚   â”‚       â”œâ”€â”€ lifestyle.module.css
â”‚   â”‚       â””â”€â”€ RealtimeChat/            # ì±„íŒ… ì‹œìŠ¤í…œ
â”‚   â”‚           â”œâ”€â”€ index.tsx
â”‚   â”‚           â”œâ”€â”€ realtimechat.module.css
â”‚   â”‚           â””â”€â”€ components/
â”‚   â”‚               â”œâ”€â”€ BookmarkTabs/    # ë¶ë§ˆí¬ íƒ­
â”‚   â”‚               â”œâ”€â”€ ChatRoom/        # ì±„íŒ…ë£¸
â”‚   â”‚               â”œâ”€â”€ HashtagRooms/    # í•´ì‹œíƒœê·¸ ë°© ëª©ë¡
â”‚   â”‚               â”œâ”€â”€ ParticipantsDropdown/
â”‚   â”‚               â””â”€â”€ MoreMenu/
â”‚   â”‚
â”‚   â””â”€â”€ page.tsx                          # ë©”ì¸ ë¼ìš°íŠ¸
â”‚
â”œâ”€â”€ ğŸ“ mypage/                            # í”„ë¡œí•„ + ë°˜ë ¤ë™ë¬¼ ê´€ë¦¬
â”‚   â”œâ”€â”€ page.tsx
â”‚   â””â”€â”€ _components/
â”‚
â”œâ”€â”€ ğŸ“ settings/                          # ì„¤ì • í˜ì´ì§€
â”‚   â”œâ”€â”€ page.tsx
â”‚   â””â”€â”€ _components/
â”‚       â””â”€â”€ hooks/
â”‚           â””â”€â”€ useAppActions.js          # íšŒì›íƒˆí‡´ ë¡œì§ í¬í•¨ â­
â”‚
â”œâ”€â”€ ğŸ“ login/                             # ë¡œê·¸ì¸ í˜ì´ì§€
â”œâ”€â”€ ğŸ“ signup/                            # íšŒì›ê°€ì… í˜ì´ì§€
â”œâ”€â”€ ğŸ“ forgotpass/                        # ë¹„ë°€ë²ˆí˜¸ ì°¾ê¸°
â”‚
â””â”€â”€ ğŸ“ api/                               # ì„œë²„ì‚¬ì´ë“œ API ì—”ë“œí¬ì¸íŠ¸
    â”œâ”€â”€ ai/                               # RAG + ì„ë² ë”© + ì§€ì‹ ê²€ìƒ‰
    â”œâ”€â”€ community/                        # ê²Œì‹œê¸€ + ì¢‹ì•„ìš” + ëŒ“ê¸€
    â”œâ”€â”€ health/                           # YOLO ì§ˆí™˜ ê°ì§€
    â”œâ”€â”€ planner/                          # ì¼ì • + ë°±ì‹  ë™ê¸°í™”
    â”œâ”€â”€ profile/                          # ì‚¬ìš©ì + ë°˜ë ¤ë™ë¬¼ ê´€ë¦¬
    â”œâ”€â”€ vaccinations/                     # ë°±ì‹  ìƒì„± + ê´€ë¦¬
    â”œâ”€â”€ hashtags/                         # í•´ì‹œíƒœê·¸ ìë™ì™„ì„±
    â””â”€â”€ cron/                             # ìë™ ì„ë² ë”© ìƒì„±
</code></pre>
<hr />
<h2>ğŸ¨ 5. CSS ì•„í‚¤í…ì²˜ &amp; BEM ë„¤ì´ë°</h2>
<h3>5.1. CSS ëª¨ë“ˆ Co-location íŒ¨í„´</h3>
<pre><code>ğŸ“ ComponentName/
â”œâ”€â”€ index.jsx                    # ì»´í¬ë„ŒíŠ¸ ë¡œì§
â”œâ”€â”€ componentname.module.css     # ì „ìš© ìŠ¤íƒ€ì¼ â­ (ì†Œë¬¸ì + camelCase)
â”œâ”€â”€ hooks/                       # ì»´í¬ë„ŒíŠ¸ ì „ìš© í›… (ì„ íƒ)
â”œâ”€â”€ utils/                       # ìœ í‹¸ë¦¬í‹° í•¨ìˆ˜ (ì„ íƒ)
â””â”€â”€ components/                  # í•˜ìœ„ ì»´í¬ë„ŒíŠ¸ (ì„ íƒ)
</code></pre>
<p><strong>ì˜ˆì‹œ</strong>:</p>
<pre><code>ğŸ“ ChatRoom/
â”œâ”€â”€ index.tsx
â”œâ”€â”€ chatroom.module.css          # â­ ì»´í¬ë„ŒíŠ¸ëª….module.css
â”œâ”€â”€ hooks/
â”‚   â””â”€â”€ useChatRoom.js
â””â”€â”€ components/
    â”œâ”€â”€ MessageBubble.tsx
    â””â”€â”€ InputArea.tsx
</code></pre>
<h3>5.2. BEM ë„¤ì´ë° íŒ¨í„´</h3>
<pre><code class="language-css">/* Block (ë¸”ë¡) */
.LifestyleChat_ChatRoom_Container {
  display: flex;
  flex-direction: column;
}

/* Element (ìš”ì†Œ) */
.LifestyleChat_ChatRoom_MessagesContainer {
  flex: 1;
  overflow-y: auto;
}

/* Modifier (ìˆ˜ì •ì) */
.LifestyleChat_ChatRoom_MessageBubble--mine {
  background: #dcf8c6;
  align-self: flex-end;
}

.LifestyleChat_ChatRoom_MessageBubble--other {
  background: #ffffff;
  align-self: flex-start;
}
</code></pre>
<p><strong>ë„¤ì´ë° ê·œì¹™</strong>:<br />
- <strong>Block</strong>: <code>.ê¸°ëŠ¥_ë¸”ë¡ëª…</code><br />
- <strong>Element</strong>: <code>.ê¸°ëŠ¥_ë¸”ë¡ëª…_ìš”ì†Œëª…</code><br />
- <strong>Modifier</strong>: <code>.ê¸°ëŠ¥_ë¸”ë¡ëª…_ìš”ì†Œëª…--ìˆ˜ì •ì</code></p>
<h3>5.3. ë°˜ì‘í˜• CSS (4ë‹¨ê³„ ë¸Œë ˆì´í¬í¬ì¸íŠ¸)</h3>
<pre><code class="language-css">/* ğŸ’» Desktop (ê¸°ë³¸) - 1281px ì´ìƒ */
.element {
  font-size: 1rem;
  padding: 16px;
  gap: 12px;
}

/* ğŸ’» ì¤‘í˜• (1280px ì´í•˜) - 10% ì¶•ì†Œ */
@media (max-width: 1280px) {
  .element {
    font-size: 0.9375rem;
    padding: 14px;
    gap: 10px;
  }
}

/* ğŸ“± ì†Œí˜• (900px ì´í•˜) - 20% ì¶•ì†Œ */
@media (max-width: 900px) {
  .element {
    font-size: 0.875rem;
    padding: 12px;
    gap: 8px;
  }
}

/* ğŸ“± ëª¨ë°”ì¼ (768px ì´í•˜) - ì„¸ë¡œ ë°°ì¹˜ */
@media (max-width: 768px) {
  .element {
    flex-direction: column;
    width: 100%;
    font-size: 0.8125rem;
    padding: 10px;
    gap: 6px;
  }
}

/* ğŸ“± ì´ˆì†Œí˜• (400px ì´í•˜) - ìµœì†Œí™” */
@media (max-width: 400px) {
  .element {
    font-size: 0.75rem;
    padding: 8px;
    gap: 4px;
  }
}
</code></pre>
<hr />
<h2>ğŸ—„ï¸ 6. ë°ì´í„°ë² ì´ìŠ¤ ì•„í‚¤í…ì²˜ (PostgreSQL + pgvector)</h2>
<h3>6.1. ì£¼ìš” í…Œì´ë¸” êµ¬ì¡°</h3>
<div class="mermaid">
erDiagram
    AUTH_USERS ||--|| PROFILES : "1:1"
    PROFILES ||--o{ PAL_PROFILES : "1:N"
    PAL_PROFILES ||--o{ PAL_VACCINATIONS : "1:N"
    PAL_PROFILES ||--o{ PAL_HEALTH_RECORDS : "1:N"

    PROFILES ||--o{ COMMUNITY_POSTS : "1:N"
    COMMUNITY_POSTS ||--o{ POST_COMMENTS : "1:N"
    COMMUNITY_POSTS ||--o{ POST_LIKES : "1:N"

    PROFILES ||--o{ PLANNER_EVENTS : "1:N"
    PROFILES ||--o{ PLANNER_EXPENSES : "1:N"

    PROFILES ||--o{ LIFESTYLE_CHAT_ROOMS : "1:N"
    LIFESTYLE_CHAT_ROOMS ||--o{ LIFESTYLE_CHAT_MESSAGES : "1:N"

    GLOBAL_HASHTAGS ||--o{ COMMUNITY_POST_HASHTAGS : "1:N"
    GLOBAL_HASHTAGS ||--o{ PLANNER_EVENT_HASHTAGS : "1:N"
    GLOBAL_HASHTAGS ||--o{ LIFESTYLE_CHAT_MESSAGE_HASHTAGS : "1:N"

    COMMUNITY_POSTS ||--o{ PET_KNOWLEDGE_BASE : "1:N"

    AUTH_USERS {
        uuid id PK
        string email
        string encrypted_password
        timestamp created_at
    }

    PROFILES {
        uuid id PK
        string displayName
        string avatarUrl
        boolean profileComplete
    }

    PAL_PROFILES {
        uuid palId PK
        uuid userId FK
        string palName
        date palBirthdate
        string palBreed
        boolean isPrimary
    }

    PAL_VACCINATIONS {
        uuid id PK
        uuid palId FK
        int vaccinationTypeId
        date scheduledDate
        boolean isCompleted
    }

    COMMUNITY_POSTS {
        uuid id PK
        uuid userId FK
        string title
        text content
        int likesCount
    }

    GLOBAL_HASHTAGS {
        serial id PK
        text tagName
        int usageCount
        text primaryCategory
    }

    PET_KNOWLEDGE_BASE {
        uuid id PK
        text content
        vector embedding
        text source
        numeric quality_score
        boolean is_verified
    }

    LIFESTYLE_CHAT_ROOMS {
        uuid roomid PK
        text roomtype
        text hashtagname
    }

    LIFESTYLE_CHAT_MESSAGES {
        uuid id PK
        uuid roomid FK
        uuid userid FK
        text content
    }

</div>

<h3>6.2. ì»¤ë®¤ë‹ˆí‹° &amp; í•´ì‹œíƒœê·¸ ì‹œìŠ¤í…œ</h3>
<div class="mermaid">
graph TB
    Posts[communityPosts] --> Comments[postcomments]
    Posts --> Likes[postlikes]
    Posts --> PostHashtags[communityPostHashtags]

    GlobalHashtags[globalHashtags] --> PostHashtags
    GlobalHashtags --> EventHashtags[plannerEventHashtags]
    GlobalHashtags --> MessageHashtags[lifestylechatmessagehashtags]

    Events[plannerEvents] --> EventHashtags
    Messages[lifestylechatmessages] --> MessageHashtags

    Posts --> RAG[pet_knowledge_base]

    style Posts fill:#FFB74D
    style GlobalHashtags fill:#66BB6A
    style RAG fill:#BA68C8

</div>

<h3>6.3. RAG ì‹œìŠ¤í…œ (pgvector) â­â­â­</h3>
<pre><code class="language-sql">CREATE TABLE pet_knowledge_base (
  id UUID PRIMARY KEY DEFAULT uuid_generate_v4(),
  content TEXT NOT NULL,
  embedding VECTOR(384),  -- HuggingFace 384ì°¨ì› ë²¡í„°
  source TEXT CHECK (source IN ('community', 'faq', 'youtube', 'manual')),
  source_url TEXT,
  quality_score NUMERIC(3,2) CHECK (quality_score &gt;= 0 AND quality_score &lt;= 1),
  is_verified BOOLEAN DEFAULT FALSE,
  metadata JSONB,
  created_at TIMESTAMP WITH TIME ZONE DEFAULT TIMEZONE('utc', NOW()),
  updated_at TIMESTAMP WITH TIME ZONE DEFAULT TIMEZONE('utc', NOW())
);

-- Vector Similarity Search Index
CREATE INDEX ON pet_knowledge_base USING ivfflat (embedding vector_cosine_ops);
</code></pre>
<hr />
<h2>ğŸ” 7. ë³´ì•ˆ ì•„í‚¤í…ì²˜ (Supabase ë³´ì•ˆ ì •ì±… ê¸°ë°˜)</h2>
<h3>7.1. Row Level Security (RLS) ì •ì±…</h3>
<pre><code class="language-sql">-- âœ… ì˜¬ë°”ë¥¸ RLS ì •ì±… (Function Search Path ê³µê²© ì°¨ë‹¨)
CREATE POLICY &quot;policy_user_profiles_select&quot;
ON profiles FOR SELECT
USING (id = (select auth.uid()));  -- â­ ì„œë¸Œì¿¼ë¦¬ë¡œ ë³´ì•ˆ ê°•í™”

-- âŒ ì·¨ì•½í•œ RLS ì •ì±… (Function Search Path ê³µê²© ê°€ëŠ¥)
CREATE POLICY &quot;policy_user_profiles_select&quot;
ON profiles FOR SELECT
USING (id = auth.uid());  -- âŒ ì§ì ‘ í˜¸ì¶œ ì‹œ ê³µê²© ê°€ëŠ¥
</code></pre>
<h3>7.2. Storage ë³´ì•ˆ ì •ì±…</h3>
<div class="mermaid">
graph TB
    Bucket[ğŸ“¦ profileImage Bucket]

    Bucket --> UserProfiles[user-profiles/<br/>userId/]
    Bucket --> PalProfiles[pal-profiles/<br/>palId/]
    Bucket --> ChatImages[lifestyle-chat-images/<br/>roomId/]
    Bucket --> Public[public/<br/>3D Avatars]

    UserProfiles --> RLS1[ğŸ”’ RLS ì ìš©<br/>ë³¸ì¸ë§Œ ì ‘ê·¼]
    PalProfiles --> RLS2[ğŸ”’ RLS ì ìš©<br/>ë³¸ì¸ë§Œ ì ‘ê·¼]
    ChatImages --> RLS3[ğŸ”’ RLS ì ìš©<br/>ì°¸ì—¬ìë§Œ ì ‘ê·¼]
    Public --> Open[ğŸ”“ ê³µê°œ ì ‘ê·¼]

    style Bucket fill:#E3F2FD
    style RLS1 fill:#FFCDD2
    style RLS2 fill:#FFCDD2
    style RLS3 fill:#FFCDD2
    style Open fill:#C8E6C9

</div>

<hr />
<h2>ğŸš€ 8. ì„±ëŠ¥ ìµœì í™”</h2>
<h3>8.1. ë°ì´í„°ë² ì´ìŠ¤ ìµœì í™”</h3>
<ul>
<li><strong>ì¸ë±ìŠ¤ ì ìš©</strong>: userId, palId, roomid ë“± FKì— ì¸ë±ìŠ¤</li>
<li><strong>íŠ¸ë¦¬ê±° ìµœì í™”</strong>: í•„ìš”í•œ ê²½ìš°ì—ë§Œ ì‹¤í–‰</li>
<li><strong>RLS ì„±ëŠ¥</strong>: ì„œë¸Œì¿¼ë¦¬ ë°©ì‹ìœ¼ë¡œ ë³´ì•ˆ + ì„±ëŠ¥ í™•ë³´</li>
</ul>
<h3>8.2. í”„ë¡ íŠ¸ì—”ë“œ ìµœì í™”</h3>
<ul>
<li><strong>Hook Composition</strong>: í‰ê·  60% ì½”ë“œ ì¶•ì†Œ</li>
<li><strong>Co-location</strong>: ê¸°ëŠ¥ë³„ ë…ë¦½ì„± í™•ë³´</li>
<li><strong>CSS Modules</strong>: ëŸ°íƒ€ì„ ìµœì í™”</li>
</ul>
<h3>8.3. AI ì„œë²„ ìµœì í™”</h3>
<ul>
<li><strong>GPU ê°€ì†</strong>: NVIDIA RTX 4060 í™œìš©</li>
<li><strong>ë©€í‹°ëª¨ë¸ ê´€ë¦¬</strong>: ë™ì‹œ ì²˜ë¦¬ ì§€ì›</li>
<li><strong>í‰ê·  ì‘ë‹µ ì‹œê°„</strong>: 3~5ì´ˆ</li>
</ul>
<hr />
<h2>ğŸ“Š 9. ì‹œìŠ¤í…œ ë©”íŠ¸ë¦­ìŠ¤</h2>
<table>
<thead>
<tr>
<th style="text-align: left;"><strong>í•­ëª©</strong></th>
<th style="text-align: right;"><strong>ìˆ˜ì¹˜</strong></th>
<th style="text-align: left;"><strong>ë¹„ê³ </strong></th>
</tr>
</thead>
<tbody>
<tr>
<td style="text-align: left;"><strong>í‰ê·  ì‘ë‹µ ì‹œê°„</strong></td>
<td style="text-align: right;">3-5ì´ˆ</td>
<td style="text-align: left;">YOLO ë¶„ì„ í¬í•¨</td>
</tr>
<tr>
<td style="text-align: left;"><strong>ì‹¤ì‹œê°„ ì§€ì—°</strong></td>
<td style="text-align: right;">100ms ì´í•˜</td>
<td style="text-align: left;">Supabase Realtime</td>
</tr>
<tr>
<td style="text-align: left;"><strong>ë°ì´í„°ë² ì´ìŠ¤ RLS ì •ì±…</strong></td>
<td style="text-align: right;">47ê°œ</td>
<td style="text-align: left;">ë³´ì•ˆ ê°•í™”</td>
</tr>
<tr>
<td style="text-align: left;"><strong>Hook Composition ì„±ê³¼</strong></td>
<td style="text-align: right;">60% ì¶•ì†Œ</td>
<td style="text-align: left;">ì½”ë“œ ê°ì†Œìœ¨</td>
</tr>
<tr>
<td style="text-align: left;"><strong>ì§€ì› ë¸Œë ˆì´í¬í¬ì¸íŠ¸</strong></td>
<td style="text-align: right;">4ë‹¨ê³„</td>
<td style="text-align: left;">400px ~ 1280px+</td>
</tr>
<tr>
<td style="text-align: left;"><strong>AI ëª¨ë¸ í›ˆë ¨ ë°ì´í„°</strong></td>
<td style="text-align: right;">668,547ê°œ</td>
<td style="text-align: left;">ì´ë¯¸ì§€</td>
</tr>
<tr>
<td style="text-align: left;"><strong>RAG ì§€ì‹ ë² ì´ìŠ¤</strong></td>
<td style="text-align: right;">384ì°¨ì›</td>
<td style="text-align: left;">HuggingFace ì„ë² ë”©</td>
</tr>
</tbody>
</table>
<hr />
<p><strong>ğŸ“ ë¬¸ì„œ ì •ë³´</strong><br />
- <strong>ì‘ì„±ì¼</strong>: 2025-11-13<br />
- <strong>ì‘ì„±ì</strong>: LYSS with Claude<br />
- <strong>ë²„ì „</strong>: v4.0 (4ì°¨ ìŠ¤í”„ë¦°íŠ¸)<br />
- <strong>ì´ì „ ë¬¸ì„œ</strong>: <a href="./03_ì‹œìŠ¤í…œ_íë¦„ë„.md">03_ì‹œìŠ¤í…œ_íë¦„ë„.md</a><br />
- <strong>ë‹¤ìŒ ë¬¸ì„œ</strong>: <a href="./05_ERD.md">05_ERD.md</a></p>

    <script>
        // Mermaid ë Œë”ë§ ì™„ë£Œ í›„ í˜ì´ì§€ ë¡œë“œ ì´ë²¤íŠ¸
        window.addEventListener('load', function() {
            console.log('Mermaid diagrams loaded successfully!');
        });
    </script>
</body>
</html>
